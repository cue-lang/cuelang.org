<!doctype html>
<html lang="en" dir="ltr" class="no-js">
    <head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Source: https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns Managing Mythic Beasts DNS zones with CUE by Jonathan Matthews with …">
<meta name="generator" content="Hugo 0.147.5">

<meta name="robots" content="noindex, nofollow">

<link rel="canonical" href="https://cuelang.org/docs/draft/cbe-004_mythic_beasts_dns/" />
<link rel="shortcut icon" href="/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/webmanifest.json">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#232a68">
<meta name="msapplication-TileColor" content="#232a68">
<meta name="msapplication-config" content="/favicons/browserconfig.xml">
<meta name="theme-color" content="#232a68">

<title>CUE By Example - Managing Mythic Beasts DNS zones with CUE | CUE</title><meta property="og:url" content="/docs/draft/cbe-004_mythic_beasts_dns/">
  <meta property="og:site_name" content="CUE">
  <meta property="og:title" content="CUE By Example - Managing Mythic Beasts DNS zones with CUE">
  <meta property="og:description" content="Source: https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns Managing Mythic Beasts DNS zones with CUE by Jonathan Matthews with essential CUE contributions from Roger Peppe
Introduction Mythic Beasts is a UK-based company whose “About” page says they are …
a privately owned hosting ISP with a focus on providing services to technically capable customers.
Mythic Beasts publishes an API that allows customers to replace all the DNS records in a specific zone without using a web-based control panel.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:modified_time" content="2025-03-27T16:38:46+00:00">
    <meta property="og:image" content="/img/social.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="/img/social.png">
  <meta name="twitter:title" content="CUE By Example - Managing Mythic Beasts DNS zones with CUE">
  <meta name="twitter:description" content="Source: https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns Managing Mythic Beasts DNS zones with CUE by Jonathan Matthews with essential CUE contributions from Roger Peppe
Introduction Mythic Beasts is a UK-based company whose “About” page says they are …
a privately owned hosting ISP with a focus on providing services to technically capable customers.
Mythic Beasts publishes an API that allows customers to replace all the DNS records in a specific zone without using a web-based control panel.">





<link rel="preload" href="/scss/main.min.8351627014ac2bf7396348f13a7d9959c01f0c9eee800e29af55ada087dad866.css" as="style">
<link href="/scss/main.min.8351627014ac2bf7396348f13a7d9959c01f0c9eee800e29af55ada087dad866.css" rel="stylesheet" integrity="">



<link rel="preload" href="/fonts/inter/regular.woff2" as="font" crossorigin="anonymous">
<link rel="preload" href="/fonts/inter/500.woff2" as="font" crossorigin="anonymous">
<link rel="preload" href="/fonts/inter/700.woff2" as="font" crossorigin="anonymous">



<script>(()=>{document.documentElement.classList.remove("no-js"),document.documentElement.classList.add("js")})()</script>
</head>
    <body itemscope itemtype="https://schema.org/WebPage">
        <meta itemprop="name" content="CUE By Example - Managing Mythic Beasts DNS zones with CUE">
<meta itemprop="description" content=" Source: https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns Managing Mythic Beasts DNS zones with CUE by Jonathan Matthews with essential CUE contributions from Roger Peppe
Introduction Mythic Beasts is a UK-based company whose &ldquo;About&rdquo; page says they are &hellip;
a privately owned hosting ISP with a focus on providing services to technically capable customers.
Mythic Beasts publishes an API that allows customers to replace all the DNS records in a specific zone without using a web-based control panel.
">

    
        <meta itemprop="dateModified" content="2025-03-27T16:38:46+00:00" >
    
            
        <meta itemprop="image" content="/img/social.png"/>
            
    <meta itemprop="keywords" content="" />

        <a id="skip-nav" class="skip-link" href="#site-main" target="_self">Skip to content</a>

        <div class="site">
            <header id="site-header" class="site__header">
                

<div class="header header--wide" data-header>
    <div class="header__container">
        <div class="header__background"></div>

        <div class="header__branding">
            <a href="/" class="header__logo" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>
        </div>

        <div class="header__main">
            <nav class="nav nav--main" aria-label="Main menu">
                <ul class="nav__list">
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/docs/"><span class="nav__text">Documentation</span></a>
                        </li>
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/play/"><span class="nav__text">Play</span></a>
                        </li>
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/community/"><span class="nav__text">Community</span></a>
                        </li>
                    
                </ul>
            </nav>
        </div>

        <div class="header__secondary">
            <div class="header__icons">
                <nav class="nav nav--social" aria-label="Social">
                    <ul class="nav__list"><li class="nav__item"><a class="nav__link"
                                   href="https://github.com/cue-lang/cue" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--github"></use>
</svg>

                                    <span class="nav__text">GitHub</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="/s/slack">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--slack"></use>
</svg>

                                    <span class="nav__text">Slack</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="/s/discord">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-discord"></use>
</svg>

                                    <span class="nav__text">Discord</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://twitter.com/cue_lang" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                                    <span class="nav__text">X (Twitter)</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://bsky.app/profile/cuelang.org" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-bluesky"></use>
</svg>

                                    <span class="nav__text">Bluesky</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://www.youtube.com/@cuelang/videos" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-youtube"></use>
</svg>

                                    <span class="nav__text">YouTube</span>
                                </a>
                            </li></ul>
                </nav>
            </div>

            <div class="header__cta"><a class="button button--skinny"
                       href="/docs/introduction/installation/"><span class="button__text">Install</span>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--download"></use>
</svg>
</a></div>

            <div class="header__search" data-menu>
                <a href="/search" class="button button--icon button--white-simple" rel="search" data-menu-dropdown="header-dropdown-search">



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--search"></use>
</svg>
<span>Search</span>
                </a>

                <div class="header__dropdown header__dropdown--search" data-menu-dropdown-target="header-dropdown-search">
                    <p class="header__search-title">What are you looking for?</p>





<div data-search-autocomplete="menu"
     data-searchbar-size="small"
     data-searchbar-placeholder=""
>
    <div id="autocomplete-menu"></div>
</div>
</div>
            </div>

            <div class="header__toggle">
                <button class="button button--outline" data-drawer-toggle="menu" aria-haspopup="menu" aria-expanded="false" aria-controls="mobile-menu">
                    <span class="button__text">Menu</span>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--menu"></use>
</svg>
</button>
            </div>
        </div>
    </div>
</div>

            </header>

            <main id="site-main" class="site__content" itemprop="mainContentOfPage">
                

    <div class="docs" data-docs>
        <div class="docs__main">
            <nav class="breadcrumb" aria-label="breadcrumb">
    <ol class="breadcrumb__list">
    

    
    

    
        <li class="breadcrumb__item"><a class="breadcrumb__link" href="/docs/draft/">Drafts</a></li>
    
    

    
        <li class="breadcrumb__item" aria-current="page"><h1 class="breadcrumb__text">CUE By Example - Managing Mythic Beasts DNS zones with CUE</h1></li>
    
    </ol>
</nav>


            <article class="article article--docs" itemscope itemtype="https://schema.org/TechArticle">
                <meta itemprop="articleBody" content="




    

Source: https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns



    




    

Managing Mythic Beasts DNS zones with CUE
by Jonathan Matthews
with essential CUE contributions from Roger Peppe

    




    

Introduction
Mythic Beasts is a UK-based company whose
&ldquo;About&rdquo; page says they are &hellip;

a privately owned hosting ISP with a focus on providing services to
technically capable customers.
Mythic Beasts publishes an API that allows customers to replace all the DNS
records in a specific zone without using a web-based control panel.
This guide demonstrates how CUE can be used to keep the underlying DNS records
in an elegant and compact format that uses templating to DRY out
configurations, whilst also allowing policy enforcement to guard against
mistakes.
It also uses CUE&rsquo;s scripting layer as the mechanism that triggers API-based
replacements of DNS zones hosted by Mythic Beasts. However, this implementation
detail is relatively unimportant because of some good design decisions made by
the Mythic Beasts DNS API.

    




    

Set up

    




    

Prerequisites
To use this guide, you need to:

install the cue command
have one or more domains with a DNS service
provided by Mythic Beasts


    




    

Create CUE files
5 files need to be created. They&rsquo;re presented inline, in this guide, and also
as stand-alone files in this guide&rsquo;s directory in this repo.
The first 3 files, zones.cue, policy.cue, and shared.cue, are data files.
Their contents must be adapted to reflect your DNS zones and records.
The last 2 files, schema.cue and dns_tool.cue, should be used exactly as
presented in this guide. They contain the system&rsquo;s implementation, and don&rsquo;t
need to be adapted in any way.

    




    

:arrow_right: Create zones.cue
:floppy_disk: zones.cue







            




    


                            Copied!
                        
                    zones.cue
            
        


                Copy code
                
                    Copied!
                
            package dns

// This file contains DNS records for 3 separate zones:
//   - &#34;my-primary-domain.test&#34;
//   - &#34;infrastructure-domain.test&#34;
//   - &#34;another-domain.example&#34;

// Each zone has Google Workspace email-related DNS records (MX, SPF, and
// DKIM), as templated by the CUE in &#34;shared.cue&#34;.

// Additionally, in this file:
// &#34;my-primary-domain.test&#34; is a domain containing:
//   - a Wordpress site at my-primary-domain.test
//   - a different website at www.my-primary-domain.test
//   - a Wordpress-hosted blog at blog.my-primary-domain.test
//   - a test blog at test.blog.my-primary-domain.test
//   - an internally-hosted site split across 2 servers at dev.my-primary-domain.test
zones: &#34;my-primary-domain.test&#34;: {
	// the zone apex uses the provider&#39;s ANAME/ALIAS feature for CNAME-like
	// behaviour at the zone&#39;s root, resolving to a Wordpress.com-hosted site
	&#34;@&#34;: ANAME: &#34;lb.wordpress.com&#34;: ttl: 3600

	// &#34;www&#34; has a pair of IPv4 and IPv6 records, with harmonised TTLs
	www: {
		_www_ttl: 300
		A: &#34;192.0.2.0&#34;: ttl:                                 _www_ttl
		A: &#34;198.51.100.0&#34;: ttl:                              _www_ttl
		AAAA: &#34;2001:db8:0001:0001:0001:0001:0001:0001&#34;: ttl: _www_ttl
		AAAA: &#34;2001:db8:ffff:ffff:ffff:ffff:ffff:ffff&#34;: ttl: _www_ttl
	}

	// &#34;blog&#34; is a Wordpress.com site with a custom domain
	blog: CNAME: &#34;lb.wordpress.com&#34;: ttl: 3600

	// &#34;test.blog&#34; is a CNAME towards a Heroku-hosted test instance of Wordpress
	&#34;test.blog&#34;: CNAME: &#34;whispering-willow-5678.ssl.herokudns.com&#34;: ttl: 3600

	// &#34;dev&#34; has round-robin A records, with linked TTLs
	dev: A: &#34;192.168.0.1&#34;: ttl: 600
	dev: A: &#34;192.168.1.1&#34;: ttl: 2 * dev.A.&#34;192.168.0.1&#34;.ttl
}

// &#34;infrastructure-domain.test&#34; is a domain containing:
//   - a site at the domain apex
//   - a pointer to a different site at &#34;www.&#34;
//   - some IPv4 and IPv6 records at &#34;local.&#34;
zones: &#34;infrastructure-domain.test&#34;: {
	// the zone apex A record
	&#34;@&#34;: A: &#34;172.20.1.2&#34;: ttl: 3600

	// &#34;www&#34; is a CNAME to another host&#34;
	www: CNAME: &#34;www.example.com&#34;: ttl: 300

	// &#34;local&#34; has both v4 and v6 IP records
	local: {
		A: &#34;127.0.0.1&#34;: ttl:          3600
		AAAA: &#34;0:0:0:0:0:0:0:1&#34;: ttl: 3600
	}
}

// &#34;another-domain.example&#34; is a domain containing:
//   - a pointer to a site at the domain apex
//   - a pointer to the domain apex at &#34;www.&#34;
zones: &#34;another-domain.example&#34;: {
	// the zone apex uses the provider&#39;s ANAME/ALIAS feature for CNAME-like
	// behaviour at the zone&#39;s root
	&#34;@&#34;: ANAME: &#34;www.example.com&#34;: ttl: 86400

	// &#34;www&#34; is a CNAME to the zone apex
	www: CNAME: &#34;another-domain.example&#34;: ttl: 300
}






zones.cue contains the structured data that represents each zone - notice how
compact the data format is. Later in this guide you&rsquo;ll adapt this file to
reflect your DNS zones.

    




    

:arrow_right: Create policy.cue
:floppy_disk: policy.cue







            




    


                            Copied!
                        
                    policy.cue
            
        


                Copy code
                
                    Copied!
                
            package dns

zones?: {
	// These policies apply to all zones
	[_]: {
		// www must exist
		www!: _
	}

	// These policies apply only to our primary domain
	&#34;my-primary-domain.test&#34;: {
		// &#34;blog.my-primary-domain.test&#34;, must exist (as it makes all our revenue)
		blog!: _
	}
}

// The definition of #TTL in `schema.cue` unifies with this definition.
// Require that all TTLs are 60 seconds or greater
#TTL: &gt;=60







    




    

:arrow_right: Create shared.cue
:floppy_disk: shared.cue







            




    


                            Copied!
                        
                    shared.cue
            
        


                Copy code
                
                    Copied!
                
            package dns

zones: [Zone=string]: {
	&#34;@&#34;: {
		MX: {
			_mx_ttl: 3600
			&#34;aspmx.l.google.com&#34;: {pri: 1, ttl: _mx_ttl}
			&#34;alt1.aspmx.l.google.com&#34;: {pri: 5, ttl: _mx_ttl}
			&#34;alt2.aspmx.l.google.com&#34;: {pri: 5, ttl: _mx_ttl}
			&#34;alt3.aspmx.l.google.com&#34;: {pri: 10, ttl: _mx_ttl}
			&#34;alt4.aspmx.l.google.com&#34;: {pri: 10, ttl: _mx_ttl}
		}
		TXT: &#34;v=spf1 include:_spf.google.com ~all&#34;: ttl: 3600
	}
	#DKIM?: pubkey?: string
	if #DKIM != _|_ if #DKIM.pubkey != _|_ {
		&#34;google._domainkey&#34;: TXT: &#34;v=DKIM1; k=rsa; p=\(#DKIM.pubkey)&#34;: ttl: 600
	}
}

zones: &#34;my-primary-domain.test&#34;: #DKIM: pubkey:
	&#34;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApINijpsDxy12WvwIoNZvO4hT&#43;73BatBfqMUWMS&#43;DWwRV6kJHlil0TJUZWJ/TwwfRGFbkjz4EIsmk&#43;YipLRdBIYD9NDF7c2fP23&#43;XWXJtIq27n/88m/jZyDr5N4YQCXM4yUpYbal84RKAdebEqeInwTk2UKqfQ4ysoJdWZzY8wkCUIND3AyU8gBX&#43;uq3bdLLWUNJp4Uwe4EY0TEn28xZy5R0hdILPANS/l07QpOocw3/1IWChmRb/2h4/64PLJfKveTApGJBNNNqBTqolKAMZjbVu6gNMWi04tGkEcD2o7zenHF8pLKuUxmZAM1Z/voTjxiDfr1q9pOS&#43;vqg2LXv1UwIDAQAB&#34;

zones: &#34;infrastructure-domain.test&#34;: #DKIM: pubkey:
	&#34;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApINijpsDxy12WvwIoNZvO4hT&#43;73BatBfqMUWMS&#43;DWwRV6kJHlil0TJUZWJ/TwwfRGFbkjz4EIsmk&#43;YipLRdBIYD9NDF7c2fP23&#43;XWXJtIq27n/88m/jZyDr5N4YQCXM4yUpYbal84RKAdebEqeInfkskvmkl4mg34gGdsfg%hy53refgshtrwedsdgdfhhSSSSSSafgrthgdsdcc\vftjhjasafas/fdsssdf/gfddasdhhrgrsd2h4/64PLJfKveTApGJBNNNqBTqolKAMZjbVu6gNMWi04tGkEcD2o7zenHF8pLKuUxmZAM1Z/voTjxiDfr1q9pOS&#43;vqg2LXv1UwIDAQAB&#34;

zones: &#34;another-domain.example&#34;: #DKIM: pubkey:
	&#34;MIIBIjANBgakvk4kfmkddddadvrefsdgfsdfdasgfQEApINijpsDxy12WvwIoNZvO4hT&#43;73BatBfqMUWMS&#43;DWwRV6kJHlil0TJUZWJ/TwwfRGFbkjz4EIsmk&#43;YipLRdBIYt4kfcklsdamkvkldfslamncvkdmaslfnvnkslmvmsdv/aefmksdlsdmgmksadmgkdshHGET$HS3ttg5zY8wkCUIND3AyU8gBX&#43;uq3bdLLWUNJp4Uwe4EY0TEn28xZy5R0hdILPANS/l07QpOocw3/1IWChmRb/2h4/64PLJfKveTApGJBNNNqBTqolKAMZjbVu6gNMWi04tGkEcD2o7zenHF8pLKuUxmZAM1Z/voTjxiDfr1q9pOS&#43;vqg2LXv1UwIDAQAB&#34;






shared.cue uses CUE&rsquo;s &ldquo;template&rdquo; feature to add records to all the zones
contained in zones.cue. We use it in this guide&rsquo;s example data to create the
same Google Workspace MX (Mail eXchanger) and SPF (Sender Policy Framework)
records in every zone, and to set up DKIM-related CNAMEs that have
zone-specific keys placed inside a standardised record structure.
Note that these are simply examples of specifying types of DNS records that
often need to be kept in sync across multiple domains - you don&rsquo;t need to
have them set up like this.

    




    

:arrow_right: Create schema.cue
:floppy_disk: schema.cue







            




    


                            Copied!
                        
                    schema.cue
            
        


                Copy code
                
                    Copied!
                
            package dns

import &#34;net&#34;

zones: [_]: #Zone

#Zone: {
	[#Host]: {
		A?:     #A
		AAAA?:  #AAAA
		ANAME?: #ANAME
		CNAME?: #CNAME
		MX?:    #MX
		NS?:    #NS
		TXT?:   #TXT
	}
	#DKIM?: pubkey?: string
}

#Host: #FQDN | &#34;@&#34; // &#34;@&#34; indicates the zone apex/root
#FQDN: net.FQDN &amp; string

#A: [#IPv4]:     #Record
#AAAA: [#IPv6]:  #Record
#ANAME: [#FQDN]: #Record
#CNAME: [#FQDN]: #Record
#MX: [#FQDN]: #Record &amp; {
	pri: int
}
#NS: [#FQDN]:   #Record
#TXT: [string]: #Record

#Record: {
	ttl: #TTL
	...
}
#TTL: int &amp; &gt;=0 &amp; &lt;=2147483647

#IPv6: string // https://github.com/cue-lang/cue/issues/2614
#IPv4: net.IPv4 &amp; string






schema.cue contains the schema for the DNS zones and records you&rsquo;ll provide.
CUE will validate your data against this schema each time the data is used,
flagging up mistakes before they&rsquo;re submitted to the API.
This file should be used as presented, without adapting it. It doesn&rsquo;t contain
any zone- or record-specific data.

    




    

:arrow_right: Create dns_tool.cue



:floppy_disk: dns_tool.cue (click to open)








            




    


                            Copied!
                        
                    dns_tool.cue
            
        


                Copy code
                
                    Copied!
                
            package dns

import (
	&#34;tool/http&#34;
	&#34;tool/cli&#34;
	&#34;tool/os&#34;
	&#34;encoding/base64&#34;
	&#34;encoding/json&#34;
	&#34;encoding/yaml&#34;
)

command: update: {
	// https://www.mythic-beasts.com/support/api/auth
	auth: {
		env: os.Environ &amp; {
			MYTHIC_BEASTS_API_KEY_ID: string
			MYTHIC_BEASTS_API_SECRET: string
		}
		login: http.Post &amp; {
			_auth: {
				username: env.MYTHIC_BEASTS_API_KEY_ID
				password: env.MYTHIC_BEASTS_API_SECRET
				header:   &#34;Basic &#34; &#43; base64.Encode(null, &#34;\(username):\(password)&#34;)
			}

			// https://www.mythic-beasts.com/support/api/auth#sec-obtaining-a-token
			url: &#34;https://auth.mythic-beasts.com/login&#34;
			tls: verify:   true
			request: body: &#34;grant_type=client_credentials&#34;
			request: header: Authorization:  _auth.header
			request: header: &#34;Content-Type&#34;: &#34;application/x-www-form-urlencoded&#34;
			response: statusCode: 200
		}

		// https://www.mythic-beasts.com/support/api/auth#sec-making-api-requests
		token: &#34;Bearer &#34; &#43; json.Unmarshal(login.response.body).access_token
	}
	for zone_name, records in _mythic_beast_zone_records {
		api_request=&#34;replace_\(zone_name)&#34;: http.Put &amp; {
			// https://www.mythic-beasts.com/support/api/dnsv2#ep-put-zoneszonerecords
			url: &#34;https://api.mythic-beasts.com/dns/v2/zones/\(zone_name)/records?exclude-template&amp;exclude-generated&#34;
			request: body: json.Marshal({&#34;records&#34;: records})
			request: header: Authorization:  auth.token
			request: header: &#34;Content-Type&#34;: &#34;application/json&#34;
			response: statusCode: 200
		}
		&#34;response_\(zone_name)&#34;: cli.Print &amp; {
			text: json.Marshal({(zone_name): json.Unmarshal(api_request.response.body)})
		}
	}
}

command: dump: cli.Print &amp; {
	text: yaml.Marshal(zones)
}

// https://www.mythic-beasts.com/support/api/dnsv2#sec-request-body-json1
_mythic_beast_zone_records: [Zone=string]: [..._MythicBeastsZoneRecord]
_mythic_beast_zone_records: {
	for zone_name, zone_config in zones {
		(zone_name): [
			for host_name, host_config in zone_config
			for rrtype in [&#34;A&#34;, &#34;AAAA&#34;, &#34;ANAME&#34;, &#34;CNAME&#34;, &#34;NS&#34;, &#34;TXT&#34;]
			for _data, _record in (*host_config[rrtype] | {}) {
				{host: host_name, ttl: _record.ttl, type: rrtype, data: _data}
			},
			for host_name, host_config in zone_config
			for _data, _record in (*host_config.MX | {}) {
				{host: host_name, ttl: _record.ttl, type: &#34;MX&#34;, data: _data, &#34;mx_priority&#34;: _record.pri}
			},
		]
	}
}

_MythicBeastsZoneRecord: {
	host: string
	ttl:  int
	type: &#34;A&#34; | &#34;AAAA&#34; | &#34;ANAME&#34; | &#34;CNAME&#34; | &#34;MX&#34; | &#34;NS&#34; | &#34;TXT&#34;
	data: string
}








As with schema.cue, dns_tool.cue is part of the system&rsquo;s implementation,
and should be used as presented.
dns_tool.cue contains a CUE workflow command which performs the necessary API requests
to replace all DNS zones&rsquo; records. A CUE workflow command is included here to provide a
way of using the cue command, by itself, to drive changes via the Mythic
Beasts API.
However, because using a CUE workflow command to perform these requests isn&rsquo;t the main
point of this guide, you should feel free to swap it out for anything that
suits your needs better - a shell script, a Golang utility, a Python script:
any language will easily be able to make the necessary requests.
This is because the specific Mythic Beasts API targetted is both genuinely
declarative (meaning it&rsquo;s not just mostly declarative, but also treats
&ldquo;missing&rdquo; records in its input as a request to delete those records) and
atomic (meaning each DNS zone update either succeeds or fails completely).
These two properties mean that any tooling could make the API requests, using
JSON exported by CUE. CUE would still perform early, powerful data validatation
and composition, through the contents of all the CUE files (except
dns_tool.cue), but no complex request payload calculation or interdependent
request sequencing would need to be performed by the tool that calls the API.

    




    

Make DNS changes

    




    

Grant API access to the system

    




    

:arrow_right: Create an API key
Create an API key via
the Mythic Beasts UI.
Give the API key an appropriate name.
Under the Primary DNS API v2 heading click &ldquo;Add permit&rdquo; once for each zone
you want the system to manage.
For each zone, add a permit with a Hostname setting of *, a Zone setting
matching the DNS zone&rsquo;s name, and a Type setting of (all).
Click &ldquo;Create API key&rdquo; at the bottom of the page, and copy the API key&rsquo;s ID and
secret from the next page that the site displays.

    




    

:arrow_right: Export the API key
Expose the API key to the system by exporting the API key&rsquo;s ID and secret via 2
environment variables:

MYTHIC_BEASTS_API_KEY_ID: your API key ID
MYTHIC_BEASTS_API_SECRET: your API secret


    




    

Edit the DNS records to match your zones

    




    

:arrow_right: Add your DNS records
Replace the contents of zones.cue, policy.cue, and shared.cue so that
they reflect your DNS zones&rsquo; records - both the zone-specific and shared
records, along with any policies you want to impose on the records now and in
the future.
Make sure to include all DNS records that already exist in your zones.

    




    

:arrow_right: Validate the DNS records
Use the dump CUE workflow command to display all the records you&rsquo;ve configured.
:rotating_light::rotating_light::rotating_light:
For each zone you&rsquo;ve configured, ONLY the records displayed will exist after
using this system. Every currently-existing record that&rsquo;s missing from the
dump workflow command&rsquo;s output will be REMOVED - so check the output against your
current zone contents carefully!
:rotating_light::rotating_light::rotating_light:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # Actual command in CUE-By-Example guide:
# cue cmd dump
$ cue cmd dump | head -20 &gt;6.actual.txt

Output like this (truncated) example will be displayed:







            




    


                            Copied!
                        
                    6.expected.txt
            
        


                Copy code
                
                    Copied!
                
            my-primary-domain.test:
  &#39;@&#39;:
    ANAME:
      lb.wordpress.com:
        ttl: 3600
    MX:
      aspmx.l.google.com:
        pri: 1
        ttl: 3600
      alt1.aspmx.l.google.com:
        pri: 5
        ttl: 3600
      alt2.aspmx.l.google.com:
        pri: 5
        ttl: 3600
      alt3.aspmx.l.google.com:
        pri: 10
        ttl: 3600
      alt4.aspmx.l.google.com:
        pri: 10







    




    

Replace DNS zones

    




    

:arrow_right: Change all DNS records in all zones

  
      
          :exclamation: WARNING :exclamation:
      
  
  
      
          The API calls used by this guide completely replace ALL existing records stored in a Mythic Beasts DNS zone.It is not possible to bring such a DNS zone incrementally under the control of the system outlined in this guide.To use this guide safely, either use a test DNS zone with unimportant contents, or export the contents of a non-test zone and convert them exhaustively and carefully into the structured data format demonstrated in this guide.
      
  

Having read the warning, above, invoke the CUE workflow command as follows.
This will replace all DNS records across all the zones you&rsquo;ve configured:
:computer: terminal

                Copy code
                
                    Copied!
                
            cue cmd update

Upon success, the following output is displayed:

                Copy code
                
                    Copied!
                
            {&#34;infrastructure-domain.test&#34;:{&#34;message&#34;:&#34;11 records added&#34;,&#34;records_added&#34;:11,&#34;records_removed&#34;:11}}
{&#34;my-primary-domain.test&#34;:{&#34;message&#34;:&#34;16 records added&#34;,&#34;records_added&#34;:16,&#34;records_removed&#34;:12}}
{&#34;another-domain.example&#34;:{&#34;message&#34;:&#34;9 records added&#34;,&#34;records_added&#34;:9,&#34;records_removed&#34;:13}}


    




    

:arrow_right: Save your files
Version control all the files that you amended or copied. These should include:

zones.cue
policy.cue
shared.cue
schema.cue
dns_tool.cue

One of CUE&rsquo;s nice properties is that, once you understand how its core
&ldquo;unification&rdquo; mechanism works, you can trivially split the contents of all
these files into as many files as you like. For example, you can keep each
zone in its own file if that layout suits you best.

    




    

Related content

Mythic Beasts API accepts these record types, with these schemata:

https://www.mythic-beasts.com/support/api/dnsv2#ep-get-record-types
https://api.mythic-beasts.com/dns/v2/record-types


The DNS API&rsquo;s OpenAPI schema:

https://www.mythic-beasts.com/support/api/dnsv2?format=yaml



">
<meta itemprop="wordCount" content="2076">


                <div class="article__container">
                    



<header class="article__header">
        </header>



                    <div class="article__content">
                        
                            <div class="note note--caution" role="alert">



<svg class="icon note__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--exclamation"></use>
</svg>
<div class="note__content">Source: <a href="https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns">https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns</a></div>
</div>

<h1 id="managing-mythic-beasts-dns-zones-with-cue">
    <a href="#managing-mythic-beasts-dns-zones-with-cue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Managing <a href="https://www.mythic-beasts.com/support/domains/primarydns">Mythic Beasts DNS</a> zones with CUE</h1>
<p><sup>by <a href="https://jonathanmatthews.com">Jonathan Matthews</a></sup>
<sup>with essential CUE contributions from <a href="https://github.com/rogpeppe">Roger Peppe</a></sup></p>
<h2 id="introduction">
    <a href="#introduction" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Introduction</h2>
<p><a href="https://www.mythic-beasts.com/">Mythic Beasts</a> is a UK-based company whose
<a href="https://www.mythic-beasts.com/article/about">&ldquo;About&rdquo; page</a> says they are &hellip;</p>
<blockquote>
<p>a privately owned hosting ISP with a focus on providing services to
technically capable customers.</p></blockquote>
<p>Mythic Beasts publishes an API that allows customers to replace all the DNS
records in a specific zone <em>without</em> using a web-based control panel.</p>
<p>This guide demonstrates how CUE can be used to keep the underlying DNS records
in an elegant and compact format that uses templating to DRY out
configurations, whilst also allowing policy enforcement to guard against
mistakes.</p>
<p>It also uses CUE&rsquo;s scripting layer as the mechanism that triggers API-based
replacements of DNS zones hosted by Mythic Beasts. However, this implementation
detail is relatively unimportant because of some good design decisions made by
the Mythic Beasts DNS API.</p>
<h2 id="set-up">
    <a href="#set-up" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Set up</h2>
<h3 id="prerequisites">
    <a href="#prerequisites" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Prerequisites</h3>
<p>To use this guide, you need to:</p>
<ul>
<li><a href="https://alpha.cuelang.org/docs/introduction/installation/">install the <code>cue</code> command</a></li>
<li>have one or more domains with a DNS service
<a href="https://www.mythic-beasts.com/customer/domains">provided by Mythic Beasts</a></li>
</ul>
<h3 id="create-cue-files">
    <a href="#create-cue-files" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Create CUE files</h3>
<p>5 files need to be created. They&rsquo;re presented inline, in this guide, and also
as stand-alone files in this guide&rsquo;s directory in this repo.</p>
<p>The first 3 files, <code>zones.cue</code>, <code>policy.cue</code>, and <code>shared.cue</code>, are data files.
Their contents must be adapted to reflect your DNS zones and records.</p>
<p>The last 2 files, <code>schema.cue</code> and <code>dns_tool.cue</code>, should be used exactly as
presented in this guide. They contain the system&rsquo;s implementation, and don&rsquo;t
need to be adapted in any way.</p>
<h4 id="arrow_right-create-zonescue">
    <a href="#arrow_right-create-zonescue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create <code>zones.cue</code></h4>
<p>:floppy_disk: <code>zones.cue</code>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="zones.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="zones.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>zones.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="zones.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBkbnMKCi8vIFRoaXMgZmlsZSBjb250YWlucyBETlMgcmVjb3JkcyBmb3IgMyBzZXBhcmF0ZSB6b25lczoKLy8gICAtICJteS1wcmltYXJ5LWRvbWFpbi50ZXN0IgovLyAgIC0gImluZnJhc3RydWN0dXJlLWRvbWFpbi50ZXN0IgovLyAgIC0gImFub3RoZXItZG9tYWluLmV4YW1wbGUiCgovLyBFYWNoIHpvbmUgaGFzIEdvb2dsZSBXb3Jrc3BhY2UgZW1haWwtcmVsYXRlZCBETlMgcmVjb3JkcyAoTVgsIFNQRiwgYW5kCi8vIERLSU0pLCBhcyB0ZW1wbGF0ZWQgYnkgdGhlIENVRSBpbiAic2hhcmVkLmN1ZSIuCgovLyBBZGRpdGlvbmFsbHksIGluIHRoaXMgZmlsZToKLy8gIm15LXByaW1hcnktZG9tYWluLnRlc3QiIGlzIGEgZG9tYWluIGNvbnRhaW5pbmc6Ci8vICAgLSBhIFdvcmRwcmVzcyBzaXRlIGF0IG15LXByaW1hcnktZG9tYWluLnRlc3QKLy8gICAtIGEgZGlmZmVyZW50IHdlYnNpdGUgYXQgd3d3Lm15LXByaW1hcnktZG9tYWluLnRlc3QKLy8gICAtIGEgV29yZHByZXNzLWhvc3RlZCBibG9nIGF0IGJsb2cubXktcHJpbWFyeS1kb21haW4udGVzdAovLyAgIC0gYSB0ZXN0IGJsb2cgYXQgdGVzdC5ibG9nLm15LXByaW1hcnktZG9tYWluLnRlc3QKLy8gICAtIGFuIGludGVybmFsbHktaG9zdGVkIHNpdGUgc3BsaXQgYWNyb3NzIDIgc2VydmVycyBhdCBkZXYubXktcHJpbWFyeS1kb21haW4udGVzdAp6b25lczogIm15LXByaW1hcnktZG9tYWluLnRlc3QiOiB7CgkvLyB0aGUgem9uZSBhcGV4IHVzZXMgdGhlIHByb3ZpZGVyJ3MgQU5BTUUvQUxJQVMgZmVhdHVyZSBmb3IgQ05BTUUtbGlrZQoJLy8gYmVoYXZpb3VyIGF0IHRoZSB6b25lJ3Mgcm9vdCwgcmVzb2x2aW5nIHRvIGEgV29yZHByZXNzLmNvbS1ob3N0ZWQgc2l0ZQoJIkAiOiBBTkFNRTogImxiLndvcmRwcmVzcy5jb20iOiB0dGw6IDM2MDAKCgkvLyAid3d3IiBoYXMgYSBwYWlyIG9mIElQdjQgYW5kIElQdjYgcmVjb3Jkcywgd2l0aCBoYXJtb25pc2VkIFRUTHMKCXd3dzogewoJCV93d3dfdHRsOiAzMDAKCQlBOiAiMTkyLjAuMi4wIjogdHRsOiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF93d3dfdHRsCgkJQTogIjE5OC41MS4xMDAuMCI6IHR0bDogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfd3d3X3R0bAoJCUFBQUE6ICIyMDAxOmRiODowMDAxOjAwMDE6MDAwMTowMDAxOjAwMDE6MDAwMSI6IHR0bDogX3d3d190dGwKCQlBQUFBOiAiMjAwMTpkYjg6ZmZmZjpmZmZmOmZmZmY6ZmZmZjpmZmZmOmZmZmYiOiB0dGw6IF93d3dfdHRsCgl9CgoJLy8gImJsb2ciIGlzIGEgV29yZHByZXNzLmNvbSBzaXRlIHdpdGggYSBjdXN0b20gZG9tYWluCglibG9nOiBDTkFNRTogImxiLndvcmRwcmVzcy5jb20iOiB0dGw6IDM2MDAKCgkvLyAidGVzdC5ibG9nIiBpcyBhIENOQU1FIHRvd2FyZHMgYSBIZXJva3UtaG9zdGVkIHRlc3QgaW5zdGFuY2Ugb2YgV29yZHByZXNzCgkidGVzdC5ibG9nIjogQ05BTUU6ICJ3aGlzcGVyaW5nLXdpbGxvdy01Njc4LnNzbC5oZXJva3VkbnMuY29tIjogdHRsOiAzNjAwCgoJLy8gImRldiIgaGFzIHJvdW5kLXJvYmluIEEgcmVjb3Jkcywgd2l0aCBsaW5rZWQgVFRMcwoJZGV2OiBBOiAiMTkyLjE2OC4wLjEiOiB0dGw6IDYwMAoJZGV2OiBBOiAiMTkyLjE2OC4xLjEiOiB0dGw6IDIgKiBkZXYuQS4iMTkyLjE2OC4wLjEiLnR0bAp9CgovLyAiaW5mcmFzdHJ1Y3R1cmUtZG9tYWluLnRlc3QiIGlzIGEgZG9tYWluIGNvbnRhaW5pbmc6Ci8vICAgLSBhIHNpdGUgYXQgdGhlIGRvbWFpbiBhcGV4Ci8vICAgLSBhIHBvaW50ZXIgdG8gYSBkaWZmZXJlbnQgc2l0ZSBhdCAid3d3LiIKLy8gICAtIHNvbWUgSVB2NCBhbmQgSVB2NiByZWNvcmRzIGF0ICJsb2NhbC4iCnpvbmVzOiAiaW5mcmFzdHJ1Y3R1cmUtZG9tYWluLnRlc3QiOiB7CgkvLyB0aGUgem9uZSBhcGV4IEEgcmVjb3JkCgkiQCI6IEE6ICIxNzIuMjAuMS4yIjogdHRsOiAzNjAwCgoJLy8gInd3dyIgaXMgYSBDTkFNRSB0byBhbm90aGVyIGhvc3QiCgl3d3c6IENOQU1FOiAid3d3LmV4YW1wbGUuY29tIjogdHRsOiAzMDAKCgkvLyAibG9jYWwiIGhhcyBib3RoIHY0IGFuZCB2NiBJUCByZWNvcmRzCglsb2NhbDogewoJCUE6ICIxMjcuMC4wLjEiOiB0dGw6ICAgICAgICAgIDM2MDAKCQlBQUFBOiAiMDowOjA6MDowOjA6MDoxIjogdHRsOiAzNjAwCgl9Cn0KCi8vICJhbm90aGVyLWRvbWFpbi5leGFtcGxlIiBpcyBhIGRvbWFpbiBjb250YWluaW5nOgovLyAgIC0gYSBwb2ludGVyIHRvIGEgc2l0ZSBhdCB0aGUgZG9tYWluIGFwZXgKLy8gICAtIGEgcG9pbnRlciB0byB0aGUgZG9tYWluIGFwZXggYXQgInd3dy4iCnpvbmVzOiAiYW5vdGhlci1kb21haW4uZXhhbXBsZSI6IHsKCS8vIHRoZSB6b25lIGFwZXggdXNlcyB0aGUgcHJvdmlkZXIncyBBTkFNRS9BTElBUyBmZWF0dXJlIGZvciBDTkFNRS1saWtlCgkvLyBiZWhhdmlvdXIgYXQgdGhlIHpvbmUncyByb290CgkiQCI6IEFOQU1FOiAid3d3LmV4YW1wbGUuY29tIjogdHRsOiA4NjQwMAoKCS8vICJ3d3ciIGlzIGEgQ05BTUUgdG8gdGhlIHpvbmUgYXBleAoJd3d3OiBDTkFNRTogImFub3RoZXItZG9tYWluLmV4YW1wbGUiOiB0dGw6IDMwMAp9">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> dns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// This file contains DNS records for 3 separate zones:</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - &#34;my-primary-domain.test&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - &#34;infrastructure-domain.test&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - &#34;another-domain.example&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// Each zone has Google Workspace email-related DNS records (MX, SPF, and</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// DKIM), as templated by the CUE in &#34;shared.cue&#34;.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// Additionally, in this file:</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// &#34;my-primary-domain.test&#34; is a domain containing:</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - a Wordpress site at my-primary-domain.test</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - a different website at www.my-primary-domain.test</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - a Wordpress-hosted blog at blog.my-primary-domain.test</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - a test blog at test.blog.my-primary-domain.test</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - an internally-hosted site split across 2 servers at dev.my-primary-domain.test</span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;my-primary-domain.test&#34;</span><span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// the zone apex uses the provider&#39;s ANAME/ALIAS feature for CNAME-like</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// behaviour at the zone&#39;s root, resolving to a Wordpress.com-hosted site</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;@&#34;</span><span style="font-weight:bold">:</span> ANAME<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;lb.wordpress.com&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">3600</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// &#34;www&#34; has a pair of IPv4 and IPv6 records, with harmonised TTLs</span>
</span></span><span style="display:flex;"><span>	www<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>		_www_ttl<span style="font-weight:bold">:</span> <span style="color:#099">300</span>
</span></span><span style="display:flex;"><span>		A<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;192.0.2.0&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span>                                 _www_ttl
</span></span><span style="display:flex;"><span>		A<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;198.51.100.0&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span>                              _www_ttl
</span></span><span style="display:flex;"><span>		AAAA<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;2001:db8:0001:0001:0001:0001:0001:0001&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> _www_ttl
</span></span><span style="display:flex;"><span>		AAAA<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;2001:db8:ffff:ffff:ffff:ffff:ffff:ffff&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> _www_ttl
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// &#34;blog&#34; is a Wordpress.com site with a custom domain</span>
</span></span><span style="display:flex;"><span>	blog<span style="font-weight:bold">:</span> CNAME<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;lb.wordpress.com&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">3600</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// &#34;test.blog&#34; is a CNAME towards a Heroku-hosted test instance of Wordpress</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;test.blog&#34;</span><span style="font-weight:bold">:</span> CNAME<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;whispering-willow-5678.ssl.herokudns.com&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">3600</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// &#34;dev&#34; has round-robin A records, with linked TTLs</span>
</span></span><span style="display:flex;"><span>	dev<span style="font-weight:bold">:</span> A<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;192.168.0.1&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">600</span>
</span></span><span style="display:flex;"><span>	dev<span style="font-weight:bold">:</span> A<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;192.168.1.1&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">2</span> <span style="font-weight:bold">*</span> dev.A.<span style="color:#b84">&#34;192.168.0.1&#34;</span>.ttl
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// &#34;infrastructure-domain.test&#34; is a domain containing:</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - a site at the domain apex</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - a pointer to a different site at &#34;www.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - some IPv4 and IPv6 records at &#34;local.&#34;</span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;infrastructure-domain.test&#34;</span><span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// the zone apex A record</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;@&#34;</span><span style="font-weight:bold">:</span> A<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;172.20.1.2&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">3600</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// &#34;www&#34; is a CNAME to another host&#34;</span>
</span></span><span style="display:flex;"><span>	www<span style="font-weight:bold">:</span> CNAME<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;www.example.com&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">300</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// &#34;local&#34; has both v4 and v6 IP records</span>
</span></span><span style="display:flex;"><span>	local<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>		A<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;127.0.0.1&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span>          <span style="color:#099">3600</span>
</span></span><span style="display:flex;"><span>		AAAA<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;0:0:0:0:0:0:0:1&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">3600</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// &#34;another-domain.example&#34; is a domain containing:</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - a pointer to a site at the domain apex</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//   - a pointer to the domain apex at &#34;www.&#34;</span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;another-domain.example&#34;</span><span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// the zone apex uses the provider&#39;s ANAME/ALIAS feature for CNAME-like</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// behaviour at the zone&#39;s root</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;@&#34;</span><span style="font-weight:bold">:</span> ANAME<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;www.example.com&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">86400</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// &#34;www&#34; is a CNAME to the zone apex</span>
</span></span><span style="display:flex;"><span>	www<span style="font-weight:bold">:</span> CNAME<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;another-domain.example&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">300</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>
</p>
<p><code>zones.cue</code> contains the structured data that represents each zone - notice how
compact the data format is. Later in this guide you&rsquo;ll adapt this file to
reflect your DNS zones.</p>
<h4 id="arrow_right-create-policycue">
    <a href="#arrow_right-create-policycue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create <code>policy.cue</code></h4>
<p>:floppy_disk: <code>policy.cue</code>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="policy.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="policy.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>policy.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="policy.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBkbnMKCnpvbmVzPzogewoJLy8gVGhlc2UgcG9saWNpZXMgYXBwbHkgdG8gYWxsIHpvbmVzCglbX106IHsKCQkvLyB3d3cgbXVzdCBleGlzdAoJCXd3dyE6IF8KCX0KCgkvLyBUaGVzZSBwb2xpY2llcyBhcHBseSBvbmx5IHRvIG91ciBwcmltYXJ5IGRvbWFpbgoJIm15LXByaW1hcnktZG9tYWluLnRlc3QiOiB7CgkJLy8gImJsb2cubXktcHJpbWFyeS1kb21haW4udGVzdCIsIG11c3QgZXhpc3QgKGFzIGl0IG1ha2VzIGFsbCBvdXIgcmV2ZW51ZSkKCQlibG9nITogXwoJfQp9CgovLyBUaGUgZGVmaW5pdGlvbiBvZiAjVFRMIGluIGBzY2hlbWEuY3VlYCB1bmlmaWVzIHdpdGggdGhpcyBkZWZpbml0aW9uLgovLyBSZXF1aXJlIHRoYXQgYWxsIFRUTHMgYXJlIDYwIHNlY29uZHMgb3IgZ3JlYXRlcgojVFRMOiA&#43;PTYw">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> dns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">?:</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// These policies apply to all zones</span>
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">[</span><span style="font-weight:bold">_</span><span style="font-weight:bold">]:</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">// www must exist</span>
</span></span><span style="display:flex;"><span>		www<span style="font-weight:bold">!:</span> <span style="font-weight:bold">_</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// These policies apply only to our primary domain</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;my-primary-domain.test&#34;</span><span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">// &#34;blog.my-primary-domain.test&#34;, must exist (as it makes all our revenue)</span>
</span></span><span style="display:flex;"><span>		blog<span style="font-weight:bold">!:</span> <span style="font-weight:bold">_</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// The definition of #TTL in `schema.cue` unifies with this definition.</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// Require that all TTLs are 60 seconds or greater</span>
</span></span><span style="display:flex;"><span>#TTL<span style="font-weight:bold">:</span> <span style="font-weight:bold">&gt;=</span><span style="color:#099">60</span></span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>
</p>
<h4 id="arrow_right-create-sharedcue">
    <a href="#arrow_right-create-sharedcue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create <code>shared.cue</code></h4>
<p>:floppy_disk: <code>shared.cue</code>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="shared.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="shared.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>shared.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="shared.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBkbnMKCnpvbmVzOiBbWm9uZT1zdHJpbmddOiB7CgkiQCI6IHsKCQlNWDogewoJCQlfbXhfdHRsOiAzNjAwCgkJCSJhc3BteC5sLmdvb2dsZS5jb20iOiB7cHJpOiAxLCB0dGw6IF9teF90dGx9CgkJCSJhbHQxLmFzcG14LmwuZ29vZ2xlLmNvbSI6IHtwcmk6IDUsIHR0bDogX214X3R0bH0KCQkJImFsdDIuYXNwbXgubC5nb29nbGUuY29tIjoge3ByaTogNSwgdHRsOiBfbXhfdHRsfQoJCQkiYWx0My5hc3BteC5sLmdvb2dsZS5jb20iOiB7cHJpOiAxMCwgdHRsOiBfbXhfdHRsfQoJCQkiYWx0NC5hc3BteC5sLmdvb2dsZS5jb20iOiB7cHJpOiAxMCwgdHRsOiBfbXhfdHRsfQoJCX0KCQlUWFQ6ICJ2PXNwZjEgaW5jbHVkZTpfc3BmLmdvb2dsZS5jb20gfmFsbCI6IHR0bDogMzYwMAoJfQoJI0RLSU0/OiBwdWJrZXk/OiBzdHJpbmcKCWlmICNES0lNICE9IF98XyBpZiAjREtJTS5wdWJrZXkgIT0gX3xfIHsKCQkiZ29vZ2xlLl9kb21haW5rZXkiOiBUWFQ6ICJ2PURLSU0xOyBrPXJzYTsgcD1cKCNES0lNLnB1YmtleSkiOiB0dGw6IDYwMAoJfQp9Cgp6b25lczogIm15LXByaW1hcnktZG9tYWluLnRlc3QiOiAjREtJTTogcHVia2V5OgoJIk1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBcElOaWpwc0R4eTEyV3Z3SW9OWnZPNGhUKzczQmF0QmZxTVVXTVMrRFd3UlY2a0pIbGlsMFRKVVpXSi9Ud3dmUkdGYmtqejRFSXNtaytZaXBMUmRCSVlEOU5ERjdjMmZQMjMrWFdYSnRJcTI3bi84OG0valp5RHI1TjRZUUNYTTR5VXBZYmFsODRSS0FkZWJFcWVJbndUazJVS3FmUTR5c29KZFdaelk4d2tDVUlORDNBeVU4Z0JYK3VxM2JkTExXVU5KcDRVd2U0RVkwVEVuMjh4Wnk1UjBoZElMUEFOUy9sMDdRcE9vY3czLzFJV0NobVJiLzJoNC82NFBMSmZLdmVUQXBHSkJOTk5xQlRxb2xLQU1aamJWdTZnTk1XaTA0dEdrRWNEMm83emVuSEY4cExLdVV4bVpBTTFaL3ZvVGp4aURmcjFxOXBPUyt2cWcyTFh2MVV3SURBUUFCIgoKem9uZXM6ICJpbmZyYXN0cnVjdHVyZS1kb21haW4udGVzdCI6ICNES0lNOiBwdWJrZXk6CgkiTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFwSU5panBzRHh5MTJXdndJb05adk80aFQrNzNCYXRCZnFNVVdNUytEV3dSVjZrSkhsaWwwVEpVWldKL1R3d2ZSR0Zia2p6NEVJc21rK1lpcExSZEJJWUQ5TkRGN2MyZlAyMytYV1hKdElxMjduLzg4bS9qWnlEcjVONFlRQ1hNNHlVcFliYWw4NFJLQWRlYkVxZUluZmtza3Zta2w0bWczNGdHZHNmZyVoeTUzcmVmZ3NodHJ3ZWRzZGdkZmhoU1NTU1NTYWZncnRoZ2RzZGNjXHZmdGpoamFzYWZhcy9mZHNzc2RmL2dmZGRhc2RoaHJncnNkMmg0LzY0UExKZkt2ZVRBcEdKQk5OTnFCVHFvbEtBTVpqYlZ1NmdOTVdpMDR0R2tFY0Qybzd6ZW5IRjhwTEt1VXhtWkFNMVovdm9UanhpRGZyMXE5cE9TK3ZxZzJMWHYxVXdJREFRQUIiCgp6b25lczogImFub3RoZXItZG9tYWluLmV4YW1wbGUiOiAjREtJTTogcHVia2V5OgoJIk1JSUJJakFOQmdha3ZrNGtmbWtkZGRkYWR2cmVmc2RnZnNkZmRhc2dmUUVBcElOaWpwc0R4eTEyV3Z3SW9OWnZPNGhUKzczQmF0QmZxTVVXTVMrRFd3UlY2a0pIbGlsMFRKVVpXSi9Ud3dmUkdGYmtqejRFSXNtaytZaXBMUmRCSVl0NGtmY2tsc2RhbWt2a2xkZnNsYW1uY3ZrZG1hc2xmbnZua3NsbXZtc2R2L2FlZm1rc2Rsc2RtZ21rc2FkbWdrZHNoSEdFVCRIUzN0dGc1elk4d2tDVUlORDNBeVU4Z0JYK3VxM2JkTExXVU5KcDRVd2U0RVkwVEVuMjh4Wnk1UjBoZElMUEFOUy9sMDdRcE9vY3czLzFJV0NobVJiLzJoNC82NFBMSmZLdmVUQXBHSkJOTk5xQlRxb2xLQU1aamJWdTZnTk1XaTA0dEdrRWNEMm83emVuSEY4cExLdVV4bVpBTTFaL3ZvVGp4aURmcjFxOXBPUyt2cWcyTFh2MVV3SURBUUFCIg==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> dns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>Zone<span style="font-weight:bold">=</span><span style="color:#458;font-weight:bold">string</span><span style="font-weight:bold">]:</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;@&#34;</span><span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>		MX<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>			_mx_ttl<span style="font-weight:bold">:</span> <span style="color:#099">3600</span>
</span></span><span style="display:flex;"><span>			<span style="color:#b84">&#34;aspmx.l.google.com&#34;</span><span style="font-weight:bold">:</span> {pri<span style="font-weight:bold">:</span> <span style="color:#099">1</span><span style="font-weight:bold">,</span> ttl<span style="font-weight:bold">:</span> _mx_ttl}
</span></span><span style="display:flex;"><span>			<span style="color:#b84">&#34;alt1.aspmx.l.google.com&#34;</span><span style="font-weight:bold">:</span> {pri<span style="font-weight:bold">:</span> <span style="color:#099">5</span><span style="font-weight:bold">,</span> ttl<span style="font-weight:bold">:</span> _mx_ttl}
</span></span><span style="display:flex;"><span>			<span style="color:#b84">&#34;alt2.aspmx.l.google.com&#34;</span><span style="font-weight:bold">:</span> {pri<span style="font-weight:bold">:</span> <span style="color:#099">5</span><span style="font-weight:bold">,</span> ttl<span style="font-weight:bold">:</span> _mx_ttl}
</span></span><span style="display:flex;"><span>			<span style="color:#b84">&#34;alt3.aspmx.l.google.com&#34;</span><span style="font-weight:bold">:</span> {pri<span style="font-weight:bold">:</span> <span style="color:#099">10</span><span style="font-weight:bold">,</span> ttl<span style="font-weight:bold">:</span> _mx_ttl}
</span></span><span style="display:flex;"><span>			<span style="color:#b84">&#34;alt4.aspmx.l.google.com&#34;</span><span style="font-weight:bold">:</span> {pri<span style="font-weight:bold">:</span> <span style="color:#099">10</span><span style="font-weight:bold">,</span> ttl<span style="font-weight:bold">:</span> _mx_ttl}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		TXT<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;v=spf1 include:_spf.google.com ~all&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">3600</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	#DKIM<span style="font-weight:bold">?:</span> pubkey<span style="font-weight:bold">?:</span> <span style="color:#458;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">if</span> #DKIM <span style="font-weight:bold">!=</span> <span style="font-weight:bold">_|_</span> <span style="font-weight:bold">if</span> #DKIM.pubkey <span style="font-weight:bold">!=</span> <span style="font-weight:bold">_|_</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#b84">&#34;google._domainkey&#34;</span><span style="font-weight:bold">:</span> TXT<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;v=DKIM1; k=rsa; p=</span><span style="color:#b84">\(</span>#DKIM.pubkey<span style="color:#b84">)</span><span style="color:#b84">&#34;</span><span style="font-weight:bold">:</span> ttl<span style="font-weight:bold">:</span> <span style="color:#099">600</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;my-primary-domain.test&#34;</span><span style="font-weight:bold">:</span> #DKIM<span style="font-weight:bold">:</span> pubkey<span style="font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApINijpsDxy12WvwIoNZvO4hT+73BatBfqMUWMS+DWwRV6kJHlil0TJUZWJ/TwwfRGFbkjz4EIsmk+YipLRdBIYD9NDF7c2fP23+XWXJtIq27n/88m/jZyDr5N4YQCXM4yUpYbal84RKAdebEqeInwTk2UKqfQ4ysoJdWZzY8wkCUIND3AyU8gBX+uq3bdLLWUNJp4Uwe4EY0TEn28xZy5R0hdILPANS/l07QpOocw3/1IWChmRb/2h4/64PLJfKveTApGJBNNNqBTqolKAMZjbVu6gNMWi04tGkEcD2o7zenHF8pLKuUxmZAM1Z/voTjxiDfr1q9pOS+vqg2LXv1UwIDAQAB&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;infrastructure-domain.test&#34;</span><span style="font-weight:bold">:</span> #DKIM<span style="font-weight:bold">:</span> pubkey<span style="font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApINijpsDxy12WvwIoNZvO4hT+73BatBfqMUWMS+DWwRV6kJHlil0TJUZWJ/TwwfRGFbkjz4EIsmk+YipLRdBIYD9NDF7c2fP23+XWXJtIq27n/88m/jZyDr5N4YQCXM4yUpYbal84RKAdebEqeInfkskvmkl4mg34gGdsfg%hy53refgshtrwedsdgdfhhSSSSSSafgrthgdsdcc\vftjhjasafas/fdsssdf/gfddasdhhrgrsd2h4/64PLJfKveTApGJBNNNqBTqolKAMZjbVu6gNMWi04tGkEcD2o7zenHF8pLKuUxmZAM1Z/voTjxiDfr1q9pOS+vqg2LXv1UwIDAQAB&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;another-domain.example&#34;</span><span style="font-weight:bold">:</span> #DKIM<span style="font-weight:bold">:</span> pubkey<span style="font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;MIIBIjANBgakvk4kfmkddddadvrefsdgfsdfdasgfQEApINijpsDxy12WvwIoNZvO4hT+73BatBfqMUWMS+DWwRV6kJHlil0TJUZWJ/TwwfRGFbkjz4EIsmk+YipLRdBIYt4kfcklsdamkvkldfslamncvkdmaslfnvnkslmvmsdv/aefmksdlsdmgmksadmgkdshHGET$HS3ttg5zY8wkCUIND3AyU8gBX+uq3bdLLWUNJp4Uwe4EY0TEn28xZy5R0hdILPANS/l07QpOocw3/1IWChmRb/2h4/64PLJfKveTApGJBNNNqBTqolKAMZjbVu6gNMWi04tGkEcD2o7zenHF8pLKuUxmZAM1Z/voTjxiDfr1q9pOS+vqg2LXv1UwIDAQAB&#34;</span></span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>
</p>
<p><code>shared.cue</code> uses CUE&rsquo;s &ldquo;template&rdquo; feature to add records to all the zones
contained in <code>zones.cue</code>. We use it in this guide&rsquo;s example data to create the
same Google Workspace MX (Mail eXchanger) and SPF (Sender Policy Framework)
records in every zone, and to set up DKIM-related CNAMEs that have
zone-specific keys placed inside a standardised record structure.</p>
<p>Note that <em>these are simply examples</em> of specifying types of DNS records that
often need to be kept in sync across multiple domains - you don&rsquo;t <em>need</em> to
have them set up like this.</p>
<h4 id="arrow_right-create-schemacue">
    <a href="#arrow_right-create-schemacue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create <code>schema.cue</code></h4>
<p>:floppy_disk: <code>schema.cue</code>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="schema.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="schema.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>schema.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="schema.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBkbnMKCmltcG9ydCAibmV0IgoKem9uZXM6IFtfXTogI1pvbmUKCiNab25lOiB7CglbI0hvc3RdOiB7CgkJQT86ICAgICAjQQoJCUFBQUE/OiAgI0FBQUEKCQlBTkFNRT86ICNBTkFNRQoJCUNOQU1FPzogI0NOQU1FCgkJTVg/OiAgICAjTVgKCQlOUz86ICAgICNOUwoJCVRYVD86ICAgI1RYVAoJfQoJI0RLSU0/OiBwdWJrZXk/OiBzdHJpbmcKfQoKI0hvc3Q6ICNGUUROIHwgIkAiIC8vICJAIiBpbmRpY2F0ZXMgdGhlIHpvbmUgYXBleC9yb290CiNGUUROOiBuZXQuRlFETiAmIHN0cmluZwoKI0E6IFsjSVB2NF06ICAgICAjUmVjb3JkCiNBQUFBOiBbI0lQdjZdOiAgI1JlY29yZAojQU5BTUU6IFsjRlFETl06ICNSZWNvcmQKI0NOQU1FOiBbI0ZRRE5dOiAjUmVjb3JkCiNNWDogWyNGUUROXTogI1JlY29yZCAmIHsKCXByaTogaW50Cn0KI05TOiBbI0ZRRE5dOiAgICNSZWNvcmQKI1RYVDogW3N0cmluZ106ICNSZWNvcmQKCiNSZWNvcmQ6IHsKCXR0bDogI1RUTAoJLi4uCn0KI1RUTDogaW50ICYgPj0wICYgPD0yMTQ3NDgzNjQ3CgojSVB2Njogc3RyaW5nIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9jdWUtbGFuZy9jdWUvaXNzdWVzLzI2MTQKI0lQdjQ6IG5ldC5JUHY0ICYgc3RyaW5n">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> dns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">import</span> <span style="color:#b84">&#34;net&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zones<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span><span style="font-weight:bold">_</span><span style="font-weight:bold">]:</span> #Zone
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Zone<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">[</span>#Host<span style="font-weight:bold">]:</span> {
</span></span><span style="display:flex;"><span>		A<span style="font-weight:bold">?:</span>     #A
</span></span><span style="display:flex;"><span>		AAAA<span style="font-weight:bold">?:</span>  #AAAA
</span></span><span style="display:flex;"><span>		ANAME<span style="font-weight:bold">?:</span> #ANAME
</span></span><span style="display:flex;"><span>		CNAME<span style="font-weight:bold">?:</span> #CNAME
</span></span><span style="display:flex;"><span>		MX<span style="font-weight:bold">?:</span>    #MX
</span></span><span style="display:flex;"><span>		NS<span style="font-weight:bold">?:</span>    #NS
</span></span><span style="display:flex;"><span>		TXT<span style="font-weight:bold">?:</span>   #TXT
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	#DKIM<span style="font-weight:bold">?:</span> pubkey<span style="font-weight:bold">?:</span> <span style="color:#458;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Host<span style="font-weight:bold">:</span> #FQDN <span style="font-weight:bold">|</span> <span style="color:#b84">&#34;@&#34;</span> <span style="color:#998;font-style:italic">// &#34;@&#34; indicates the zone apex/root</span>
</span></span><span style="display:flex;"><span>#FQDN<span style="font-weight:bold">:</span> net.FQDN <span style="font-weight:bold">&amp;</span> <span style="color:#458;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#A<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>#IPv4<span style="font-weight:bold">]:</span>     #Record
</span></span><span style="display:flex;"><span>#AAAA<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>#IPv6<span style="font-weight:bold">]:</span>  #Record
</span></span><span style="display:flex;"><span>#ANAME<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>#FQDN<span style="font-weight:bold">]:</span> #Record
</span></span><span style="display:flex;"><span>#CNAME<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>#FQDN<span style="font-weight:bold">]:</span> #Record
</span></span><span style="display:flex;"><span>#MX<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>#FQDN<span style="font-weight:bold">]:</span> #Record <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>	pri<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">int</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>#NS<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>#FQDN<span style="font-weight:bold">]:</span>   #Record
</span></span><span style="display:flex;"><span>#TXT<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span><span style="color:#458;font-weight:bold">string</span><span style="font-weight:bold">]:</span> #Record
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Record<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	ttl<span style="font-weight:bold">:</span> #TTL
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>#TTL<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">int</span> <span style="font-weight:bold">&amp;</span> <span style="font-weight:bold">&gt;=</span><span style="color:#099">0</span> <span style="font-weight:bold">&amp;</span> <span style="font-weight:bold">&lt;=</span><span style="color:#099">2147483647</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#IPv6<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">string</span> <span style="color:#998;font-style:italic">// https://github.com/cue-lang/cue/issues/2614</span>
</span></span><span style="display:flex;"><span>#IPv4<span style="font-weight:bold">:</span> net.IPv4 <span style="font-weight:bold">&amp;</span> <span style="color:#458;font-weight:bold">string</span></span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>
</p>
<p><code>schema.cue</code> contains the schema for the DNS zones and records you&rsquo;ll provide.
CUE will validate your data against this schema each time the data is used,
flagging up mistakes before they&rsquo;re submitted to the API.</p>
<p>This file should be used as presented, without adapting it. It doesn&rsquo;t contain
any zone- or record-specific data.</p>
<h4 id="arrow_right-create-dns_toolcue">
    <a href="#arrow_right-create-dns_toolcue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create <code>dns_tool.cue</code></h4>
<hr>
<details>
<summary>
:floppy_disk: <code>dns_tool.cue</code> (click to open)
</summary>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="dns_tool.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="dns_tool.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>dns_tool.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="dns_tool.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBkbnMKCmltcG9ydCAoCgkidG9vbC9odHRwIgoJInRvb2wvY2xpIgoJInRvb2wvb3MiCgkiZW5jb2RpbmcvYmFzZTY0IgoJImVuY29kaW5nL2pzb24iCgkiZW5jb2RpbmcveWFtbCIKKQoKY29tbWFuZDogdXBkYXRlOiB7CgkvLyBodHRwczovL3d3dy5teXRoaWMtYmVhc3RzLmNvbS9zdXBwb3J0L2FwaS9hdXRoCglhdXRoOiB7CgkJZW52OiBvcy5FbnZpcm9uICYgewoJCQlNWVRISUNfQkVBU1RTX0FQSV9LRVlfSUQ6IHN0cmluZwoJCQlNWVRISUNfQkVBU1RTX0FQSV9TRUNSRVQ6IHN0cmluZwoJCX0KCQlsb2dpbjogaHR0cC5Qb3N0ICYgewoJCQlfYXV0aDogewoJCQkJdXNlcm5hbWU6IGVudi5NWVRISUNfQkVBU1RTX0FQSV9LRVlfSUQKCQkJCXBhc3N3b3JkOiBlbnYuTVlUSElDX0JFQVNUU19BUElfU0VDUkVUCgkJCQloZWFkZXI6ICAgIkJhc2ljICIgKyBiYXNlNjQuRW5jb2RlKG51bGwsICJcKHVzZXJuYW1lKTpcKHBhc3N3b3JkKSIpCgkJCX0KCgkJCS8vIGh0dHBzOi8vd3d3Lm15dGhpYy1iZWFzdHMuY29tL3N1cHBvcnQvYXBpL2F1dGgjc2VjLW9idGFpbmluZy1hLXRva2VuCgkJCXVybDogImh0dHBzOi8vYXV0aC5teXRoaWMtYmVhc3RzLmNvbS9sb2dpbiIKCQkJdGxzOiB2ZXJpZnk6ICAgdHJ1ZQoJCQlyZXF1ZXN0OiBib2R5OiAiZ3JhbnRfdHlwZT1jbGllbnRfY3JlZGVudGlhbHMiCgkJCXJlcXVlc3Q6IGhlYWRlcjogQXV0aG9yaXphdGlvbjogIF9hdXRoLmhlYWRlcgoJCQlyZXF1ZXN0OiBoZWFkZXI6ICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIgoJCQlyZXNwb25zZTogc3RhdHVzQ29kZTogMjAwCgkJfQoKCQkvLyBodHRwczovL3d3dy5teXRoaWMtYmVhc3RzLmNvbS9zdXBwb3J0L2FwaS9hdXRoI3NlYy1tYWtpbmctYXBpLXJlcXVlc3RzCgkJdG9rZW46ICJCZWFyZXIgIiArIGpzb24uVW5tYXJzaGFsKGxvZ2luLnJlc3BvbnNlLmJvZHkpLmFjY2Vzc190b2tlbgoJfQoJZm9yIHpvbmVfbmFtZSwgcmVjb3JkcyBpbiBfbXl0aGljX2JlYXN0X3pvbmVfcmVjb3JkcyB7CgkJYXBpX3JlcXVlc3Q9InJlcGxhY2VfXCh6b25lX25hbWUpIjogaHR0cC5QdXQgJiB7CgkJCS8vIGh0dHBzOi8vd3d3Lm15dGhpYy1iZWFzdHMuY29tL3N1cHBvcnQvYXBpL2Ruc3YyI2VwLXB1dC16b25lc3pvbmVyZWNvcmRzCgkJCXVybDogImh0dHBzOi8vYXBpLm15dGhpYy1iZWFzdHMuY29tL2Rucy92Mi96b25lcy9cKHpvbmVfbmFtZSkvcmVjb3Jkcz9leGNsdWRlLXRlbXBsYXRlJmV4Y2x1ZGUtZ2VuZXJhdGVkIgoJCQlyZXF1ZXN0OiBib2R5OiBqc29uLk1hcnNoYWwoeyJyZWNvcmRzIjogcmVjb3Jkc30pCgkJCXJlcXVlc3Q6IGhlYWRlcjogQXV0aG9yaXphdGlvbjogIGF1dGgudG9rZW4KCQkJcmVxdWVzdDogaGVhZGVyOiAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iCgkJCXJlc3BvbnNlOiBzdGF0dXNDb2RlOiAyMDAKCQl9CgkJInJlc3BvbnNlX1woem9uZV9uYW1lKSI6IGNsaS5QcmludCAmIHsKCQkJdGV4dDoganNvbi5NYXJzaGFsKHsoem9uZV9uYW1lKToganNvbi5Vbm1hcnNoYWwoYXBpX3JlcXVlc3QucmVzcG9uc2UuYm9keSl9KQoJCX0KCX0KfQoKY29tbWFuZDogZHVtcDogY2xpLlByaW50ICYgewoJdGV4dDogeWFtbC5NYXJzaGFsKHpvbmVzKQp9CgovLyBodHRwczovL3d3dy5teXRoaWMtYmVhc3RzLmNvbS9zdXBwb3J0L2FwaS9kbnN2MiNzZWMtcmVxdWVzdC1ib2R5LWpzb24xCl9teXRoaWNfYmVhc3Rfem9uZV9yZWNvcmRzOiBbWm9uZT1zdHJpbmddOiBbLi4uX015dGhpY0JlYXN0c1pvbmVSZWNvcmRdCl9teXRoaWNfYmVhc3Rfem9uZV9yZWNvcmRzOiB7Cglmb3Igem9uZV9uYW1lLCB6b25lX2NvbmZpZyBpbiB6b25lcyB7CgkJKHpvbmVfbmFtZSk6IFsKCQkJZm9yIGhvc3RfbmFtZSwgaG9zdF9jb25maWcgaW4gem9uZV9jb25maWcKCQkJZm9yIHJydHlwZSBpbiBbIkEiLCAiQUFBQSIsICJBTkFNRSIsICJDTkFNRSIsICJOUyIsICJUWFQiXQoJCQlmb3IgX2RhdGEsIF9yZWNvcmQgaW4gKCpob3N0X2NvbmZpZ1tycnR5cGVdIHwge30pIHsKCQkJCXtob3N0OiBob3N0X25hbWUsIHR0bDogX3JlY29yZC50dGwsIHR5cGU6IHJydHlwZSwgZGF0YTogX2RhdGF9CgkJCX0sCgkJCWZvciBob3N0X25hbWUsIGhvc3RfY29uZmlnIGluIHpvbmVfY29uZmlnCgkJCWZvciBfZGF0YSwgX3JlY29yZCBpbiAoKmhvc3RfY29uZmlnLk1YIHwge30pIHsKCQkJCXtob3N0OiBob3N0X25hbWUsIHR0bDogX3JlY29yZC50dGwsIHR5cGU6ICJNWCIsIGRhdGE6IF9kYXRhLCAibXhfcHJpb3JpdHkiOiBfcmVjb3JkLnByaX0KCQkJfSwKCQldCgl9Cn0KCl9NeXRoaWNCZWFzdHNab25lUmVjb3JkOiB7Cglob3N0OiBzdHJpbmcKCXR0bDogIGludAoJdHlwZTogIkEiIHwgIkFBQUEiIHwgIkFOQU1FIiB8ICJDTkFNRSIgfCAiTVgiIHwgIk5TIiB8ICJUWFQiCglkYXRhOiBzdHJpbmcKfQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> dns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;tool/http&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;tool/cli&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;tool/os&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;encoding/base64&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;encoding/json&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;encoding/yaml&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>command<span style="font-weight:bold">:</span> update<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">// https://www.mythic-beasts.com/support/api/auth</span>
</span></span><span style="display:flex;"><span>	auth<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>		env<span style="font-weight:bold">:</span> os.Environ <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>			MYTHIC_BEASTS_API_KEY_ID<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>			MYTHIC_BEASTS_API_SECRET<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		login<span style="font-weight:bold">:</span> http.Post <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>			_auth<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>				username<span style="font-weight:bold">:</span> env.MYTHIC_BEASTS_API_KEY_ID
</span></span><span style="display:flex;"><span>				password<span style="font-weight:bold">:</span> env.MYTHIC_BEASTS_API_SECRET
</span></span><span style="display:flex;"><span>				header<span style="font-weight:bold">:</span>   <span style="color:#b84">&#34;Basic &#34;</span> <span style="font-weight:bold">+</span> base64.Encode(<span style="font-weight:bold">null</span><span style="font-weight:bold">,</span> <span style="color:#b84">&#34;</span><span style="color:#b84">\(</span>username<span style="color:#b84">)</span><span style="color:#b84">:</span><span style="color:#b84">\(</span>password<span style="color:#b84">)</span><span style="color:#b84">&#34;</span>)
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#998;font-style:italic">// https://www.mythic-beasts.com/support/api/auth#sec-obtaining-a-token</span>
</span></span><span style="display:flex;"><span>			url<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;https://auth.mythic-beasts.com/login&#34;</span>
</span></span><span style="display:flex;"><span>			tls<span style="font-weight:bold">:</span> verify<span style="font-weight:bold">:</span>   <span style="font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>			request<span style="font-weight:bold">:</span> body<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;grant_type=client_credentials&#34;</span>
</span></span><span style="display:flex;"><span>			request<span style="font-weight:bold">:</span> header<span style="font-weight:bold">:</span> Authorization<span style="font-weight:bold">:</span>  _auth.header
</span></span><span style="display:flex;"><span>			request<span style="font-weight:bold">:</span> header<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;Content-Type&#34;</span><span style="font-weight:bold">:</span> <span style="color:#b84">&#34;application/x-www-form-urlencoded&#34;</span>
</span></span><span style="display:flex;"><span>			response<span style="font-weight:bold">:</span> statusCode<span style="font-weight:bold">:</span> <span style="color:#099">200</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">// https://www.mythic-beasts.com/support/api/auth#sec-making-api-requests</span>
</span></span><span style="display:flex;"><span>		token<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;Bearer &#34;</span> <span style="font-weight:bold">+</span> json.Unmarshal(login.response.body).access_token
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">for</span> zone_name<span style="font-weight:bold">,</span> records <span style="font-weight:bold">in</span> _mythic_beast_zone_records {
</span></span><span style="display:flex;"><span>		api_request<span style="font-weight:bold">=</span><span style="color:#b84">&#34;replace_</span><span style="color:#b84">\(</span>zone_name<span style="color:#b84">)</span><span style="color:#b84">&#34;</span><span style="font-weight:bold">:</span> http.Put <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#998;font-style:italic">// https://www.mythic-beasts.com/support/api/dnsv2#ep-put-zoneszonerecords</span>
</span></span><span style="display:flex;"><span>			url<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;https://api.mythic-beasts.com/dns/v2/zones/</span><span style="color:#b84">\(</span>zone_name<span style="color:#b84">)</span><span style="color:#b84">/records?exclude-template&amp;exclude-generated&#34;</span>
</span></span><span style="display:flex;"><span>			request<span style="font-weight:bold">:</span> body<span style="font-weight:bold">:</span> json.Marshal({<span style="color:#b84">&#34;records&#34;</span><span style="font-weight:bold">:</span> records})
</span></span><span style="display:flex;"><span>			request<span style="font-weight:bold">:</span> header<span style="font-weight:bold">:</span> Authorization<span style="font-weight:bold">:</span>  auth.token
</span></span><span style="display:flex;"><span>			request<span style="font-weight:bold">:</span> header<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;Content-Type&#34;</span><span style="font-weight:bold">:</span> <span style="color:#b84">&#34;application/json&#34;</span>
</span></span><span style="display:flex;"><span>			response<span style="font-weight:bold">:</span> statusCode<span style="font-weight:bold">:</span> <span style="color:#099">200</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#b84">&#34;response_</span><span style="color:#b84">\(</span>zone_name<span style="color:#b84">)</span><span style="color:#b84">&#34;</span><span style="font-weight:bold">:</span> cli.Print <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>			text<span style="font-weight:bold">:</span> json.Marshal({(zone_name)<span style="font-weight:bold">:</span> json.Unmarshal(api_request.response.body)})
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>command<span style="font-weight:bold">:</span> dump<span style="font-weight:bold">:</span> cli.Print <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>	text<span style="font-weight:bold">:</span> yaml.Marshal(zones)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// https://www.mythic-beasts.com/support/api/dnsv2#sec-request-body-json1</span>
</span></span><span style="display:flex;"><span>_mythic_beast_zone_records<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>Zone<span style="font-weight:bold">=</span><span style="color:#458;font-weight:bold">string</span><span style="font-weight:bold">]:</span> <span style="font-weight:bold">[...</span>_MythicBeastsZoneRecord<span style="font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>_mythic_beast_zone_records<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">for</span> zone_name<span style="font-weight:bold">,</span> zone_config <span style="font-weight:bold">in</span> zones {
</span></span><span style="display:flex;"><span>		(zone_name)<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">for</span> host_name<span style="font-weight:bold">,</span> host_config <span style="font-weight:bold">in</span> zone_config
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">for</span> rrtype <span style="font-weight:bold">in</span> <span style="font-weight:bold">[</span><span style="color:#b84">&#34;A&#34;</span><span style="font-weight:bold">,</span> <span style="color:#b84">&#34;AAAA&#34;</span><span style="font-weight:bold">,</span> <span style="color:#b84">&#34;ANAME&#34;</span><span style="font-weight:bold">,</span> <span style="color:#b84">&#34;CNAME&#34;</span><span style="font-weight:bold">,</span> <span style="color:#b84">&#34;NS&#34;</span><span style="font-weight:bold">,</span> <span style="color:#b84">&#34;TXT&#34;</span><span style="font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">for</span> _data<span style="font-weight:bold">,</span> _record <span style="font-weight:bold">in</span> (<span style="font-weight:bold">*</span>host_config<span style="font-weight:bold">[</span>rrtype<span style="font-weight:bold">]</span> <span style="font-weight:bold">|</span> {}) {
</span></span><span style="display:flex;"><span>				{host<span style="font-weight:bold">:</span> host_name<span style="font-weight:bold">,</span> ttl<span style="font-weight:bold">:</span> _record.ttl<span style="font-weight:bold">,</span> type<span style="font-weight:bold">:</span> rrtype<span style="font-weight:bold">,</span> data<span style="font-weight:bold">:</span> _data}
</span></span><span style="display:flex;"><span>			}<span style="font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">for</span> host_name<span style="font-weight:bold">,</span> host_config <span style="font-weight:bold">in</span> zone_config
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">for</span> _data<span style="font-weight:bold">,</span> _record <span style="font-weight:bold">in</span> (<span style="font-weight:bold">*</span>host_config.MX <span style="font-weight:bold">|</span> {}) {
</span></span><span style="display:flex;"><span>				{host<span style="font-weight:bold">:</span> host_name<span style="font-weight:bold">,</span> ttl<span style="font-weight:bold">:</span> _record.ttl<span style="font-weight:bold">,</span> type<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;MX&#34;</span><span style="font-weight:bold">,</span> data<span style="font-weight:bold">:</span> _data<span style="font-weight:bold">,</span> <span style="color:#b84">&#34;mx_priority&#34;</span><span style="font-weight:bold">:</span> _record.pri}
</span></span><span style="display:flex;"><span>			}<span style="font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>_MythicBeastsZoneRecord<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	host<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>	ttl<span style="font-weight:bold">:</span>  <span style="color:#458;font-weight:bold">int</span>
</span></span><span style="display:flex;"><span>	type<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;A&#34;</span> <span style="font-weight:bold">|</span> <span style="color:#b84">&#34;AAAA&#34;</span> <span style="font-weight:bold">|</span> <span style="color:#b84">&#34;ANAME&#34;</span> <span style="font-weight:bold">|</span> <span style="color:#b84">&#34;CNAME&#34;</span> <span style="font-weight:bold">|</span> <span style="color:#b84">&#34;MX&#34;</span> <span style="font-weight:bold">|</span> <span style="color:#b84">&#34;NS&#34;</span> <span style="font-weight:bold">|</span> <span style="color:#b84">&#34;TXT&#34;</span>
</span></span><span style="display:flex;"><span>	data<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

</details>
<hr>
<p>As with <code>schema.cue</code>, <code>dns_tool.cue</code> is part of the system&rsquo;s implementation,
and should be used as presented.</p>
<p><code>dns_tool.cue</code> contains a CUE workflow command which performs the necessary API requests
to replace all DNS zones&rsquo; records. A CUE workflow command is included here to provide a
way of using the <code>cue</code> command, by itself, to drive changes via the Mythic
Beasts API.</p>
<p>However, because using a CUE workflow command to <em>perform</em> these requests isn&rsquo;t the main
point of this guide, you should feel free to swap it out for anything that
suits your needs better - a shell script, a Golang utility, a Python script:
any language will easily be able to make the necessary requests.</p>
<p>This is because the <em>specific</em> Mythic Beasts API targetted is both <em>genuinely</em>
declarative (meaning it&rsquo;s not just <em>mostly</em> declarative, but also treats
&ldquo;missing&rdquo; records in its input as a request to <em>delete</em> those records) and
atomic (meaning each DNS zone update either succeeds or fails completely).</p>
<p>These two properties mean that <em>any</em> tooling could make the API requests, using
JSON exported by CUE. CUE would still perform early, powerful data validatation
and composition, through the contents of all the CUE files (except
<code>dns_tool.cue</code>), but no complex request payload calculation or interdependent
request sequencing would need to be performed by the <em>tool</em> that calls the API.</p>
<h2 id="make-dns-changes">
    <a href="#make-dns-changes" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Make DNS changes</h2>
<h3 id="grant-api-access-to-the-system">
    <a href="#grant-api-access-to-the-system" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Grant API access to the system</h3>
<h4 id="arrow_right-create-an-api-key">
    <a href="#arrow_right-create-an-api-key" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create an API key</h4>
<p>Create an API key via
<a href="https://www.mythic-beasts.com/customer/api-users/create">the Mythic Beasts UI</a>.</p>
<p>Give the API key an appropriate name.</p>
<p>Under the <code>Primary DNS API v2</code> heading click &ldquo;Add permit&rdquo; once for each zone
you want the system to manage.</p>
<p>For each zone, add a permit with a Hostname setting of <code>*</code>, a Zone setting
matching the DNS zone&rsquo;s name, and a Type setting of <code>(all)</code>.</p>
<p>Click &ldquo;Create API key&rdquo; at the bottom of the page, and copy the API key&rsquo;s ID and
secret from the next page that the site displays.</p>
<h4 id="arrow_right-export-the-api-key">
    <a href="#arrow_right-export-the-api-key" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Export the API key</h4>
<p>Expose the API key to the system by exporting the API key&rsquo;s ID and secret via 2
environment variables:</p>
<ul>
<li><code>MYTHIC_BEASTS_API_KEY_ID</code>: your API key ID</li>
<li><code>MYTHIC_BEASTS_API_SECRET</code>: your API secret</li>
</ul>
<h3 id="edit-the-dns-records-to-match-your-zones">
    <a href="#edit-the-dns-records-to-match-your-zones" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Edit the DNS records to match your zones</h3>
<h4 id="arrow_right-add-your-dns-records">
    <a href="#arrow_right-add-your-dns-records" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Add your DNS records</h4>
<p>Replace the contents of <code>zones.cue</code>, <code>policy.cue</code>, and <code>shared.cue</code> so that
they reflect <em>your</em> DNS zones&rsquo; records - both the zone-specific and shared
records, along with any policies you want to impose on the records now and in
the future.</p>
<p>Make sure to include <strong>all</strong> DNS records that already exist in your zones.</p>
<h4 id="arrow_right-validate-the-dns-records">
    <a href="#arrow_right-validate-the-dns-records" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Validate the DNS records</h4>
<p>Use the <code>dump</code> CUE workflow command to display all the records you&rsquo;ve configured.</p>
<p>:rotating_light::rotating_light::rotating_light:<br>
<strong>For each zone you&rsquo;ve configured, ONLY the records displayed will exist after
using this system. Every currently-existing record that&rsquo;s <em>missing</em> from the
<code>dump</code> workflow command&rsquo;s output will be REMOVED - so check the output against your
current zone contents carefully!</strong><br>
:rotating_light::rotating_light::rotating_light:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGNtZCBkdW1wIHwgaGVhZCAtMjAgPjYuYWN0dWFsLnR4dA==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># cue cmd dump
</span></span><span style="display:flex;"><span>$ cue cmd dump | head -20 &gt;6.actual.txt</span></span></code></pre></div></div>
</div>
<p>Output like this (truncated) example will be displayed:</p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="6.expected.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="6.expected.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>6.expected.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="6.expected.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="bXktcHJpbWFyeS1kb21haW4udGVzdDoKICAnQCc6CiAgICBBTkFNRToKICAgICAgbGIud29yZHByZXNzLmNvbToKICAgICAgICB0dGw6IDM2MDAKICAgIE1YOgogICAgICBhc3BteC5sLmdvb2dsZS5jb206CiAgICAgICAgcHJpOiAxCiAgICAgICAgdHRsOiAzNjAwCiAgICAgIGFsdDEuYXNwbXgubC5nb29nbGUuY29tOgogICAgICAgIHByaTogNQogICAgICAgIHR0bDogMzYwMAogICAgICBhbHQyLmFzcG14LmwuZ29vZ2xlLmNvbToKICAgICAgICBwcmk6IDUKICAgICAgICB0dGw6IDM2MDAKICAgICAgYWx0My5hc3BteC5sLmdvb2dsZS5jb206CiAgICAgICAgcHJpOiAxMAogICAgICAgIHR0bDogMzYwMAogICAgICBhbHQ0LmFzcG14LmwuZ29vZ2xlLmNvbToKICAgICAgICBwcmk6IDEw">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>my-primary-domain.test:
</span></span><span style="display:flex;"><span>  &#39;@&#39;:
</span></span><span style="display:flex;"><span>    ANAME:
</span></span><span style="display:flex;"><span>      lb.wordpress.com:
</span></span><span style="display:flex;"><span>        ttl: 3600
</span></span><span style="display:flex;"><span>    MX:
</span></span><span style="display:flex;"><span>      aspmx.l.google.com:
</span></span><span style="display:flex;"><span>        pri: 1
</span></span><span style="display:flex;"><span>        ttl: 3600
</span></span><span style="display:flex;"><span>      alt1.aspmx.l.google.com:
</span></span><span style="display:flex;"><span>        pri: 5
</span></span><span style="display:flex;"><span>        ttl: 3600
</span></span><span style="display:flex;"><span>      alt2.aspmx.l.google.com:
</span></span><span style="display:flex;"><span>        pri: 5
</span></span><span style="display:flex;"><span>        ttl: 3600
</span></span><span style="display:flex;"><span>      alt3.aspmx.l.google.com:
</span></span><span style="display:flex;"><span>        pri: 10
</span></span><span style="display:flex;"><span>        ttl: 3600
</span></span><span style="display:flex;"><span>      alt4.aspmx.l.google.com:
</span></span><span style="display:flex;"><span>        pri: 10</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<h3 id="replace-dns-zones">
    <a href="#replace-dns-zones" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Replace DNS zones</h3>
<h4 id="arrow_right-change-all-dns-records-in-all-zones">
    <a href="#arrow_right-change-all-dns-records-in-all-zones" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Change <em>all</em> DNS records in <em>all</em> zones</h4>
<table>
  <thead>
      <tr>
          <th style="text-align: left">:exclamation: WARNING :exclamation:</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">The API calls used by this guide <strong>completely replace ALL existing records stored in a Mythic Beasts DNS zone</strong>.<br>It is <strong>not possible</strong> to bring such a DNS zone <em>incrementally</em> under the control of the system outlined in this guide.<br><br>To use this guide safely, either use a test DNS zone with unimportant contents, or export the contents of a non-test zone and convert them <em>exhaustively and carefully</em> into the structured data format demonstrated in this guide.</td>
      </tr>
  </tbody>
</table>
<p>Having read the warning, above, invoke the CUE workflow command as follows.</p>
<p><em>This will <strong>replace</strong> all DNS records across all the zones you&rsquo;ve configured</em>:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGNtZCB1cGRhdGU=">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>cue cmd update</span></span></code></pre></div></div>
</div>
<p>Upon success, the following output is displayed:</p>
<div class="code-block"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="eyJpbmZyYXN0cnVjdHVyZS1kb21haW4udGVzdCI6eyJtZXNzYWdlIjoiMTEgcmVjb3JkcyBhZGRlZCIsInJlY29yZHNfYWRkZWQiOjExLCJyZWNvcmRzX3JlbW92ZWQiOjExfX0KeyJteS1wcmltYXJ5LWRvbWFpbi50ZXN0Ijp7Im1lc3NhZ2UiOiIxNiByZWNvcmRzIGFkZGVkIiwicmVjb3Jkc19hZGRlZCI6MTYsInJlY29yZHNfcmVtb3ZlZCI6MTJ9fQp7ImFub3RoZXItZG9tYWluLmV4YW1wbGUiOnsibWVzc2FnZSI6IjkgcmVjb3JkcyBhZGRlZCIsInJlY29yZHNfYWRkZWQiOjksInJlY29yZHNfcmVtb3ZlZCI6MTN9fQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><pre tabindex="0"><code>{&#34;infrastructure-domain.test&#34;:{&#34;message&#34;:&#34;11 records added&#34;,&#34;records_added&#34;:11,&#34;records_removed&#34;:11}}
{&#34;my-primary-domain.test&#34;:{&#34;message&#34;:&#34;16 records added&#34;,&#34;records_added&#34;:16,&#34;records_removed&#34;:12}}
{&#34;another-domain.example&#34;:{&#34;message&#34;:&#34;9 records added&#34;,&#34;records_added&#34;:9,&#34;records_removed&#34;:13}}</code></pre></div>
</div>
<h4 id="arrow_right-save-your-files">
    <a href="#arrow_right-save-your-files" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Save your files</h4>
<p>Version control all the files that you amended or copied. These should include:</p>
<ul>
<li><code>zones.cue</code></li>
<li><code>policy.cue</code></li>
<li><code>shared.cue</code></li>
<li><code>schema.cue</code></li>
<li><code>dns_tool.cue</code></li>
</ul>
<p>One of CUE&rsquo;s nice properties is that, once you understand how its core
&ldquo;unification&rdquo; mechanism works, you can trivially split the contents of all
these files into as many files as you like. For example, you can keep each
zone in its own file if that layout suits you best.</p>
<h2 id="related-content">
    <a href="#related-content" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Related content</h2>
<ul>
<li>Mythic Beasts API accepts these record types, with these schemata:
<ul>
<li><a href="https://www.mythic-beasts.com/support/api/dnsv2#ep-get-record-types">https://www.mythic-beasts.com/support/api/dnsv2#ep-get-record-types</a></li>
<li><a href="https://api.mythic-beasts.com/dns/v2/record-types">https://api.mythic-beasts.com/dns/v2/record-types</a></li>
</ul>
</li>
<li>The DNS API&rsquo;s OpenAPI schema:
<ul>
<li><a href="https://www.mythic-beasts.com/support/api/dnsv2?format=yaml">https://www.mythic-beasts.com/support/api/dnsv2?format=yaml</a></li>
</ul>
</li>
</ul>

                        
                    </div><footer class="article__footer">
    <div class="article__lastmod">
        <p class="lastmod">
         <a class="lastmod__link" href="https://github.com/cue-lang/cuelang.org/commit/7687bbf072c82a4de99c92407b3260cf711e4cc7">
                Last modified March 27, 2025</a>
    </p>

    </div>

    <div class="article__footer-meta"><div class="article__share"><details class="share" data-dropdown>
    <summary class="button button--icon button--light-blue share__button">
        



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--share"></use>
</svg>

        <span>Open share options</span>
    </summary>

    <ul class="share__list">
        <li class="share__item" data-copy>
            <button class="share__copy" data-copy-button data-copy-type="url" data-copy-value="/docs/draft/cbe-004_mythic_beasts_dns/">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>

                <span class="share__link-text">Copy link</span>
                <span class="share__copy-message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button>
        </li>

        <li class="share__item">
            <a class="share__link" target="_blank" href="https://twitter.com/intent/tweet?url=/docs/draft/cbe-004_mythic_beasts_dns/&text=%20Source:%20https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns%20Managing%20Mythic%20Beasts%20DNS%20zones%20with%20CUE%20by%20Jonathan%20Matthews%20with%20essential%20CUE%20contributions%20from%20Roger%20Peppe%0aIntroduction%20Mythic%20Beasts%20is%20a%20UK-based%20company%20whose%20&amp;ldquo;About&amp;rdquo;%20page%20says%20they%20are%20&amp;hellip;%0aa%20privately%20owned%20hosting%20ISP%20with%20a%20focus%20on%20providing%20services%20to%20technically%20capable%20customers.%0aMythic%20Beasts%20publishes%20an%20API%20that%20allows%20customers%20to%20replace%20all%20the%20DNS%20records%20in%20a%20specific%20zone%20without%20using%20a%20web-based%20control%20panel.%0a">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                <p><span class="share__link-text">Share on X (Twitter)</span></p>
            </a>
        </li>

        <li class="share__item">
            <a class="share__link" target="_blank"
            href="https://www.linkedin.com/shareArticle?mini=true&url=/docs/draft/cbe-004_mythic_beasts_dns/&summary=%20Source:%20https://github.com/cue-labs/cue-by-example/tree/main/004_mythic_beasts_dns%20Managing%20Mythic%20Beasts%20DNS%20zones%20with%20CUE%20by%20Jonathan%20Matthews%20with%20essential%20CUE%20contributions%20from%20Roger%20Peppe%0aIntroduction%20Mythic%20Beasts%20is%20a%20UK-based%20company%20whose%20&amp;ldquo;About&amp;rdquo;%20page%20says%20they%20are%20&amp;hellip;%0aa%20privately%20owned%20hosting%20ISP%20with%20a%20focus%20on%20providing%20services%20to%20technically%20capable%20customers.%0aMythic%20Beasts%20publishes%20an%20API%20that%20allows%20customers%20to%20replace%20all%20the%20DNS%20records%20in%20a%20specific%20zone%20without%20using%20a%20web-based%20control%20panel.%0a">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-linkedin"></use>
</svg>

                <p><span class="share__link-text">Share on Linkedin</span></p>
            </a>
        </li>
    </ul>
</details>
</div>
    </div>
</footer>
</div>
            </article>

            



<div class="prevnext">
    <nav class="prevnext__container" aria-label="Previous/Next navigation"><a class="prevnext__prev" href="/docs/draft/cbe-005_gitlab_ci/" aria-label="Previous - CUE By Example - Driving GitLab CI/CD pipelines with CUE">
                



<svg class="icon prevnext__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--circle-arrow-left"></use>
</svg>

                <span class="prevnext__text">CUE By Example - Driving GitLab CI/CD pipelines with CUE</span>
            </a><a class="prevnext__next" href="/docs/draft/testdata/issue-3796/" aria-label="Next - Issue 3796: code-tabs inside info blocks have unwanted extra vertical spaces">
                <span class="prevnext__text">Issue 3796: code-tabs inside info blocks have unwanted extra vertical spaces</span>
                



<svg class="icon prevnext__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--circle-arrow-right"></use>
</svg>

            </a></nav>
</div>

        </div>
        <div id="docs-menu" class="docs__aside">
            <div class="docs__backdrop" data-docs-close="docs"></div>
            <div class="docs__nav">
                <nav class="tree">
    <ul class="tree__list is-book">
        
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/introduction/" title="Introduction">
            <span class="tree__text">Introduction</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/tour/" title="Tour">
            <span class="tree__text">Tour</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/integration/" title="Integrations">
            <span class="tree__text">Integrations</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/tutorial/" title="Tutorials">
            <span class="tree__text">Tutorials</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/howto/" title="How-to Guides">
            <span class="tree__text">How-to Guides</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/concept/" title="Concept Guides">
            <span class="tree__text">Concept Guides</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/reference/" title="References">
            <span class="tree__text">References</span>
        </a>
    </li>
    </ul>
</nav>



                <button type="button" class="docs__hide button button--icon button--raised button--light-blue"
                        aria-haspopup="menu" aria-expanded="false" aria-controls="docs-menu" data-docs-toggle>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--chevron-left"></use>
</svg>
<span>Hide side navigation</span>
                </button>
            </div>
        </div>

        <button type="button" class="docs__show button button--icon button--raised button--light-blue"
                aria-haspopup="menu" aria-expanded="false" aria-controls="docs-menu" data-docs-toggle>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--chevron-right"></use>
</svg>
<span>Show side navigation</span>
        </button>
    </div>

            </main>

            <footer id="site-footer" class="site__footer">
                




<div class="footer">
    <div class="footer__sitemap">
        <nav class="footer__container" aria-label="Footer menu">
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Get Started</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/">
                                    <span class="nav__text">Documentation</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/tour/">
                                    <span class="nav__text">Language Tour</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/play/">
                                    <span class="nav__text">Playground</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/introduction/installation/">
                                    <span class="nav__text">Install CUE</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Community</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/community">
                                    <span class="nav__text">The CUE Community</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://github.com/cue-lang/cue/blob/master/CONTRIBUTING.md#contribution-guide" target="_blank">
                                    <span class="nav__text">Contributing</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/reference/code-of-conduct/">
                                    <span class="nav__text">Code of Conduct</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/s/slack">
                                    <span class="nav__text">Slack Workspace</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/s/discord">
                                    <span class="nav__text">Discord Server</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Connect</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://github.com/cue-lang/cue" target="_blank">
                                    <span class="nav__text">GitHub</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://twitter.com/cue_lang" target="_blank">
                                    <span class="nav__text">X (Twitter)</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://bsky.app/profile/cuelang.org" target="_blank">
                                    <span class="nav__text">Bluesky</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://www.youtube.com/@cuelang/videos" target="_blank">
                                    <span class="nav__text">YouTube</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
        </nav>
    </div>

    <div class="footer__legal">
        <nav class="footer__container" aria-label="Legal">
            <div class="nav nav--legal">
                <ul class="nav__list">
                    <li class="nav__item">
                        <span class="nav__text">&copy; 2025 CUE</span>
                    </li>

                    
                        <li class="nav__item"><a class="nav__link"
                               href="/privacy-policy/">
                                <span class="nav__text">Privacy policy</span>
                            </a>
                        </li>
                    

                    <li class="nav__item">
                        <a class="nav__link" href="https://github.com/cue-lang/cue/issues/new?labels=Triage,NeedsInvestigation,cuelang.org&amp;title=cuelang.org:%20&amp;template=bug_report.md&amp;body=%23%23%23&#43;What&#43;page&#43;were&#43;you&#43;looking&#43;at%3F%0A%0A%2Fdocs%2Fdraft%2Fcbe-004_mythic_beasts_dns%2F%0A%0A%23%23%23&#43;What&#43;version&#43;of&#43;the&#43;site&#43;were&#43;you&#43;looking&#43;at%3F%0A%0Ahttps%3A%2F%2Fgithub.com%2Fcue-lang%2Fcuelang.org%2Fcommit%2F64789fe0b723abceb454dfea8fdc748298d590e3%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;do%3F%0A%0A%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;expect%3F%0A%0A%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;see&#43;instead%3F%0A%0A" target="_blank">
                            <span class="nav__text">Report an Issue</span>
                        </a>
                    </li>
                </ul>
            </div>

            <a href="/" class="footer__branding" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>
        </nav>
    </div>
</div>

            </footer>
        </div>

        
                <div class="notification-bar is-hidden" data-notification-bar="cue-minor-release-v0.13">
        <div class="notification-bar__container">
            <div class="notification-bar__content">
                <strong>CUE v0.13 is now available</strong> &ndash; learn more about its <a href="https://github.com/cue-lang/cue/releases/tag/v0.13.0">new features and improvements</a>
            </div>
            <a class="button button--outline notification-bar__cta" href="/docs/introduction/installation/">
                    <span class="button__text">Install CUE</span>
                    



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--download"></use>
</svg>

                </a>
            <button type="button" class="button button--icon button--small notification-bar__close">
                



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--close"></use>
</svg>

                <span class="button__text">Close</span>
            </button>
        </div>
    </div>

        
        

<div id="mobile-menu" class="drawer drawer--mobile" data-drawer="menu">
    <div class="drawer__backdrop" data-drawer-close="menu"></div>
    <div class="drawer__container" tabindex="0">
        <div class="drawer__header">
            <a href="/" class="drawer__branding" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>

            <div class="drawer__close">
                <button type="button" class="button button--white button--icon" data-drawer-close="menu">
                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--close"></use>
</svg>

                    <span class="button__text">Hide menu</span>
                </button>
            </div>
        </div>

        <div class="drawer__content">
            <div class="drawer__menu">
                <nav class="nav nav--mobile" aria-label="Mobile menu">
                    <ul class="nav__list">
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/docs/">
                                    <span class="nav__text">Documentation</span>
                                </a>
                            </li>
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/play/">
                                    <span class="nav__text">Play</span>
                                </a>
                            </li>
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/community/">
                                    <span class="nav__text">Community</span>
                                </a>
                            </li>
                        

                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/docs/introduction/installation/">
                                    <span class="nav__text">Install</span>
                                </a>
                            </li>
                        

                        <li class="nav__item nav__item--search">





<div data-search-autocomplete="drawer"
     data-searchbar-size="small"
     data-searchbar-placeholder=""
>
    <div id="autocomplete-drawer"></div>
</div>
</li>
                    </ul>
                </nav>
            </div>
        </div>

        <div class="drawer__footer">
            <nav class="nav nav--social" aria-label="Social">
                <ul class="nav__list">
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://github.com/cue-lang/cue"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--github"></use>
</svg>

                                <span class="nav__text">GitHub</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="/s/slack">
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--slack"></use>
</svg>

                                <span class="nav__text">Slack</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="/s/discord">
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-discord"></use>
</svg>

                                <span class="nav__text">Discord</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://twitter.com/cue_lang"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                                <span class="nav__text">X (Twitter)</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://bsky.app/profile/cuelang.org"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-bluesky"></use>
</svg>

                                <span class="nav__text">Bluesky</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://www.youtube.com/@cuelang/videos"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-youtube"></use>
</svg>

                                <span class="nav__text">YouTube</span>
                            </a>
                        </li>
                    
                </ul>
            </nav>
        </div>
    </div>
</div>

        

    
    <script src="/js/main.min.f4174e980af6f5e0cedc0ce09a77d6f3a18405dee07c4cdd87543814539fabb3.js" integrity="sha256-9BdOmAr29eDO3AzgmnfW86GEBd7gfEzdh1Q4FFOfq7M=" async></script>






    </body>
</html>
