<!doctype html>
<html lang="en" dir="ltr" class="no-js">
    <head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Source: https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines Driving Buildkite Pipelines with CUE by Jonathan MatthewsThis …">
<meta name="generator" content="Hugo 0.147.5">

<meta name="robots" content="noindex, nofollow">

<link rel="canonical" href="https://cuelang.org/docs/draft/cbe-006_buildkite_importing_pipelines/" />
<link rel="shortcut icon" href="/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/webmanifest.json">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#232a68">
<meta name="msapplication-TileColor" content="#232a68">
<meta name="msapplication-config" content="/favicons/browserconfig.xml">
<meta name="theme-color" content="#232a68">

<title>CUE By Example - Driving Buildkite Pipelines with CUE | CUE</title><meta property="og:url" content="/docs/draft/cbe-006_buildkite_importing_pipelines/">
  <meta property="og:site_name" content="CUE">
  <meta property="og:title" content="CUE By Example - Driving Buildkite Pipelines with CUE">
  <meta property="og:description" content="Source: https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines Driving Buildkite Pipelines with CUE by Jonathan Matthews
This guide explains how to convert static Buildkite pipeline files from YAML to CUE, check those pipelines are valid, and then use CUE’s tooling layer to regenerate YAML.
This allows you to switch to CUE as a source of truth for Buildkite pipelines and perform client-side validation, without Buildkite needing to know you’re managing your static pipelines with CUE.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:modified_time" content="2025-03-27T16:38:46+00:00">
    <meta property="og:image" content="/img/social.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="/img/social.png">
  <meta name="twitter:title" content="CUE By Example - Driving Buildkite Pipelines with CUE">
  <meta name="twitter:description" content="Source: https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines Driving Buildkite Pipelines with CUE by Jonathan Matthews
This guide explains how to convert static Buildkite pipeline files from YAML to CUE, check those pipelines are valid, and then use CUE’s tooling layer to regenerate YAML.
This allows you to switch to CUE as a source of truth for Buildkite pipelines and perform client-side validation, without Buildkite needing to know you’re managing your static pipelines with CUE.">





<link rel="preload" href="/scss/main.min.8351627014ac2bf7396348f13a7d9959c01f0c9eee800e29af55ada087dad866.css" as="style">
<link href="/scss/main.min.8351627014ac2bf7396348f13a7d9959c01f0c9eee800e29af55ada087dad866.css" rel="stylesheet" integrity="">



<link rel="preload" href="/fonts/inter/regular.woff2" as="font" crossorigin="anonymous">
<link rel="preload" href="/fonts/inter/500.woff2" as="font" crossorigin="anonymous">
<link rel="preload" href="/fonts/inter/700.woff2" as="font" crossorigin="anonymous">



<script>(()=>{document.documentElement.classList.remove("no-js"),document.documentElement.classList.add("js")})()</script>
</head>
    <body itemscope itemtype="https://schema.org/WebPage">
        <meta itemprop="name" content="CUE By Example - Driving Buildkite Pipelines with CUE">
<meta itemprop="description" content=" Source: https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines Driving Buildkite Pipelines with CUE by Jonathan Matthews
This guide explains how to convert static Buildkite pipeline files from YAML to CUE, check those pipelines are valid, and then use CUE&rsquo;s tooling layer to regenerate YAML.
This allows you to switch to CUE as a source of truth for Buildkite pipelines and perform client-side validation, without Buildkite needing to know you&rsquo;re managing your static pipelines with CUE.
">

    
        <meta itemprop="dateModified" content="2025-03-27T16:38:46+00:00" >
    
            
        <meta itemprop="image" content="/img/social.png"/>
            
    <meta itemprop="keywords" content="" />

        <a id="skip-nav" class="skip-link" href="#site-main" target="_self">Skip to content</a>

        <div class="site">
            <header id="site-header" class="site__header">
                

<div class="header header--wide" data-header>
    <div class="header__container">
        <div class="header__background"></div>

        <div class="header__branding">
            <a href="/" class="header__logo" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>
        </div>

        <div class="header__main">
            <nav class="nav nav--main" aria-label="Main menu">
                <ul class="nav__list">
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/docs/"><span class="nav__text">Documentation</span></a>
                        </li>
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/play/"><span class="nav__text">Play</span></a>
                        </li>
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/community/"><span class="nav__text">Community</span></a>
                        </li>
                    
                </ul>
            </nav>
        </div>

        <div class="header__secondary">
            <div class="header__icons">
                <nav class="nav nav--social" aria-label="Social">
                    <ul class="nav__list"><li class="nav__item"><a class="nav__link"
                                   href="https://github.com/cue-lang/cue" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--github"></use>
</svg>

                                    <span class="nav__text">GitHub</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="/s/slack">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--slack"></use>
</svg>

                                    <span class="nav__text">Slack</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="/s/discord">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-discord"></use>
</svg>

                                    <span class="nav__text">Discord</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://twitter.com/cue_lang" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                                    <span class="nav__text">X (Twitter)</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://bsky.app/profile/cuelang.org" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-bluesky"></use>
</svg>

                                    <span class="nav__text">Bluesky</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://www.youtube.com/@cuelang/videos" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-youtube"></use>
</svg>

                                    <span class="nav__text">YouTube</span>
                                </a>
                            </li></ul>
                </nav>
            </div>

            <div class="header__cta"><a class="button button--skinny"
                       href="/docs/introduction/installation/"><span class="button__text">Install</span>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--download"></use>
</svg>
</a></div>

            <div class="header__search" data-menu>
                <a href="/search" class="button button--icon button--white-simple" rel="search" data-menu-dropdown="header-dropdown-search">



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--search"></use>
</svg>
<span>Search</span>
                </a>

                <div class="header__dropdown header__dropdown--search" data-menu-dropdown-target="header-dropdown-search">
                    <p class="header__search-title">What are you looking for?</p>





<div data-search-autocomplete="menu"
     data-searchbar-size="small"
     data-searchbar-placeholder=""
>
    <div id="autocomplete-menu"></div>
</div>
</div>
            </div>

            <div class="header__toggle">
                <button class="button button--outline" data-drawer-toggle="menu" aria-haspopup="menu" aria-expanded="false" aria-controls="mobile-menu">
                    <span class="button__text">Menu</span>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--menu"></use>
</svg>
</button>
            </div>
        </div>
    </div>
</div>

            </header>

            <main id="site-main" class="site__content" itemprop="mainContentOfPage">
                

    <div class="docs" data-docs>
        <div class="docs__main">
            <nav class="breadcrumb" aria-label="breadcrumb">
    <ol class="breadcrumb__list">
    

    
    

    
        <li class="breadcrumb__item"><a class="breadcrumb__link" href="/docs/draft/">Drafts</a></li>
    
    

    
        <li class="breadcrumb__item" aria-current="page"><h1 class="breadcrumb__text">CUE By Example - Driving Buildkite Pipelines with CUE</h1></li>
    
    </ol>
</nav>


            <article class="article article--docs" itemscope itemtype="https://schema.org/TechArticle">
                <meta itemprop="articleBody" content="




    

Source: https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines



    




    

Driving Buildkite Pipelines with CUE
by Jonathan Matthews
This guide explains how to convert static Buildkite pipeline files from YAML to
CUE, check those pipelines are valid, and then use CUE&rsquo;s tooling layer to
regenerate YAML.
This allows you to switch to CUE as a source of truth for Buildkite pipelines
and perform client-side validation, without Buildkite needing to know you&rsquo;re
managing your static pipelines with CUE.

  
      
          :exclamation: WARNING :exclamation:
      
  
  
      
          This guide requires that you use cue version v0.11.0-alpha.2 or later. The process described below won&rsquo;t work with earlier versions. Check the version of your cue command by running cue version, and upgrade it if needed.
      
  


    




    

Prerequisites

You have
CUE installed
locally. This allows you to run cue commands.
You have a set of static Buildkite pipeline files. The examples shown in this
guide use a specific commit from the Buildkite
dependent-pipeline-example
repository, but you don&rsquo;t need to use that repository in any way.
You have git installed.



    




    

Steps

    




    

Convert YAML pipelines to CUE

    




    

:arrow_right: Begin with a clean git state
Change directory into the root of the repository that contains your static
Buildkite pipeline files, and ensure you start this process with a clean git
state, with no modified files. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cd dependent-pipeline-example # our example repository
$ git status # should report &#34;working tree clean&#34;
On branch master
nothing to commit, working tree clean


    




    

:arrow_right: Initialise a CUE module
Initialise a CUE module named after the organisation and repository you&rsquo;re
working with. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue mod init github.com/buildkite/dependent-pipeline-example


    




    

:arrow_right: Import YAML pipelines
Use cue to import your YAML pipeline files:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue import ./.buildkite/*.yml --with-context -p buildkite -f -l pipelines: -l &#39;strings.TrimSuffix(path.Base(filename),path.Ext(filename))&#39;

Check that a CUE file has been created for each YAML pipeline in the
.buildkite directory. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # Actual command in CUE-By-Example guide:
# ls .buildkite/
$ ls .buildkite/ &gt;../4.actual.txt

Your output should look similar to this, with matching pairs of pre-existing
YAML and new CUE files:







            




    


                            Copied!
                        
                    4.expected.txt
            
        


                Copy code
                
                    Copied!
                
            pipeline.cue
pipeline.deploy.cue
pipeline.deploy.yml
pipeline.yml






Observe that each pipeline has been imported into the pipelines struct, at a
location derived from its original pipeline&rsquo;s file name:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # Actual command in CUE-By-Example guide:
# head .buildkite/*.cue
$ head .buildkite/*.cue &gt;../5.actual.txt

The output should reflect your pipelines. In our example:







            




    


                            Copied!
                        
                    5.expected.txt
            
        


                Copy code
                
                    Copied!
                
            ==&gt; .buildkite/pipeline.cue &lt;==
package buildkite

pipelines: pipeline: steps: [{
	command: &#34;echo &#39;Tests&#39;&#34;
	label:   &#34;:hammer:&#34;
},
	&#34;wait&#34;, {
		trigger:  &#34;dependent-pipeline-example-deploy&#34;
		label:    &#34;:rocket:&#34;
		branches: &#34;master&#34;

==&gt; .buildkite/pipeline.deploy.cue &lt;==
package buildkite

pipelines: &#34;pipeline.deploy&#34;: steps: [{
	command:           &#34;echo &#39;Deploy&#39;&#34;
	label:             &#34;:rocket:&#34;
	concurrency_group: &#34;$BUILDKITE_PIPELINE_SLUG-deploy&#34;
	concurrency:       1
	branches:          &#34;master&#34;
}]







    




    

:arrow_right: Store CUE pipelines in a dedicated directory
Create a directory called buildkite to hold your CUE-based Buildkite pipeline
files. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ mkdir -p internal/ci/buildkite

You may change the hierarchy and naming of buildkite&rsquo;s parent directories
to suit your repository layout. If you do so, you will need to adapt some
commands and CUE code as you follow this guide.
Move the newly-created CUE files into their dedicated directory. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ mv ./.buildkite/*.cue internal/ci/buildkite


    




    

Validate workflows


    




    

:arrow_right: Create a pipeline schema
Create a very basic CUE schema for Buildkite pipelines, adapted from
Buildkite&rsquo;s documentation,
and place it in the internal/ci/buildkite directory:
:floppy_disk: internal/ci/buildkite/pipelineSchema.cue







            




    


                            Copied!
                        
                    dependent-pipeline-example/internal/ci/buildkite/pipelineSchema.cue
            
        


                Copy code
                
                    Copied!
                
            package buildkite

#Pipeline: {
	steps!: [...]
	env?: [string]: string
	agents?: {[string]: string} | [..._#kv]
	_#kv: =~&#34;.&#43;=&#34;
	notify?: [...]
}







  
      
          :grey_exclamation: Info :grey_exclamation:
      
  
  
      
          It would be great if we could use Buildkite&rsquo;s authoritative pipeline schema here. Unfortunately, CUE&rsquo;s JSONSchema support can&rsquo;t currently import it. This is being tracked in issue #2699, and this guide will be updated when the upstream schema can be used.
      
  


    




    

:arrow_right: Apply the schema
We need to tell CUE to apply the schema to each pipeline.
To do this we&rsquo;ll create a file at internal/ci/buildkite/pipelines.cue in our
example.
However, if the pipeline imports that you performed earlier already created
a file with that same path and name, then simply select a different CUE
filename that doesn&rsquo;t already exist. Place the file in the
internal/ci/buildkite/ directory.
:floppy_disk: internal/ci/buildkite/pipelines.cue







            




    


                            Copied!
                        
                    dependent-pipeline-example/internal/ci/buildkite/pipelines.cue
            
        


                Copy code
                
                    Copied!
                
            package buildkite

// each member of the pipelines struct must be a valid #Pipeline
pipelines: [_]: #Pipeline







    




    

Generate YAML from CUE
We need to replace the static YAML pipeline files that we originally imported
with YAML generated from the CUE files we&rsquo;ve created. No material changes will
be made to the YAML files, but comments will be removed (as they now live
in the CUE sources, where users will see them), some unimportant YAML
formatting may change, and a comment will be added at the top of each generated
YAML file pointing users towards the new source of truth: CUE.

    




    

:arrow_right: Create a CUE workflow command
Create a CUE file at internal/ci/buildkite/ci_tool.cue containing the following workflow command.
Adapt the element commented with TODO:
:floppy_disk: internal/ci/buildkite/ci_tool.cue







            




    


                            Copied!
                        
                    dependent-pipeline-example/internal/ci/buildkite/ci_tool.cue
            
        


                Copy code
                
                    Copied!
                
            package buildkite

import (
	&#34;path&#34;
	&#34;encoding/yaml&#34;
	&#34;tool/file&#34;
)

_goos: string @tag(os,var=os)

// Regenerate all pipeline files
command: regenerate: {
	pipeline_files: {
		// TODO: update _toolFile to reflect the directory hierarchy containing this file.
		let _toolFile = &#34;internal/ci/buildkite/ci_tool.cue&#34;
		let _pipelineDir = path.FromSlash(&#34;.buildkite&#34;, path.Unix)
		let _donotedit = &#34;Code generated by \(_toolFile); DO NOT EDIT.&#34;

		clean: {
			glob: file.Glob &amp; {
				glob: path.Join([_pipelineDir, &#34;*.yml&#34;], _goos)
				files: [...string]
			}
			for _, _filename in glob.files {
				&#34;Delete \(_filename)&#34;: file.RemoveAll &amp; {path: _filename}
			}
		}

		create: {
			for _pipelineName, _pipeline in pipelines
			let _filename = _pipelineName &#43; &#34;.yml&#34; {
				&#34;Generate \(_filename)&#34;: file.Create &amp; {
					$after: [for v in clean {v}]
					filename: path.Join([_pipelineDir, _filename], _goos)
					contents: &#34;# \(_donotedit)\n\n\(yaml.Marshal(_pipeline))&#34;
				}
			}
		}
	}
}






Make the modification indicated by the TODO comment.
This workflow command will export each CUE-based pipeline back into its required YAML file,
on demand.

    




    

:arrow_right: Test the CUE workflow command
With the modified ci_tool.cue file in place, check that the regenerate
workflow command is available from a shell sitting at the repo root. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cd $(git rev-parse --show-toplevel) # make sure we&#39;re sitting at the repository root

# Actual command in CUE-By-Example guide:
# cue help cmd regenerate ./internal/ci/buildkite   # the &#34;./&#34; prefix is required
$ cue help cmd regenerate ./internal/ci/buildkite | head -4 &gt;../11.actual.txt

Your output must begin with the following:







            




    


                            Copied!
                        
                    11.expected.txt
            
        


                Copy code
                
                    Copied!
                
            Regenerate all pipeline files

Usage:
  cue cmd regenerate [flags]







  
      
          :exclamation: WARNING :exclamation:
      
  
  
      
          If you don&rsquo;t see the usage explanation for the regenerate workflow command (or if you receive an error message) then either your workflow command isn&rsquo;t set up as CUE requires, or you&rsquo;re running a CUE version older than v0.11.0-alpha.2. If you&rsquo;ve upgraded to at least that version but the usage explanation still isn&rsquo;t being displayed then: (1) double check the contents of the ci_tool.cue file and the modifications you made to it; (2) make sure its location in the repository is precisely as given in this guide; (3) ensure the filename is exactly ci_tool.cue; (4) run cue vet ./internal/ci/buildkite and check that your pipelines actually validate successfully - in other words: were they truly valid before you even started this process? Lastly, make sure you&rsquo;ve followed all the steps in this guide, and that you invoked the cue help command from the repository&rsquo;s root directory. If you get really stuck, please come and join the CUE community and ask for some help!
      
  


    




    

:arrow_right: Regenerate the YAML pipeline files
Run the regenerate workflow command to produce YAML pipeline files from CUE. For
example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue cmd regenerate ./internal/ci/buildkite # the &#34;./&#34; prefix is required


    




    

:arrow_right: Audit changes to the YAML pipeline files
Check that each YAML pipeline file has a single material change from the
original:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # Actual command in CUE-By-Example guide:
# git diff .buildkite/
$ git diff -- .buildkite/ | grep -vE &#39;^index [0-9a-f]{7}\.\.[0-9a-f]{7}&#39; | head -8 &gt;../13.actual.txt

Your output should look similar to the following example:







            




    


                            Copied!
                        
                    13.expected.txt
            
        


                Copy code
                
                    Copied!
                
            diff --git a/.buildkite/pipeline.deploy.yml b/.buildkite/pipeline.deploy.yml
--- a/.buildkite/pipeline.deploy.yml
&#43;&#43;&#43; b/.buildkite/pipeline.deploy.yml
@@ -1,6 &#43;1,8 @@
&#43;# Code generated by internal/ci/buildkite/ci_tool.cue; DO NOT EDIT.
&#43;
 steps:
   - command: echo &#39;Deploy&#39;







            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ diff ../13.expected.txt ../13.actual.txt

The only material change in each YAML file is the addition of a header that
warns the reader not to edit the file directly.

    




    

:arrow_right: Add and commit files to git
Add your files to git. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ git add .buildkite/ internal/ci/buildkite/ cue.mod/module.cue

Make sure to include your slightly modified YAML pipeline files in
.buildkite/ along with all the new files in internal/ci/buildkite/ and
your cue.mod/module.cue file.
Commit your files to git, with an appropriate commit message:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # Actual command in CUE-By-Example guide:
# git commit -m &#34;ci: create CUE sources for Buildkite pipelines&#34;
$ git commit --quiet -m &#34;ci: create CUE sources for Buildkite pipelines&#34;


    




    

Conclusion
Well done - your static Buildkite pipeline files have been imported into
CUE!
They can now be managed using CUE, leading to safer and more predictable
changes. The use of a schema to check your pipelines means that you
will catch and fix many types of mistake earlier than before, without waiting
for the slow &ldquo;git add/commit/push; check if CI fails&rdquo; cycle.
From now on, each time you make a change to a CUE pipeline file, immediately
regenerate the YAML files required by Buildkite, and commit your changes
to all the CUE and YAML files. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue cmd regenerate ./internal/ci/buildkite/ # the &#34;./&#34; prefix is required
$ git add .buildkite/ internal/ci/buildkite/
$ git commit -m &#34;ci: added new release pipeline&#34; # example message

">
<meta itemprop="wordCount" content="1638">


                <div class="article__container">
                    



<header class="article__header">
        </header>



                    <div class="article__content">
                        
                            <div class="note note--caution" role="alert">



<svg class="icon note__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--exclamation"></use>
</svg>
<div class="note__content">Source: <a href="https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines">https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines</a></div>
</div>

<h1 id="driving-buildkite-pipelines-with-cue">
    <a href="#driving-buildkite-pipelines-with-cue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Driving Buildkite Pipelines with CUE</h1>
<p><sup>by <a href="https://jonathanmatthews.com">Jonathan Matthews</a></sup></p>
<p>This guide explains how to convert static Buildkite pipeline files from YAML to
CUE, check those pipelines are valid, and then use CUE&rsquo;s tooling layer to
regenerate YAML.</p>
<p>This allows you to switch to CUE as a source of truth for Buildkite pipelines
and perform client-side validation, without Buildkite needing to know you&rsquo;re
managing your static pipelines with CUE.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">:exclamation: WARNING :exclamation:</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">This guide requires that you use <code>cue</code> version <code>v0.11.0-alpha.2</code> or later. <strong>The process described below won&rsquo;t work with earlier versions</strong>. Check the version of your <code>cue</code> command by running <code>cue version</code>, and <a href="https://cuelang.org/dl">upgrade it</a> if needed.</td>
      </tr>
  </tbody>
</table>
<h2 id="prerequisites">
    <a href="#prerequisites" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Prerequisites</h2>
<ul>
<li>You have
<a href="https://alpha.cuelang.org/docs/introduction/installation/">CUE installed</a>
locally. This allows you to run <code>cue</code> commands.</li>
<li>You have a set of static Buildkite pipeline files. The examples shown in this
guide use a specific commit from the Buildkite
<a href="https://github.com/buildkite/dependent-pipeline-example/tree/a7419a24bee24068d4d79399bccd9093569c3013/.buildkite">dependent-pipeline-example</a>
repository, <em>but you don&rsquo;t need to use that repository in any way.</em></li>
<li>You have <a href="https://git-scm.com/downloads"><code>git</code> installed</a>.</li>
</ul>
<!-- TODO: curl isn't needed until the doc includes fetching the upstream schema
- You have [`curl` installed](https://curl.se/dlwiz/), or can fetch a file from
  a website some other way.
-->
<h2 id="steps">
    <a href="#steps" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Steps</h2>
<h3 id="convert-yaml-pipelines-to-cue">
    <a href="#convert-yaml-pipelines-to-cue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Convert YAML pipelines to CUE</h3>
<h4 id="arrow_right-begin-with-a-clean-git-state">
    <a href="#arrow_right-begin-with-a-clean-git-state" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Begin with a clean git state</h4>
<p>Change directory into the root of the repository that contains your static
Buildkite pipeline files, and ensure you start this process with a clean git
state, with no modified files. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y2QgZGVwZW5kZW50LXBpcGVsaW5lLWV4YW1wbGUgIyBvdXIgZXhhbXBsZSByZXBvc2l0b3J5CmdpdCBzdGF0dXMgIyBzaG91bGQgcmVwb3J0ICJ3b3JraW5nIHRyZWUgY2xlYW4i">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cd dependent-pipeline-example # our example repository
</span></span><span style="display:flex;"><span>$ git status # should report &#34;working tree clean&#34;
</span></span><span style="display:flex;"><span>On branch master
</span></span><span style="display:flex;"><span>nothing to commit, working tree clean</span></span></code></pre></div></div>
</div>
<h4 id="arrow_right-initialise-a-cue-module">
    <a href="#arrow_right-initialise-a-cue-module" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Initialise a CUE module</h4>
<p>Initialise a CUE module named after the organisation and repository you&rsquo;re
working with. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIG1vZCBpbml0IGdpdGh1Yi5jb20vYnVpbGRraXRlL2RlcGVuZGVudC1waXBlbGluZS1leGFtcGxl">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue mod init github.com/buildkite/dependent-pipeline-example</span></span></code></pre></div></div>
</div>
<h4 id="arrow_right-import-yaml-pipelines">
    <a href="#arrow_right-import-yaml-pipelines" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Import YAML pipelines</h4>
<p>Use <code>cue</code> to import your YAML pipeline files:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGltcG9ydCAuLy5idWlsZGtpdGUvKi55bWwgLS13aXRoLWNvbnRleHQgLXAgYnVpbGRraXRlIC1mIC1sIHBpcGVsaW5lczogLWwgJ3N0cmluZ3MuVHJpbVN1ZmZpeChwYXRoLkJhc2UoZmlsZW5hbWUpLHBhdGguRXh0KGZpbGVuYW1lKSkn">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue import ./.buildkite/*.yml --with-context -p buildkite -f -l pipelines: -l &#39;strings.TrimSuffix(path.Base(filename),path.Ext(filename))&#39;</span></span></code></pre></div></div>
</div>
<p>Check that a CUE file has been created for each YAML pipeline in the
<code>.buildkite</code> directory. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="bHMgLmJ1aWxka2l0ZS8gPi4uLzQuYWN0dWFsLnR4dA==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># ls .buildkite/
</span></span><span style="display:flex;"><span>$ ls .buildkite/ &gt;../4.actual.txt</span></span></code></pre></div></div>
</div>
<p>Your output should look similar to this, with matching pairs of pre-existing
YAML and new CUE files:</p>
<p><div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="4.expected.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="4.expected.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>4.expected.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="4.expected.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGlwZWxpbmUuY3VlCnBpcGVsaW5lLmRlcGxveS5jdWUKcGlwZWxpbmUuZGVwbG95LnltbApwaXBlbGluZS55bWw=">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>pipeline.cue
</span></span><span style="display:flex;"><span>pipeline.deploy.cue
</span></span><span style="display:flex;"><span>pipeline.deploy.yml
</span></span><span style="display:flex;"><span>pipeline.yml</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

Observe that each pipeline has been imported into the <code>pipelines</code> struct, at a
location derived from its original pipeline&rsquo;s file name:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="aGVhZCAuYnVpbGRraXRlLyouY3VlID4uLi81LmFjdHVhbC50eHQ=">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># head .buildkite/*.cue
</span></span><span style="display:flex;"><span>$ head .buildkite/*.cue &gt;../5.actual.txt</span></span></code></pre></div></div>
</div>
<p>The output should reflect your pipelines. In our example:</p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="5.expected.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="5.expected.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>5.expected.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="5.expected.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="PT0&#43;IC5idWlsZGtpdGUvcGlwZWxpbmUuY3VlIDw9PQpwYWNrYWdlIGJ1aWxka2l0ZQoKcGlwZWxpbmVzOiBwaXBlbGluZTogc3RlcHM6IFt7Cgljb21tYW5kOiAiZWNobyAnVGVzdHMnIgoJbGFiZWw6ICAgIjpoYW1tZXI6Igp9LAoJIndhaXQiLCB7CgkJdHJpZ2dlcjogICJkZXBlbmRlbnQtcGlwZWxpbmUtZXhhbXBsZS1kZXBsb3kiCgkJbGFiZWw6ICAgICI6cm9ja2V0OiIKCQlicmFuY2hlczogIm1hc3RlciIKCj09PiAuYnVpbGRraXRlL3BpcGVsaW5lLmRlcGxveS5jdWUgPD09CnBhY2thZ2UgYnVpbGRraXRlCgpwaXBlbGluZXM6ICJwaXBlbGluZS5kZXBsb3kiOiBzdGVwczogW3sKCWNvbW1hbmQ6ICAgICAgICAgICAiZWNobyAnRGVwbG95JyIKCWxhYmVsOiAgICAgICAgICAgICAiOnJvY2tldDoiCgljb25jdXJyZW5jeV9ncm91cDogIiRCVUlMREtJVEVfUElQRUxJTkVfU0xVRy1kZXBsb3kiCgljb25jdXJyZW5jeTogICAgICAgMQoJYnJhbmNoZXM6ICAgICAgICAgICJtYXN0ZXIiCn1d">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>==&gt; .buildkite/pipeline.cue &lt;==
</span></span><span style="display:flex;"><span>package buildkite
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pipelines: pipeline: steps: [{
</span></span><span style="display:flex;"><span>	command: &#34;echo &#39;Tests&#39;&#34;
</span></span><span style="display:flex;"><span>	label:   &#34;:hammer:&#34;
</span></span><span style="display:flex;"><span>},
</span></span><span style="display:flex;"><span>	&#34;wait&#34;, {
</span></span><span style="display:flex;"><span>		trigger:  &#34;dependent-pipeline-example-deploy&#34;
</span></span><span style="display:flex;"><span>		label:    &#34;:rocket:&#34;
</span></span><span style="display:flex;"><span>		branches: &#34;master&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>==&gt; .buildkite/pipeline.deploy.cue &lt;==
</span></span><span style="display:flex;"><span>package buildkite
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pipelines: &#34;pipeline.deploy&#34;: steps: [{
</span></span><span style="display:flex;"><span>	command:           &#34;echo &#39;Deploy&#39;&#34;
</span></span><span style="display:flex;"><span>	label:             &#34;:rocket:&#34;
</span></span><span style="display:flex;"><span>	concurrency_group: &#34;$BUILDKITE_PIPELINE_SLUG-deploy&#34;
</span></span><span style="display:flex;"><span>	concurrency:       1
</span></span><span style="display:flex;"><span>	branches:          &#34;master&#34;
</span></span><span style="display:flex;"><span>}]</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<h4 id="arrow_right-store-cue-pipelines-in-a-dedicated-directory">
    <a href="#arrow_right-store-cue-pipelines-in-a-dedicated-directory" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Store CUE pipelines in a dedicated directory</h4>
<p>Create a directory called <code>buildkite</code> to hold your CUE-based Buildkite pipeline
files. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="bWtkaXIgLXAgaW50ZXJuYWwvY2kvYnVpbGRraXRl">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ mkdir -p internal/ci/buildkite</span></span></code></pre></div></div>
</div>
<p>You may change the hierarchy and naming of <code>buildkite</code>&rsquo;s <strong>parent</strong> directories
to suit your repository layout. If you do so, you will need to adapt some
commands and CUE code as you follow this guide.</p>
<p>Move the newly-created CUE files into their dedicated directory. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="bXYgLi8uYnVpbGRraXRlLyouY3VlIGludGVybmFsL2NpL2J1aWxka2l0ZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ mv ./.buildkite/*.cue internal/ci/buildkite</span></span></code></pre></div></div>
</div>
<h3 id="validate-workflows">
    <a href="#validate-workflows" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Validate workflows</h3>
<!-- TODO: upstream JSONSchema isn't usable
cf. https://github.com/cue-lang/cue/issues/2699

#### :arrow_right: Fetch a pipeline schema

Fetch a schema for Buildkite pipelines, as defined by Buildkite themselves, and
place it in the `internal/ci/buildkite` directory:

:computer: `terminal`
```sh
curl -o internal/ci/buildkite/buildkite.pipeline.schema.json \
  https://raw.githubusercontent.com/buildkite/pipeline-schema/6396f68d5e983e0d2acbf829c565027a4cfd69bc/schema.json
```

We use a specific commit from the upstream repository to make sure that this
process is reproducible.

#### :arrow_right: Import the schema

Import the schema into CUE:

:computer: `terminal`
```sh
cue import -f -l '#Pipeline:' internal/ci/buildkite/buildkite.pipeline.schema.json
```
-->
<h4 id="arrow_right-create-a-pipeline-schema">
    <a href="#arrow_right-create-a-pipeline-schema" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create a pipeline schema</h4>
<p>Create a very basic CUE schema for Buildkite pipelines, adapted from
<a href="https://buildkite.com/docs/pipelines/configuration-overview">Buildkite&rsquo;s documentation</a>,
and place it in the <code>internal/ci/buildkite</code> directory:</p>
<p>:floppy_disk: <code>internal/ci/buildkite/pipelineSchema.cue</code></p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="dependent-pipeline-example/internal/ci/buildkite/pipelineschema.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="dependent-pipeline-example/internal/ci/buildkite/pipelineSchema.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>dependent-pipeline-example/internal/ci/buildkite/pipelineSchema.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="dependent-pipeline-example/internal/ci/buildkite/pipelineschema.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBidWlsZGtpdGUKCiNQaXBlbGluZTogewoJc3RlcHMhOiBbLi4uXQoJZW52PzogW3N0cmluZ106IHN0cmluZwoJYWdlbnRzPzoge1tzdHJpbmddOiBzdHJpbmd9IHwgWy4uLl8ja3ZdCglfI2t2OiA9fiIuKz0iCglub3RpZnk/OiBbLi4uXQp9">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> buildkite
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Pipeline<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	steps<span style="font-weight:bold">!:</span> <span style="font-weight:bold">[...]</span>
</span></span><span style="display:flex;"><span>	env<span style="font-weight:bold">?:</span> <span style="font-weight:bold">[</span><span style="color:#458;font-weight:bold">string</span><span style="font-weight:bold">]:</span> <span style="color:#458;font-weight:bold">string</span>
</span></span><span style="display:flex;"><span>	agents<span style="font-weight:bold">?:</span> {<span style="font-weight:bold">[</span><span style="color:#458;font-weight:bold">string</span><span style="font-weight:bold">]:</span> <span style="color:#458;font-weight:bold">string</span>} <span style="font-weight:bold">|</span> <span style="font-weight:bold">[...</span><span style="font-weight:bold">_</span>#kv<span style="font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>	<span style="font-weight:bold">_</span>#kv<span style="font-weight:bold">:</span> <span style="font-weight:bold">=</span>~<span style="color:#b84">&#34;.+=&#34;</span>
</span></span><span style="display:flex;"><span>	notify<span style="font-weight:bold">?:</span> <span style="font-weight:bold">[...]</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<table>
  <thead>
      <tr>
          <th style="text-align: left">:grey_exclamation: Info :grey_exclamation:</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">It would be great if we could use <a href="https://github.com/buildkite/pipeline-schema">Buildkite&rsquo;s authoritative pipeline schema</a> here. Unfortunately, CUE&rsquo;s JSONSchema support can&rsquo;t currently import it. This is being tracked in issue <a href="https://github.com/cue-lang/cue/issues/2699">#2699</a>, and this guide will be updated when the upstream schema can be used.</td>
      </tr>
  </tbody>
</table>
<h4 id="arrow_right-apply-the-schema">
    <a href="#arrow_right-apply-the-schema" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Apply the schema</h4>
<p>We need to tell CUE to apply the schema to each pipeline.</p>
<p>To do this we&rsquo;ll create a file at <code>internal/ci/buildkite/pipelines.cue</code> in our
example.</p>
<p>However, <strong>if the pipeline imports that you performed earlier <em>already</em> created
a file with that same path and name</strong>, then simply select a different CUE
filename that <em>doesn&rsquo;t</em> already exist. Place the file in the
<code>internal/ci/buildkite/</code> directory.</p>
<p>:floppy_disk: <code>internal/ci/buildkite/pipelines.cue</code></p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="dependent-pipeline-example/internal/ci/buildkite/pipelines.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="dependent-pipeline-example/internal/ci/buildkite/pipelines.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>dependent-pipeline-example/internal/ci/buildkite/pipelines.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="dependent-pipeline-example/internal/ci/buildkite/pipelines.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBidWlsZGtpdGUKCi8vIGVhY2ggbWVtYmVyIG9mIHRoZSBwaXBlbGluZXMgc3RydWN0IG11c3QgYmUgYSB2YWxpZCAjUGlwZWxpbmUKcGlwZWxpbmVzOiBbX106ICNQaXBlbGluZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> buildkite
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// each member of the pipelines struct must be a valid #Pipeline</span>
</span></span><span style="display:flex;"><span>pipelines<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span><span style="font-weight:bold">_</span><span style="font-weight:bold">]:</span> #Pipeline</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<h3 id="generate-yaml-from-cue">
    <a href="#generate-yaml-from-cue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Generate YAML from CUE</h3>
<p>We need to replace the static YAML pipeline files that we originally imported
with YAML generated from the CUE files we&rsquo;ve created. No material changes will
be made to the YAML files, but comments will be removed (as they now live
in the CUE sources, where users will see them), some unimportant YAML
formatting may change, and a comment will be added at the top of each generated
YAML file pointing users towards the new source of truth: CUE.</p>
<h4 id="arrow_right-create-a-cue-workflow-command">
    <a href="#arrow_right-create-a-cue-workflow-command" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create a CUE workflow command</h4>
<p>Create a CUE file at <code>internal/ci/buildkite/ci_tool.cue</code> containing the following workflow command.
Adapt the element commented with <code>TODO</code>:</p>
<p>:floppy_disk: <code>internal/ci/buildkite/ci_tool.cue</code>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="dependent-pipeline-example/internal/ci/buildkite/ci_tool.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="dependent-pipeline-example/internal/ci/buildkite/ci_tool.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>dependent-pipeline-example/internal/ci/buildkite/ci_tool.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="dependent-pipeline-example/internal/ci/buildkite/ci_tool.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBidWlsZGtpdGUKCmltcG9ydCAoCgkicGF0aCIKCSJlbmNvZGluZy95YW1sIgoJInRvb2wvZmlsZSIKKQoKX2dvb3M6IHN0cmluZyBAdGFnKG9zLHZhcj1vcykKCi8vIFJlZ2VuZXJhdGUgYWxsIHBpcGVsaW5lIGZpbGVzCmNvbW1hbmQ6IHJlZ2VuZXJhdGU6IHsKCXBpcGVsaW5lX2ZpbGVzOiB7CgkJLy8gVE9ETzogdXBkYXRlIF90b29sRmlsZSB0byByZWZsZWN0IHRoZSBkaXJlY3RvcnkgaGllcmFyY2h5IGNvbnRhaW5pbmcgdGhpcyBmaWxlLgoJCWxldCBfdG9vbEZpbGUgPSAiaW50ZXJuYWwvY2kvYnVpbGRraXRlL2NpX3Rvb2wuY3VlIgoJCWxldCBfcGlwZWxpbmVEaXIgPSBwYXRoLkZyb21TbGFzaCgiLmJ1aWxka2l0ZSIsIHBhdGguVW5peCkKCQlsZXQgX2Rvbm90ZWRpdCA9ICJDb2RlIGdlbmVyYXRlZCBieSBcKF90b29sRmlsZSk7IERPIE5PVCBFRElULiIKCgkJY2xlYW46IHsKCQkJZ2xvYjogZmlsZS5HbG9iICYgewoJCQkJZ2xvYjogcGF0aC5Kb2luKFtfcGlwZWxpbmVEaXIsICIqLnltbCJdLCBfZ29vcykKCQkJCWZpbGVzOiBbLi4uc3RyaW5nXQoJCQl9CgkJCWZvciBfLCBfZmlsZW5hbWUgaW4gZ2xvYi5maWxlcyB7CgkJCQkiRGVsZXRlIFwoX2ZpbGVuYW1lKSI6IGZpbGUuUmVtb3ZlQWxsICYge3BhdGg6IF9maWxlbmFtZX0KCQkJfQoJCX0KCgkJY3JlYXRlOiB7CgkJCWZvciBfcGlwZWxpbmVOYW1lLCBfcGlwZWxpbmUgaW4gcGlwZWxpbmVzCgkJCWxldCBfZmlsZW5hbWUgPSBfcGlwZWxpbmVOYW1lICsgIi55bWwiIHsKCQkJCSJHZW5lcmF0ZSBcKF9maWxlbmFtZSkiOiBmaWxlLkNyZWF0ZSAmIHsKCQkJCQkkYWZ0ZXI6IFtmb3IgdiBpbiBjbGVhbiB7dn1dCgkJCQkJZmlsZW5hbWU6IHBhdGguSm9pbihbX3BpcGVsaW5lRGlyLCBfZmlsZW5hbWVdLCBfZ29vcykKCQkJCQljb250ZW50czogIiMgXChfZG9ub3RlZGl0KVxuXG5cKHlhbWwuTWFyc2hhbChfcGlwZWxpbmUpKSIKCQkJCX0KCQkJfQoJCX0KCX0KfQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> buildkite
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;path&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;encoding/yaml&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;tool/file&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>_goos<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">string</span> @tag(os<span style="font-weight:bold">,</span>var<span style="font-weight:bold">=</span>os)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// Regenerate all pipeline files</span>
</span></span><span style="display:flex;"><span>command<span style="font-weight:bold">:</span> regenerate<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	pipeline_files<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">// TODO: update _toolFile to reflect the directory hierarchy containing this file.</span>
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">let</span> _toolFile <span style="font-weight:bold">=</span> <span style="color:#b84">&#34;internal/ci/buildkite/ci_tool.cue&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">let</span> _pipelineDir <span style="font-weight:bold">=</span> path.FromSlash(<span style="color:#b84">&#34;.buildkite&#34;</span><span style="font-weight:bold">,</span> path.Unix)
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">let</span> _donotedit <span style="font-weight:bold">=</span> <span style="color:#b84">&#34;Code generated by </span><span style="color:#b84">\(</span>_toolFile<span style="color:#b84">)</span><span style="color:#b84">; DO NOT EDIT.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		clean<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>			glob<span style="font-weight:bold">:</span> file.Glob <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>				glob<span style="font-weight:bold">:</span> path.Join(<span style="font-weight:bold">[</span>_pipelineDir<span style="font-weight:bold">,</span> <span style="color:#b84">&#34;*.yml&#34;</span><span style="font-weight:bold">],</span> _goos)
</span></span><span style="display:flex;"><span>				files<span style="font-weight:bold">:</span> <span style="font-weight:bold">[...</span><span style="color:#458;font-weight:bold">string</span><span style="font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">for</span> <span style="font-weight:bold">_</span><span style="font-weight:bold">,</span> _filename <span style="font-weight:bold">in</span> glob.files {
</span></span><span style="display:flex;"><span>				<span style="color:#b84">&#34;Delete </span><span style="color:#b84">\(</span>_filename<span style="color:#b84">)</span><span style="color:#b84">&#34;</span><span style="font-weight:bold">:</span> file.RemoveAll <span style="font-weight:bold">&amp;</span> {path<span style="font-weight:bold">:</span> _filename}
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		create<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">for</span> _pipelineName<span style="font-weight:bold">,</span> _pipeline <span style="font-weight:bold">in</span> pipelines
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">let</span> _filename <span style="font-weight:bold">=</span> _pipelineName <span style="font-weight:bold">+</span> <span style="color:#b84">&#34;.yml&#34;</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#b84">&#34;Generate </span><span style="color:#b84">\(</span>_filename<span style="color:#b84">)</span><span style="color:#b84">&#34;</span><span style="font-weight:bold">:</span> file.Create <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>					$after<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span><span style="font-weight:bold">for</span> v <span style="font-weight:bold">in</span> clean {v}<span style="font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>					filename<span style="font-weight:bold">:</span> path.Join(<span style="font-weight:bold">[</span>_pipelineDir<span style="font-weight:bold">,</span> _filename<span style="font-weight:bold">],</span> _goos)
</span></span><span style="display:flex;"><span>					contents<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;# </span><span style="color:#b84">\(</span>_donotedit<span style="color:#b84">)</span><span style="color:#b84">\n\n</span><span style="color:#b84">\(</span>yaml.Marshal(_pipeline<span style="color:#b84">)</span><span style="color:#b84">)&#34;</span>
</span></span><span style="display:flex;"><span>				}
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>
</p>
<p>Make the modification indicated by the <code>TODO</code> comment.</p>
<p>This workflow command will export each CUE-based pipeline back into its required YAML file,
on demand.</p>
<h4 id="arrow_right-test-the-cue-workflow-command">
    <a href="#arrow_right-test-the-cue-workflow-command" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Test the CUE workflow command</h4>
<p>With the modified <code>ci_tool.cue</code> file in place, check that the <code>regenerate</code>
workflow command is available <strong>from a shell sitting at the repo root</strong>. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y2QgJChnaXQgcmV2LXBhcnNlIC0tc2hvdy10b3BsZXZlbCkgIyBtYWtlIHN1cmUgd2UncmUgc2l0dGluZyBhdCB0aGUgcmVwb3NpdG9yeSByb290CmN1ZSBoZWxwIGNtZCByZWdlbmVyYXRlIC4vaW50ZXJuYWwvY2kvYnVpbGRraXRlIHwgaGVhZCAtNCA&#43;Li4vMTEuYWN0dWFsLnR4dA==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cd $(git rev-parse --show-toplevel) # make sure we&#39;re sitting at the repository root
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># cue help cmd regenerate ./internal/ci/buildkite   # the &#34;./&#34; prefix is required
</span></span><span style="display:flex;"><span>$ cue help cmd regenerate ./internal/ci/buildkite | head -4 &gt;../11.actual.txt</span></span></code></pre></div></div>
</div>
<p>Your output <strong>must</strong> begin with the following:</p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="11.expected.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="11.expected.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>11.expected.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="11.expected.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="UmVnZW5lcmF0ZSBhbGwgcGlwZWxpbmUgZmlsZXMKClVzYWdlOgogIGN1ZSBjbWQgcmVnZW5lcmF0ZSBbZmxhZ3Nd">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Regenerate all pipeline files
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage:
</span></span><span style="display:flex;"><span>  cue cmd regenerate [flags]</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<table>
  <thead>
      <tr>
          <th style="text-align: left">:exclamation: WARNING :exclamation:</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">If you <em>don&rsquo;t</em> see the usage explanation for the <code>regenerate</code> workflow command (or if you receive an error message) then <strong>either</strong> your workflow command isn&rsquo;t set up as CUE requires, <strong>or</strong> you&rsquo;re running a CUE version older than <code>v0.11.0-alpha.2</code>. If you&rsquo;ve <a href="https://cuelang.org/dl">upgraded to at least that version</a> but the usage explanation still isn&rsquo;t being displayed then: (1) double check the contents of the <code>ci_tool.cue</code> file and the modifications you made to it; (2) make sure its location in the repository is precisely as given in this guide; (3) ensure the filename is <em>exactly</em> <code>ci_tool.cue</code>; (4) run <code>cue vet ./internal/ci/buildkite</code> and check that your pipelines actually validate successfully - in other words: were they truly valid before you even started this process? Lastly, make sure you&rsquo;ve followed all the steps in this guide, and that you invoked the <code>cue help</code> command from the repository&rsquo;s root directory. If you get really stuck, please come and join <a href="https://cuelang.org/community/">the CUE community</a> and ask for some help!</td>
      </tr>
  </tbody>
</table>
<h4 id="arrow_right-regenerate-the-yaml-pipeline-files">
    <a href="#arrow_right-regenerate-the-yaml-pipeline-files" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Regenerate the YAML pipeline files</h4>
<p>Run the <code>regenerate</code> workflow command to produce YAML pipeline files from CUE. For
example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGNtZCByZWdlbmVyYXRlIC4vaW50ZXJuYWwvY2kvYnVpbGRraXRlICMgdGhlICIuLyIgcHJlZml4IGlzIHJlcXVpcmVk">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue cmd regenerate ./internal/ci/buildkite # the &#34;./&#34; prefix is required</span></span></code></pre></div></div>
</div>
<h4 id="arrow_right-audit-changes-to-the-yaml-pipeline-files">
    <a href="#arrow_right-audit-changes-to-the-yaml-pipeline-files" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Audit changes to the YAML pipeline files</h4>
<p>Check that each YAML pipeline file has a single <em>material</em> change from the
original:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Z2l0IGRpZmYgLS0gLmJ1aWxka2l0ZS8gfCBncmVwIC12RSAnXmluZGV4IFswLTlhLWZdezd9XC5cLlswLTlhLWZdezd9JyB8IGhlYWQgLTggPi4uLzEzLmFjdHVhbC50eHQ=">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># git diff .buildkite/
</span></span><span style="display:flex;"><span>$ git diff -- .buildkite/ | grep -vE &#39;^index [0-9a-f]{7}\.\.[0-9a-f]{7}&#39; | head -8 &gt;../13.actual.txt</span></span></code></pre></div></div>
</div>
<p>Your output should look similar to the following example:</p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="13.expected.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="13.expected.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>13.expected.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="13.expected.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="ZGlmZiAtLWdpdCBhLy5idWlsZGtpdGUvcGlwZWxpbmUuZGVwbG95LnltbCBiLy5idWlsZGtpdGUvcGlwZWxpbmUuZGVwbG95LnltbAotLS0gYS8uYnVpbGRraXRlL3BpcGVsaW5lLmRlcGxveS55bWwKKysrIGIvLmJ1aWxka2l0ZS9waXBlbGluZS5kZXBsb3kueW1sCkBAIC0xLDYgKzEsOCBAQAorIyBDb2RlIGdlbmVyYXRlZCBieSBpbnRlcm5hbC9jaS9idWlsZGtpdGUvY2lfdG9vbC5jdWU7IERPIE5PVCBFRElULgorCiBzdGVwczoKICAgLSBjb21tYW5kOiBlY2hvICdEZXBsb3kn">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>diff --git a/.buildkite/pipeline.deploy.yml b/.buildkite/pipeline.deploy.yml
</span></span><span style="display:flex;"><span>--- a/.buildkite/pipeline.deploy.yml
</span></span><span style="display:flex;"><span>+++ b/.buildkite/pipeline.deploy.yml
</span></span><span style="display:flex;"><span>@@ -1,6 +1,8 @@
</span></span><span style="display:flex;"><span>+# Code generated by internal/ci/buildkite/ci_tool.cue; DO NOT EDIT.
</span></span><span style="display:flex;"><span>+
</span></span><span style="display:flex;"><span> steps:
</span></span><span style="display:flex;"><span>   - command: echo &#39;Deploy&#39;</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="ZGlmZiAuLi8xMy5leHBlY3RlZC50eHQgLi4vMTMuYWN0dWFsLnR4dA==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ diff ../13.expected.txt ../13.actual.txt</span></span></code></pre></div></div>
</div>
<p>The only <em>material</em> change in each YAML file is the addition of a header that
warns the reader not to edit the file directly.</p>
<h4 id="arrow_right-add-and-commit-files-to-git">
    <a href="#arrow_right-add-and-commit-files-to-git" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Add and commit files to git</h4>
<p>Add your files to git. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Z2l0IGFkZCAuYnVpbGRraXRlLyBpbnRlcm5hbC9jaS9idWlsZGtpdGUvIGN1ZS5tb2QvbW9kdWxlLmN1ZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ git add .buildkite/ internal/ci/buildkite/ cue.mod/module.cue</span></span></code></pre></div></div>
</div>
<p>Make sure to include your slightly modified YAML pipeline files in
<code>.buildkite/</code> along with all the new files in <code>internal/ci/buildkite/</code> and
your <code>cue.mod/module.cue</code> file.</p>
<p>Commit your files to git, with an appropriate commit message:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Z2l0IGNvbW1pdCAtLXF1aWV0IC1tICJjaTogY3JlYXRlIENVRSBzb3VyY2VzIGZvciBCdWlsZGtpdGUgcGlwZWxpbmVzIg==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># git commit -m &#34;ci: create CUE sources for Buildkite pipelines&#34;
</span></span><span style="display:flex;"><span>$ git commit --quiet -m &#34;ci: create CUE sources for Buildkite pipelines&#34;</span></span></code></pre></div></div>
</div>
<h2 id="conclusion">
    <a href="#conclusion" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Conclusion</h2>
<p><strong>Well done - your static Buildkite pipeline files have been imported into
CUE!</strong></p>
<p>They can now be managed using CUE, leading to safer and more predictable
changes. The use of a schema to check your pipelines means that you
will catch and fix many types of mistake earlier than before, without waiting
for the slow &ldquo;git add/commit/push; check if CI fails&rdquo; cycle.</p>
<p>From now on, each time you make a change to a CUE pipeline file, immediately
regenerate the YAML files required by Buildkite, and commit your changes
to all the CUE and YAML files. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGNtZCByZWdlbmVyYXRlIC4vaW50ZXJuYWwvY2kvYnVpbGRraXRlLyAjIHRoZSAiLi8iIHByZWZpeCBpcyByZXF1aXJlZApnaXQgYWRkIC5idWlsZGtpdGUvIGludGVybmFsL2NpL2J1aWxka2l0ZS8KZ2l0IGNvbW1pdCAtbSAiY2k6IGFkZGVkIG5ldyByZWxlYXNlIHBpcGVsaW5lIiAjIGV4YW1wbGUgbWVzc2FnZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue cmd regenerate ./internal/ci/buildkite/ # the &#34;./&#34; prefix is required
</span></span><span style="display:flex;"><span>$ git add .buildkite/ internal/ci/buildkite/
</span></span><span style="display:flex;"><span>$ git commit -m &#34;ci: added new release pipeline&#34; # example message</span></span></code></pre></div></div>
</div>

                        
                    </div><footer class="article__footer">
    <div class="article__lastmod">
        <p class="lastmod">
         <a class="lastmod__link" href="https://github.com/cue-lang/cuelang.org/commit/7687bbf072c82a4de99c92407b3260cf711e4cc7">
                Last modified March 27, 2025</a>
    </p>

    </div>

    <div class="article__footer-meta"><div class="article__share"><details class="share" data-dropdown>
    <summary class="button button--icon button--light-blue share__button">
        



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--share"></use>
</svg>

        <span>Open share options</span>
    </summary>

    <ul class="share__list">
        <li class="share__item" data-copy>
            <button class="share__copy" data-copy-button data-copy-type="url" data-copy-value="/docs/draft/cbe-006_buildkite_importing_pipelines/">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>

                <span class="share__link-text">Copy link</span>
                <span class="share__copy-message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button>
        </li>

        <li class="share__item">
            <a class="share__link" target="_blank" href="https://twitter.com/intent/tweet?url=/docs/draft/cbe-006_buildkite_importing_pipelines/&text=%20Source:%20https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines%20Driving%20Buildkite%20Pipelines%20with%20CUE%20by%20Jonathan%20Matthews%0aThis%20guide%20explains%20how%20to%20convert%20static%20Buildkite%20pipeline%20files%20from%20YAML%20to%20CUE,%20check%20those%20pipelines%20are%20valid,%20and%20then%20use%20CUE&amp;rsquo;s%20tooling%20layer%20to%20regenerate%20YAML.%0aThis%20allows%20you%20to%20switch%20to%20CUE%20as%20a%20source%20of%20truth%20for%20Buildkite%20pipelines%20and%20perform%20client-side%20validation,%20without%20Buildkite%20needing%20to%20know%20you&amp;rsquo;re%20managing%20your%20static%20pipelines%20with%20CUE.%0a">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                <p><span class="share__link-text">Share on X (Twitter)</span></p>
            </a>
        </li>

        <li class="share__item">
            <a class="share__link" target="_blank"
            href="https://www.linkedin.com/shareArticle?mini=true&url=/docs/draft/cbe-006_buildkite_importing_pipelines/&summary=%20Source:%20https://github.com/cue-labs/cue-by-example/blob/main/006_buildkite_importing_pipelines%20Driving%20Buildkite%20Pipelines%20with%20CUE%20by%20Jonathan%20Matthews%0aThis%20guide%20explains%20how%20to%20convert%20static%20Buildkite%20pipeline%20files%20from%20YAML%20to%20CUE,%20check%20those%20pipelines%20are%20valid,%20and%20then%20use%20CUE&amp;rsquo;s%20tooling%20layer%20to%20regenerate%20YAML.%0aThis%20allows%20you%20to%20switch%20to%20CUE%20as%20a%20source%20of%20truth%20for%20Buildkite%20pipelines%20and%20perform%20client-side%20validation,%20without%20Buildkite%20needing%20to%20know%20you&amp;rsquo;re%20managing%20your%20static%20pipelines%20with%20CUE.%0a">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-linkedin"></use>
</svg>

                <p><span class="share__link-text">Share on Linkedin</span></p>
            </a>
        </li>
    </ul>
</details>
</div>
    </div>
</footer>
</div>
            </article>

            



<div class="prevnext">
    <nav class="prevnext__container" aria-label="Previous/Next navigation"><a class="prevnext__prev" href="/docs/draft/cbe-003_kubernetes_tutorial/" aria-label="Previous - CUE By Example - Controlling Kubernetes with CUE">
                



<svg class="icon prevnext__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--circle-arrow-left"></use>
</svg>

                <span class="prevnext__text">CUE By Example - Controlling Kubernetes with CUE</span>
            </a><a class="prevnext__next" href="/docs/draft/cbe-001_github_actions_importing_workflows/" aria-label="Next - CUE By Example - Driving GitHub Actions workflows with CUE">
                <span class="prevnext__text">CUE By Example - Driving GitHub Actions workflows with CUE</span>
                



<svg class="icon prevnext__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--circle-arrow-right"></use>
</svg>

            </a></nav>
</div>

        </div>
        <div id="docs-menu" class="docs__aside">
            <div class="docs__backdrop" data-docs-close="docs"></div>
            <div class="docs__nav">
                <nav class="tree">
    <ul class="tree__list is-book">
        
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/introduction/" title="Introduction">
            <span class="tree__text">Introduction</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/tour/" title="Tour">
            <span class="tree__text">Tour</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/integration/" title="Integrations">
            <span class="tree__text">Integrations</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/tutorial/" title="Tutorials">
            <span class="tree__text">Tutorials</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/howto/" title="How-to Guides">
            <span class="tree__text">How-to Guides</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/concept/" title="Concept Guides">
            <span class="tree__text">Concept Guides</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/reference/" title="References">
            <span class="tree__text">References</span>
        </a>
    </li>
    </ul>
</nav>



                <button type="button" class="docs__hide button button--icon button--raised button--light-blue"
                        aria-haspopup="menu" aria-expanded="false" aria-controls="docs-menu" data-docs-toggle>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--chevron-left"></use>
</svg>
<span>Hide side navigation</span>
                </button>
            </div>
        </div>

        <button type="button" class="docs__show button button--icon button--raised button--light-blue"
                aria-haspopup="menu" aria-expanded="false" aria-controls="docs-menu" data-docs-toggle>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--chevron-right"></use>
</svg>
<span>Show side navigation</span>
        </button>
    </div>

            </main>

            <footer id="site-footer" class="site__footer">
                




<div class="footer">
    <div class="footer__sitemap">
        <nav class="footer__container" aria-label="Footer menu">
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Get Started</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/">
                                    <span class="nav__text">Documentation</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/tour/">
                                    <span class="nav__text">Language Tour</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/play/">
                                    <span class="nav__text">Playground</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/introduction/installation/">
                                    <span class="nav__text">Install CUE</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Community</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/community">
                                    <span class="nav__text">The CUE Community</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://github.com/cue-lang/cue/blob/master/CONTRIBUTING.md#contribution-guide" target="_blank">
                                    <span class="nav__text">Contributing</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/reference/code-of-conduct/">
                                    <span class="nav__text">Code of Conduct</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/s/slack">
                                    <span class="nav__text">Slack Workspace</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/s/discord">
                                    <span class="nav__text">Discord Server</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Connect</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://github.com/cue-lang/cue" target="_blank">
                                    <span class="nav__text">GitHub</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://twitter.com/cue_lang" target="_blank">
                                    <span class="nav__text">X (Twitter)</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://bsky.app/profile/cuelang.org" target="_blank">
                                    <span class="nav__text">Bluesky</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://www.youtube.com/@cuelang/videos" target="_blank">
                                    <span class="nav__text">YouTube</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
        </nav>
    </div>

    <div class="footer__legal">
        <nav class="footer__container" aria-label="Legal">
            <div class="nav nav--legal">
                <ul class="nav__list">
                    <li class="nav__item">
                        <span class="nav__text">&copy; 2025 CUE</span>
                    </li>

                    
                        <li class="nav__item"><a class="nav__link"
                               href="/privacy-policy/">
                                <span class="nav__text">Privacy policy</span>
                            </a>
                        </li>
                    

                    <li class="nav__item">
                        <a class="nav__link" href="https://github.com/cue-lang/cue/issues/new?labels=Triage,NeedsInvestigation,cuelang.org&amp;title=cuelang.org:%20&amp;template=bug_report.md&amp;body=%23%23%23&#43;What&#43;page&#43;were&#43;you&#43;looking&#43;at%3F%0A%0A%2Fdocs%2Fdraft%2Fcbe-006_buildkite_importing_pipelines%2F%0A%0A%23%23%23&#43;What&#43;version&#43;of&#43;the&#43;site&#43;were&#43;you&#43;looking&#43;at%3F%0A%0Ahttps%3A%2F%2Fgithub.com%2Fcue-lang%2Fcuelang.org%2Fcommit%2F64789fe0b723abceb454dfea8fdc748298d590e3%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;do%3F%0A%0A%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;expect%3F%0A%0A%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;see&#43;instead%3F%0A%0A" target="_blank">
                            <span class="nav__text">Report an Issue</span>
                        </a>
                    </li>
                </ul>
            </div>

            <a href="/" class="footer__branding" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>
        </nav>
    </div>
</div>

            </footer>
        </div>

        
                <div class="notification-bar is-hidden" data-notification-bar="cue-minor-release-v0.13">
        <div class="notification-bar__container">
            <div class="notification-bar__content">
                <strong>CUE v0.13 is now available</strong> &ndash; learn more about its <a href="https://github.com/cue-lang/cue/releases/tag/v0.13.0">new features and improvements</a>
            </div>
            <a class="button button--outline notification-bar__cta" href="/docs/introduction/installation/">
                    <span class="button__text">Install CUE</span>
                    



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--download"></use>
</svg>

                </a>
            <button type="button" class="button button--icon button--small notification-bar__close">
                



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--close"></use>
</svg>

                <span class="button__text">Close</span>
            </button>
        </div>
    </div>

        
        

<div id="mobile-menu" class="drawer drawer--mobile" data-drawer="menu">
    <div class="drawer__backdrop" data-drawer-close="menu"></div>
    <div class="drawer__container" tabindex="0">
        <div class="drawer__header">
            <a href="/" class="drawer__branding" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>

            <div class="drawer__close">
                <button type="button" class="button button--white button--icon" data-drawer-close="menu">
                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--close"></use>
</svg>

                    <span class="button__text">Hide menu</span>
                </button>
            </div>
        </div>

        <div class="drawer__content">
            <div class="drawer__menu">
                <nav class="nav nav--mobile" aria-label="Mobile menu">
                    <ul class="nav__list">
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/docs/">
                                    <span class="nav__text">Documentation</span>
                                </a>
                            </li>
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/play/">
                                    <span class="nav__text">Play</span>
                                </a>
                            </li>
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/community/">
                                    <span class="nav__text">Community</span>
                                </a>
                            </li>
                        

                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/docs/introduction/installation/">
                                    <span class="nav__text">Install</span>
                                </a>
                            </li>
                        

                        <li class="nav__item nav__item--search">





<div data-search-autocomplete="drawer"
     data-searchbar-size="small"
     data-searchbar-placeholder=""
>
    <div id="autocomplete-drawer"></div>
</div>
</li>
                    </ul>
                </nav>
            </div>
        </div>

        <div class="drawer__footer">
            <nav class="nav nav--social" aria-label="Social">
                <ul class="nav__list">
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://github.com/cue-lang/cue"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--github"></use>
</svg>

                                <span class="nav__text">GitHub</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="/s/slack">
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--slack"></use>
</svg>

                                <span class="nav__text">Slack</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="/s/discord">
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-discord"></use>
</svg>

                                <span class="nav__text">Discord</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://twitter.com/cue_lang"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                                <span class="nav__text">X (Twitter)</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://bsky.app/profile/cuelang.org"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-bluesky"></use>
</svg>

                                <span class="nav__text">Bluesky</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://www.youtube.com/@cuelang/videos"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-youtube"></use>
</svg>

                                <span class="nav__text">YouTube</span>
                            </a>
                        </li>
                    
                </ul>
            </nav>
        </div>
    </div>
</div>

        

    
    <script src="/js/main.min.f4174e980af6f5e0cedc0ce09a77d6f3a18405dee07c4cdd87543814539fabb3.js" integrity="sha256-9BdOmAr29eDO3AzgmnfW86GEBd7gfEzdh1Q4FFOfq7M=" async></script>






    </body>
</html>
