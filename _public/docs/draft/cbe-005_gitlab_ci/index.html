<!doctype html>
<html lang="en" dir="ltr" class="no-js">
    <head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Source: https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md Driving GitLab CI/CD pipelines with CUE by Jonathan …">
<meta name="generator" content="Hugo 0.147.5">

<meta name="robots" content="noindex, nofollow">

<link rel="canonical" href="https://cuelang.org/docs/draft/cbe-005_gitlab_ci/" />
<link rel="shortcut icon" href="/favicons/favicon.ico">
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
<link rel="manifest" href="/favicons/webmanifest.json">
<link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#232a68">
<meta name="msapplication-TileColor" content="#232a68">
<meta name="msapplication-config" content="/favicons/browserconfig.xml">
<meta name="theme-color" content="#232a68">

<title>CUE By Example - Driving GitLab CI/CD pipelines with CUE | CUE</title><meta property="og:url" content="/docs/draft/cbe-005_gitlab_ci/">
  <meta property="og:site_name" content="CUE">
  <meta property="og:title" content="CUE By Example - Driving GitLab CI/CD pipelines with CUE">
  <meta property="og:description" content="Source: https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md Driving GitLab CI/CD pipelines with CUE by Jonathan Matthews
This guide explains how to convert a GitLab CI/CD pipeline file from YAML to CUE, check its contents are valid, and then use CUE’s tooling layer to regenerate YAML.
This is useful because it allows you to switch to CUE as a source of truth for GitLab pipelines and perform client-side validation, without GitLab needing to know you’re managing your pipelines with CUE.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:modified_time" content="2025-04-08T13:31:31+01:00">
    <meta property="og:image" content="/img/social.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="/img/social.png">
  <meta name="twitter:title" content="CUE By Example - Driving GitLab CI/CD pipelines with CUE">
  <meta name="twitter:description" content="Source: https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md Driving GitLab CI/CD pipelines with CUE by Jonathan Matthews
This guide explains how to convert a GitLab CI/CD pipeline file from YAML to CUE, check its contents are valid, and then use CUE’s tooling layer to regenerate YAML.
This is useful because it allows you to switch to CUE as a source of truth for GitLab pipelines and perform client-side validation, without GitLab needing to know you’re managing your pipelines with CUE.">





<link rel="preload" href="/scss/main.min.8351627014ac2bf7396348f13a7d9959c01f0c9eee800e29af55ada087dad866.css" as="style">
<link href="/scss/main.min.8351627014ac2bf7396348f13a7d9959c01f0c9eee800e29af55ada087dad866.css" rel="stylesheet" integrity="">



<link rel="preload" href="/fonts/inter/regular.woff2" as="font" crossorigin="anonymous">
<link rel="preload" href="/fonts/inter/500.woff2" as="font" crossorigin="anonymous">
<link rel="preload" href="/fonts/inter/700.woff2" as="font" crossorigin="anonymous">



<script>(()=>{document.documentElement.classList.remove("no-js"),document.documentElement.classList.add("js")})()</script>
</head>
    <body itemscope itemtype="https://schema.org/WebPage">
        <meta itemprop="name" content="CUE By Example - Driving GitLab CI/CD pipelines with CUE">
<meta itemprop="description" content=" Source: https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md Driving GitLab CI/CD pipelines with CUE by Jonathan Matthews
This guide explains how to convert a GitLab CI/CD pipeline file from YAML to CUE, check its contents are valid, and then use CUE&rsquo;s tooling layer to regenerate YAML.
This is useful because it allows you to switch to CUE as a source of truth for GitLab pipelines and perform client-side validation, without GitLab needing to know you&rsquo;re managing your pipelines with CUE.
">

    
        <meta itemprop="dateModified" content="2025-04-08T13:31:31+01:00" >
    
            
        <meta itemprop="image" content="/img/social.png"/>
            
    <meta itemprop="keywords" content="" />

        <a id="skip-nav" class="skip-link" href="#site-main" target="_self">Skip to content</a>

        <div class="site">
            <header id="site-header" class="site__header">
                

<div class="header header--wide" data-header>
    <div class="header__container">
        <div class="header__background"></div>

        <div class="header__branding">
            <a href="/" class="header__logo" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>
        </div>

        <div class="header__main">
            <nav class="nav nav--main" aria-label="Main menu">
                <ul class="nav__list">
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/docs/"><span class="nav__text">Documentation</span></a>
                        </li>
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/play/"><span class="nav__text">Play</span></a>
                        </li>
                    
                        <li class="nav__item"><a class="nav__link"
                               href="/community/"><span class="nav__text">Community</span></a>
                        </li>
                    
                </ul>
            </nav>
        </div>

        <div class="header__secondary">
            <div class="header__icons">
                <nav class="nav nav--social" aria-label="Social">
                    <ul class="nav__list"><li class="nav__item"><a class="nav__link"
                                   href="https://github.com/cue-lang/cue" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--github"></use>
</svg>

                                    <span class="nav__text">GitHub</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="/s/slack">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--slack"></use>
</svg>

                                    <span class="nav__text">Slack</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="/s/discord">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-discord"></use>
</svg>

                                    <span class="nav__text">Discord</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://twitter.com/cue_lang" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                                    <span class="nav__text">X (Twitter)</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://bsky.app/profile/cuelang.org" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-bluesky"></use>
</svg>

                                    <span class="nav__text">Bluesky</span>
                                </a>
                            </li><li class="nav__item"><a class="nav__link"
                                   href="https://www.youtube.com/@cuelang/videos" target="_blank">
                                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-youtube"></use>
</svg>

                                    <span class="nav__text">YouTube</span>
                                </a>
                            </li></ul>
                </nav>
            </div>

            <div class="header__cta"><a class="button button--skinny"
                       href="/docs/introduction/installation/"><span class="button__text">Install</span>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--download"></use>
</svg>
</a></div>

            <div class="header__search" data-menu>
                <a href="/search" class="button button--icon button--white-simple" rel="search" data-menu-dropdown="header-dropdown-search">



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--search"></use>
</svg>
<span>Search</span>
                </a>

                <div class="header__dropdown header__dropdown--search" data-menu-dropdown-target="header-dropdown-search">
                    <p class="header__search-title">What are you looking for?</p>





<div data-search-autocomplete="menu"
     data-searchbar-size="small"
     data-searchbar-placeholder=""
>
    <div id="autocomplete-menu"></div>
</div>
</div>
            </div>

            <div class="header__toggle">
                <button class="button button--outline" data-drawer-toggle="menu" aria-haspopup="menu" aria-expanded="false" aria-controls="mobile-menu">
                    <span class="button__text">Menu</span>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--menu"></use>
</svg>
</button>
            </div>
        </div>
    </div>
</div>

            </header>

            <main id="site-main" class="site__content" itemprop="mainContentOfPage">
                

    <div class="docs" data-docs>
        <div class="docs__main">
            <nav class="breadcrumb" aria-label="breadcrumb">
    <ol class="breadcrumb__list">
    

    
    

    
        <li class="breadcrumb__item"><a class="breadcrumb__link" href="/docs/draft/">Drafts</a></li>
    
    

    
        <li class="breadcrumb__item" aria-current="page"><h1 class="breadcrumb__text">CUE By Example - Driving GitLab CI/CD pipelines with CUE</h1></li>
    
    </ol>
</nav>


            <article class="article article--docs" itemscope itemtype="https://schema.org/TechArticle">
                <meta itemprop="articleBody" content="




    

Source: https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md



    




    

Driving GitLab CI/CD pipelines with CUE
by Jonathan Matthews
This guide explains how to convert a GitLab CI/CD pipeline file from YAML to
CUE, check its contents are valid, and then use CUE&rsquo;s tooling layer to
regenerate YAML.
This is useful because it allows you to switch to CUE as a source of truth for
GitLab pipelines and perform client-side validation, without GitLab needing to
know you&rsquo;re managing your pipelines with CUE.

  
      
          :exclamation: WARNING :exclamation:
      
  
  
      
          This guide requires that you use cue version v0.11.0-alpha.4 or later. The process described below won&rsquo;t work with earlier versions. Check the version of your cue command by running cue version, and upgrade it if needed.
      
  


    




    

Prerequisites

You have a GitLab pipeline file.

The example shown throughout this guide uses the pipeline file from a
specific commit in the
gitlab-org/gitlab repository
on gitlab.com, as linked from GitLab&rsquo;s
CI documentation pages,
but you don&rsquo;t need to use that repository in any way. It&rsquo;s used as the
example in this guide only because it&rsquo;s a reasonably complex GitLab
pipeline file.


You have cue installed.

You must have version v0.11.0-alpha.4 or later installed. Using an
earlier version will cause certain commands in this guide to fail.


You have git installed.
You have curl installed, or can fetch a remote
file some other way.


    




    

Steps

    




    

Convert YAML pipeline to CUE

    




    

:arrow_right: Begin with a clean git state
Change directory into the root of the repository that contains your GitLab
pipeline file, and ensure you start this process with a clean git state, with
no modified files. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cd gitlab # our example repository
$ git status # should report &#34;working tree clean&#34;
On branch master
nothing to commit, working tree clean


    




    

:arrow_right: Initialise a CUE module
Initialise a CUE module named after the organisation and repository you&rsquo;re
working with, but containing only lowercase letters and numbers. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue mod init gitlab.com/gitlab-org/gitlab


    




    

:arrow_right: Import YAML pipeline
Use cue to import your YAML pipeline file:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue import .gitlab-ci.yml --with-context -p gitlab -f -l pipelines: -l &#39;strings.TrimSuffix(path.Base(filename),path.Ext(filename))&#39; -o gitlab-ci.cue

If your project uses a different name for your pipeline file then use that name
in the above command, and throughout this guide.
Check that a CUE file has been created from your pipeline file. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # Actual command in CUE-By-Example guide:
# ls {,.}*gitlab-ci*
$ ls {,.}*gitlab-ci* &gt;../4.expected.txt

Your output should look similar to this, with a matching YAML and CUE file:







            




    


                            Copied!
                        
                    4.actual.txt
            
        


                Copy code
                
                    Copied!
                
            .gitlab-ci.yml
gitlab-ci.cue






Observe that your file has been imported into the pipelines struct at a
location derived from its original file name, by running:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # Actual command in CUE-By-Example guide:
# head -9 gitlab-ci.cue
$ head -9 gitlab-ci.cue &gt;../5.actual.txt

The output should reflect your pipeline. In our example:







            




    


                            Copied!
                        
                    5.expected.txt
            
        


                Copy code
                
                    Copied!
                
            package gitlab

pipelines: &#34;.gitlab-ci&#34;: {
	stages: [
		&#34;sync&#34;,
		&#34;preflight&#34;,
		&#34;prepare&#34;,
		&#34;build-images&#34;,
		&#34;fixtures&#34;,







    




    

:arrow_right: Store CUE pipelines in a dedicated directory
Create a directory called gitlab to hold your CUE-based GitLab pipeline
files. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ mkdir -p internal/ci/gitlab

You may change the hierarchy and naming of gitlab&rsquo;s parent directories to
suit your repository layout. If you do so, you will need to adapt some commands
and CUE code as you follow this guide.
Move the newly-created CUE pipeline file into its dedicated directory. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ mv gitlab-ci.cue internal/ci/gitlab


    




    

Validate pipeline

    




    

:arrow_right: Create a pipeline schema
Fetch a schema for GitLab pipelines, as defined by the GitLab project, and
place it in the internal/ci/gitlab directory:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ curl -sSo internal/ci/gitlab/gitlab.cicd.pipeline.schema.json https://gitlab.com/gitlab-org/gitlab/-/raw/277c9f6b643c92d00101aca0f2b4b874a144f7c5/app/assets/javascripts/editor/schema/ci.json

We use a specific commit from the upstream repository to make sure that this
process is reproducible.
Convert the GitLab schema from JSON Schema to CUE:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue import -p gitlab -l &#39;#Pipeline:&#39; internal/ci/gitlab/gitlab.cicd.pipeline.schema.json

This command will create the file internal/ci/gitlab/gitlab.cicd.pipeline.schema.cue
in the gitlab package, with the contents of the upstream schema placed in the
field #Pipeline.

    




    

:arrow_right: Apply the schema
We need to tell CUE to apply the schema to the pipeline.
To do this we&rsquo;ll create a file at internal/ci/gitlab/pipelines.cue in our
example. However, if your earlier pipeline import already created a file with
that same path and name, then simply select a different CUE filename that
doesn&rsquo;t already exist.
Create the file in the internal/ci/gitlab/ directory and add this CUE:
:floppy_disk: internal/ci/gitlab/pipelines.cue







            




    


                            Copied!
                        
                    gitlab/internal/ci/gitlab/pipelines.cue
            
        


                Copy code
                
                    Copied!
                
            package gitlab

// each member of the pipelines struct must be a valid #Pipeline
pipelines: [_]: #Pipeline







    




    

:arrow_right: Validate your pipelines
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue vet -c ./internal/ci/gitlab

If this command fails and produces any output, then CUE believes that at least
one of your pipelines isn&rsquo;t valid. You&rsquo;ll need to resolve this before
continuing, by updating your pipelines inside your new CUE files. If you&rsquo;re
having difficulty fixing them, please come and ask for help in the friendly CUE
Slack workspace or
Discord server!

    




    

Generate YAML from CUE

    




    

:arrow_right: Create a CUE workflow command
Create a CUE file in internal/ci/gitlab/ containing the following workflow command.
Adapt the element commented with TODO:
:floppy_disk: internal/ci/gitlab/ci_tool.cue







            




    


                            Copied!
                        
                    gitlab/internal/ci/gitlab/ci_tool.cue
            
        


                Copy code
                
                    Copied!
                
            package gitlab

import (
	&#34;path&#34;
	&#34;encoding/yaml&#34;
	&#34;tool/file&#34;
)

_goos: string @tag(os,var=os)

// Regenerate pipeline files
command: regenerate: {
	pipeline_files: {
		// TODO: update _toolFile to reflect the directory hierarchy containing this file.
		// TODO: update _pipelineDir to reflect the directory containing your pipeline file.
		let _toolFile = &#34;internal/ci/gitlab/ci_tool.cue&#34;
		let _pipelineDir = path.FromSlash(&#34;.&#34;, path.Unix)
		let _donotedit = &#34;Code generated by \(_toolFile); DO NOT EDIT.&#34;

		for _pipelineName, _pipelineConfig in pipelines
		let _pipelineFile = _pipelineName &#43; &#34;.yml&#34;
		let _pipelinePath = path.Join([_pipelineDir, _pipelineFile]) {
			let delete = {
				&#34;Delete \(_pipelinePath)&#34;: file.RemoveAll &amp; {path: _pipelinePath}
			}
			delete
			create: file.Create &amp; {
				$after:   delete
				filename: _pipelinePath
				contents: &#34;# \(_donotedit)\n\n\(yaml.Marshal(_pipelineConfig))&#34;
			}
		}
	}
}






Make the modifications indicated by the TODO comments.
The regenerate workflow command will export your CUE-based pipeline back into its required YAML file,
on demand.

    




    

:arrow_right: Test the CUE workflow command
With the modified ci_tool.cue file in place, check that the regenerate
workflow command is available from a shell sitting at the repository root. For
example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cd $(git rev-parse --show-toplevel) # make sure we&#39;re sitting at the repository root

# Actual command in CUE-By-Example guide:
# cue help cmd regenerate ./internal/ci/gitlab   # the &#34;./&#34; prefix is required
$ cue help cmd regenerate ./internal/ci/gitlab | head -4 &gt;../12.actual.txt

The output of the cue help command must begin with the following:







            




    


                            Copied!
                        
                    12.expected.txt
            
        


                Copy code
                
                    Copied!
                
            Regenerate pipeline files

Usage:
  cue cmd regenerate [flags]







  
      
          :exclamation: WARNING :exclamation:
      
  
  
      
          If you don&rsquo;t see the usage explanation for the regenerate workflow command (or if you receive an error message) then either your workflow command isn&rsquo;t set up as CUE requires, or you&rsquo;re running a CUE version older than v0.11.0-alpha.4. If you&rsquo;ve upgraded to at least that version but the usage explanation still isn&rsquo;t being displayed then: (1) double check the contents of the ci_tool.cue file and the modifications you made to it; (2) make sure its location in the repository is precisely as given in this guide; (3) ensure the filename is exactly ci_tool.cue; (4) run cue vet ./internal/ci/gitlab and check that your pipelines actually validate successfully - in other words: were they truly valid before you even started this process? Lastly, make sure you&rsquo;ve followed all the steps in this guide, and that you invoked the cue help command from the repository&rsquo;s root directory. If you get really stuck, please come and join the CUE community and ask for some help!
      
  


    




    

:arrow_right: Regenerate the YAML pipeline file
Run the regenerate workflow command to produce a YAML pipeline file from CUE. For
example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue cmd regenerate ./internal/ci/gitlab # the &#34;./&#34; prefix is required


    




    

:arrow_right: Audit changes to the YAML pipeline file
Check that your YAML pipeline file has a single material change from the
original:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # 2 commands not present in CUE-By-Example guide, added as an attempt to work
# around cue-lang/cue#3492. DELETE THESE COMMANDS!
$ sleep 1
$ sync

# Actual command in CUE-By-Example guide:
# git diff .gitlab-ci.yml
# For some unknown reason the trailing &#39;&gt;../...&#39; redirection *only* works when
# the diff command is given a &#39;--&#39; separator. I&#39;m utterly stumped, but let&#39;s
# just give it what it wants!
$ git diff -- .gitlab-ci.yml | grep -vE &#39;^index [0-9a-f]{7}\.\.[0-9a-f]{7}&#39; | head -9 &gt;../14.actual.txt

Your output should look similar to the following example:







            




    


                            Copied!
                        
                    14.expected.txt
            
        


                Copy code
                
                    Copied!
                
            diff --git a/.gitlab-ci.yml b/.gitlab-ci.yml
--- a/.gitlab-ci.yml
&#43;&#43;&#43; b/.gitlab-ci.yml
@@ -1,3 &#43;1,5 @@
&#43;# Code generated by internal/ci/gitlab/ci_tool.cue; DO NOT EDIT.
&#43;
 stages:
   - sync
   - preflight






The main change in each YAML file is the addition of a header that warns the
reader not to edit the file directly.
Your diff might also contain some YAML reformatting (with the number of leading
spaces having been changed in nested structures) but this won&rsquo;t make a
difference to the underlying meaning of the file.
Additionally, any comments in the original YAML file will now be found only
in the CUE source file - which is important as that&rsquo;s the only file that you&rsquo;ll
be manually changing, from now on.

    




    

:arrow_right: Add and commit files to git
Add your files to git. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ git add .gitlab-ci.yml internal/ci/gitlab/ cue.mod/module.cue

Make sure to include your slightly modified YAML pipeline file, wherever you
store it, along with all the new files in internal/ci/gitlab/ and your
cue.mod/module.cue file.
Commit your files to git, with an appropriate commit message:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            # Actual command in CUE-By-Example guide:
# git commit -m &#34;ci: create CUE sources for GitLab CI/CD pipelines&#34;
$ git commit --quiet -m &#34;ci: create CUE sources for GitLab CI/CD pipelines&#34;


    




    

Conclusion
Well done - your GitLab CI/CD pipeline file has been imported into CUE!
It can now be managed using CUE, leading to safer and more predictable changes.
The use of a schema to check your pipeline means that you will catch and fix
certain types of mistake earlier than before, without waiting for the slow &ldquo;git
add/commit/push; check if CI fails&rdquo; cycle.
From now on, each time you make a change to a CUE pipeline file, immediately
regenerate the YAML files required by GitLab CI/CD, and commit your changes to
all the CUE and YAML files. For example:
:computer: terminal

            TERMINAL
        
                Copy code
                
                    Copied!
                
            $ cue cmd regenerate ./internal/ci/gitlab/ # the &#34;./&#34; prefix is required
$ git add .gitlab-ci.yml internal/ci/gitlab/
$ git commit -m &#34;ci: added new release pipeline&#34; # example message

">
<meta itemprop="wordCount" content="1805">


                <div class="article__container">
                    



<header class="article__header">
        </header>



                    <div class="article__content">
                        
                            <div class="note note--caution" role="alert">



<svg class="icon note__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--exclamation"></use>
</svg>
<div class="note__content">Source: <a href="https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md">https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md</a></div>
</div>

<h1 id="driving-gitlab-cicd-pipelines-with-cue">
    <a href="#driving-gitlab-cicd-pipelines-with-cue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Driving GitLab CI/CD pipelines with CUE</h1>
<p><sup>by <a href="https://jonathanmatthews.com">Jonathan Matthews</a></sup></p>
<p>This guide explains how to convert a GitLab CI/CD pipeline file from YAML to
CUE, check its contents are valid, and then use CUE&rsquo;s tooling layer to
regenerate YAML.</p>
<p>This is useful because it allows you to switch to CUE as a source of truth for
GitLab pipelines and perform client-side validation, without GitLab needing to
know you&rsquo;re managing your pipelines with CUE.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">:exclamation: WARNING :exclamation:</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">This guide requires that you use <code>cue</code> version <code>v0.11.0-alpha.4</code> or later. <strong>The process described below won&rsquo;t work with earlier versions</strong>. Check the version of your <code>cue</code> command by running <code>cue version</code>, and <a href="https://cuelang.org/dl">upgrade it</a> if needed.</td>
      </tr>
  </tbody>
</table>
<h2 id="prerequisites">
    <a href="#prerequisites" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Prerequisites</h2>
<ul>
<li>You have a GitLab pipeline file.
<ul>
<li>The example shown throughout this guide uses the pipeline file from a
specific commit in the
<a href="https://gitlab.com/gitlab-org/gitlab/-/blob/3308936efcd70839cc61e0545dcb780756e4ec28/.gitlab-ci.yml"><code>gitlab-org/gitlab</code> repository</a>
on gitlab.com, as linked from GitLab&rsquo;s
<a href="https://docs.gitlab.com/ee/ci/yaml/">CI documentation pages</a>,
but <strong>you don&rsquo;t need to use that repository in any way</strong>. It&rsquo;s used as the
example in this guide only because it&rsquo;s a reasonably complex GitLab
pipeline file.</li>
</ul>
</li>
<li>You have <a href="https://cuelang.org/docs/install/"><code>cue</code> installed</a>.
<ul>
<li>You must have version <code>v0.11.0-alpha.4</code> or later installed. Using an
earlier version will cause certain commands in this guide to fail.</li>
</ul>
</li>
<li>You have <a href="https://git-scm.com/downloads"><code>git</code> installed</a>.</li>
<li>You have <a href="https://curl.se/dlwiz/"><code>curl</code> installed</a>, or can fetch a remote
file some other way.</li>
</ul>
<h2 id="steps">
    <a href="#steps" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Steps</h2>
<h3 id="convert-yaml-pipeline-to-cue">
    <a href="#convert-yaml-pipeline-to-cue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Convert YAML pipeline to CUE</h3>
<h4 id="arrow_right-begin-with-a-clean-git-state">
    <a href="#arrow_right-begin-with-a-clean-git-state" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Begin with a clean git state</h4>
<p>Change directory into the root of the repository that contains your GitLab
pipeline file, and ensure you start this process with a clean git state, with
no modified files. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y2QgZ2l0bGFiICMgb3VyIGV4YW1wbGUgcmVwb3NpdG9yeQpnaXQgc3RhdHVzICMgc2hvdWxkIHJlcG9ydCAid29ya2luZyB0cmVlIGNsZWFuIg==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cd gitlab # our example repository
</span></span><span style="display:flex;"><span>$ git status # should report &#34;working tree clean&#34;
</span></span><span style="display:flex;"><span>On branch master
</span></span><span style="display:flex;"><span>nothing to commit, working tree clean</span></span></code></pre></div></div>
</div>
<h4 id="arrow_right-initialise-a-cue-module">
    <a href="#arrow_right-initialise-a-cue-module" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Initialise a CUE module</h4>
<p>Initialise a CUE module named after the organisation and repository you&rsquo;re
working with, but containing only lowercase letters and numbers. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIG1vZCBpbml0IGdpdGxhYi5jb20vZ2l0bGFiLW9yZy9naXRsYWI=">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue mod init gitlab.com/gitlab-org/gitlab</span></span></code></pre></div></div>
</div>
<h4 id="arrow_right-import-yaml-pipeline">
    <a href="#arrow_right-import-yaml-pipeline" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Import YAML pipeline</h4>
<p>Use <code>cue</code> to import your YAML pipeline file:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGltcG9ydCAuZ2l0bGFiLWNpLnltbCAtLXdpdGgtY29udGV4dCAtcCBnaXRsYWIgLWYgLWwgcGlwZWxpbmVzOiAtbCAnc3RyaW5ncy5UcmltU3VmZml4KHBhdGguQmFzZShmaWxlbmFtZSkscGF0aC5FeHQoZmlsZW5hbWUpKScgLW8gZ2l0bGFiLWNpLmN1ZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue import .gitlab-ci.yml --with-context -p gitlab -f -l pipelines: -l &#39;strings.TrimSuffix(path.Base(filename),path.Ext(filename))&#39; -o gitlab-ci.cue</span></span></code></pre></div></div>
</div>
<p>If your project uses a different name for your pipeline file then use that name
in the above command, and throughout this guide.</p>
<p>Check that a CUE file has been created from your pipeline file. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="bHMgeywufSpnaXRsYWItY2kqID4uLi80LmV4cGVjdGVkLnR4dA==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># ls {,.}*gitlab-ci*
</span></span><span style="display:flex;"><span>$ ls {,.}*gitlab-ci* &gt;../4.expected.txt</span></span></code></pre></div></div>
</div>
<p>Your output should look similar to this, with a matching YAML and CUE file:</p>
<p><div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="4.actual.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="4.actual.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>4.actual.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="4.actual.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="LmdpdGxhYi1jaS55bWwKZ2l0bGFiLWNpLmN1ZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>.gitlab-ci.yml
</span></span><span style="display:flex;"><span>gitlab-ci.cue</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

Observe that your file has been imported into the <code>pipelines</code> struct at a
location derived from its original file name, by running:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="aGVhZCAtOSBnaXRsYWItY2kuY3VlID4uLi81LmFjdHVhbC50eHQ=">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># head -9 gitlab-ci.cue
</span></span><span style="display:flex;"><span>$ head -9 gitlab-ci.cue &gt;../5.actual.txt</span></span></code></pre></div></div>
</div>
<p>The output should reflect your pipeline. In our example:</p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="5.expected.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="5.expected.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>5.expected.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="5.expected.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBnaXRsYWIKCnBpcGVsaW5lczogIi5naXRsYWItY2kiOiB7CglzdGFnZXM6IFsKCQkic3luYyIsCgkJInByZWZsaWdodCIsCgkJInByZXBhcmUiLAoJCSJidWlsZC1pbWFnZXMiLAoJCSJmaXh0dXJlcyIs">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>package gitlab
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pipelines: &#34;.gitlab-ci&#34;: {
</span></span><span style="display:flex;"><span>	stages: [
</span></span><span style="display:flex;"><span>		&#34;sync&#34;,
</span></span><span style="display:flex;"><span>		&#34;preflight&#34;,
</span></span><span style="display:flex;"><span>		&#34;prepare&#34;,
</span></span><span style="display:flex;"><span>		&#34;build-images&#34;,
</span></span><span style="display:flex;"><span>		&#34;fixtures&#34;,</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<h4 id="arrow_right-store-cue-pipelines-in-a-dedicated-directory">
    <a href="#arrow_right-store-cue-pipelines-in-a-dedicated-directory" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Store CUE pipelines in a dedicated directory</h4>
<p>Create a directory called <code>gitlab</code> to hold your CUE-based GitLab pipeline
files. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="bWtkaXIgLXAgaW50ZXJuYWwvY2kvZ2l0bGFi">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ mkdir -p internal/ci/gitlab</span></span></code></pre></div></div>
</div>
<p>You may change the hierarchy and naming of <code>gitlab</code>&rsquo;s <strong>parent</strong> directories to
suit your repository layout. If you do so, you will need to adapt some commands
and CUE code as you follow this guide.</p>
<p>Move the newly-created CUE pipeline file into its dedicated directory. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="bXYgZ2l0bGFiLWNpLmN1ZSBpbnRlcm5hbC9jaS9naXRsYWI=">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ mv gitlab-ci.cue internal/ci/gitlab</span></span></code></pre></div></div>
</div>
<h3 id="validate-pipeline">
    <a href="#validate-pipeline" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Validate pipeline</h3>
<h4 id="arrow_right-create-a-pipeline-schema">
    <a href="#arrow_right-create-a-pipeline-schema" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create a pipeline schema</h4>
<p>Fetch a schema for GitLab pipelines, as defined by the GitLab project, and
place it in the <code>internal/ci/gitlab</code> directory:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VybCAtc1NvIGludGVybmFsL2NpL2dpdGxhYi9naXRsYWIuY2ljZC5waXBlbGluZS5zY2hlbWEuanNvbiBodHRwczovL2dpdGxhYi5jb20vZ2l0bGFiLW9yZy9naXRsYWIvLS9yYXcvMjc3YzlmNmI2NDNjOTJkMDAxMDFhY2EwZjJiNGI4NzRhMTQ0ZjdjNS9hcHAvYXNzZXRzL2phdmFzY3JpcHRzL2VkaXRvci9zY2hlbWEvY2kuanNvbg==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ curl -sSo internal/ci/gitlab/gitlab.cicd.pipeline.schema.json https://gitlab.com/gitlab-org/gitlab/-/raw/277c9f6b643c92d00101aca0f2b4b874a144f7c5/app/assets/javascripts/editor/schema/ci.json</span></span></code></pre></div></div>
</div>
<p>We use a specific commit from the upstream repository to make sure that this
process is reproducible.</p>
<p>Convert the GitLab schema from JSON Schema to CUE:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGltcG9ydCAtcCBnaXRsYWIgLWwgJyNQaXBlbGluZTonIGludGVybmFsL2NpL2dpdGxhYi9naXRsYWIuY2ljZC5waXBlbGluZS5zY2hlbWEuanNvbg==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue import -p gitlab -l &#39;#Pipeline:&#39; internal/ci/gitlab/gitlab.cicd.pipeline.schema.json</span></span></code></pre></div></div>
</div>
<p>This command will create the file <code>internal/ci/gitlab/gitlab.cicd.pipeline.schema.cue</code>
in the <code>gitlab</code> package, with the contents of the upstream schema placed in the
field <code>#Pipeline</code>.</p>
<h4 id="arrow_right-apply-the-schema">
    <a href="#arrow_right-apply-the-schema" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Apply the schema</h4>
<p>We need to tell CUE to apply the schema to the pipeline.</p>
<p>To do this we&rsquo;ll create a file at <code>internal/ci/gitlab/pipelines.cue</code> in our
example. However, if your earlier pipeline import <em>already</em> created a file with
that same path and name, then simply select a different CUE filename that
<em>doesn&rsquo;t</em> already exist.</p>
<p>Create the file in the <code>internal/ci/gitlab/</code> directory and add this CUE:</p>
<p>:floppy_disk: <code>internal/ci/gitlab/pipelines.cue</code></p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="gitlab/internal/ci/gitlab/pipelines.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="gitlab/internal/ci/gitlab/pipelines.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>gitlab/internal/ci/gitlab/pipelines.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="gitlab/internal/ci/gitlab/pipelines.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBnaXRsYWIKCi8vIGVhY2ggbWVtYmVyIG9mIHRoZSBwaXBlbGluZXMgc3RydWN0IG11c3QgYmUgYSB2YWxpZCAjUGlwZWxpbmUKcGlwZWxpbmVzOiBbX106ICNQaXBlbGluZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> gitlab
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// each member of the pipelines struct must be a valid #Pipeline</span>
</span></span><span style="display:flex;"><span>pipelines<span style="font-weight:bold">:</span> <span style="font-weight:bold">[</span><span style="font-weight:bold">_</span><span style="font-weight:bold">]:</span> #Pipeline</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<h4 id="arrow_right-validate-your-pipelines">
    <a href="#arrow_right-validate-your-pipelines" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Validate your pipelines</h4>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIHZldCAtYyAuL2ludGVybmFsL2NpL2dpdGxhYg==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue vet -c ./internal/ci/gitlab</span></span></code></pre></div></div>
</div>
<p>If this command fails and produces any output, then CUE believes that at least
one of your pipelines isn&rsquo;t valid. You&rsquo;ll need to resolve this before
continuing, by updating your pipelines inside your new CUE files. If you&rsquo;re
having difficulty fixing them, please come and ask for help in the friendly CUE
<a href="https://cuelang.org/s/slack">Slack workspace</a> or
<a href="https://cuelang.org/s/discord">Discord server</a>!</p>
<h3 id="generate-yaml-from-cue">
    <a href="#generate-yaml-from-cue" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Generate YAML from CUE</h3>
<h4 id="arrow_right-create-a-cue-workflow-command">
    <a href="#arrow_right-create-a-cue-workflow-command" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Create a CUE workflow command</h4>
<p>Create a CUE file in <code>internal/ci/gitlab/</code> containing the following workflow command.
Adapt the element commented with <code>TODO</code>:</p>
<p>:floppy_disk: <code>internal/ci/gitlab/ci_tool.cue</code>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="gitlab/internal/ci/gitlab/ci_tool.cue"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="gitlab/internal/ci/gitlab/ci_tool.cue">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>gitlab/internal/ci/gitlab/ci_tool.cue
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="gitlab/internal/ci/gitlab/ci_tool.cue"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="cGFja2FnZSBnaXRsYWIKCmltcG9ydCAoCgkicGF0aCIKCSJlbmNvZGluZy95YW1sIgoJInRvb2wvZmlsZSIKKQoKX2dvb3M6IHN0cmluZyBAdGFnKG9zLHZhcj1vcykKCi8vIFJlZ2VuZXJhdGUgcGlwZWxpbmUgZmlsZXMKY29tbWFuZDogcmVnZW5lcmF0ZTogewoJcGlwZWxpbmVfZmlsZXM6IHsKCQkvLyBUT0RPOiB1cGRhdGUgX3Rvb2xGaWxlIHRvIHJlZmxlY3QgdGhlIGRpcmVjdG9yeSBoaWVyYXJjaHkgY29udGFpbmluZyB0aGlzIGZpbGUuCgkJLy8gVE9ETzogdXBkYXRlIF9waXBlbGluZURpciB0byByZWZsZWN0IHRoZSBkaXJlY3RvcnkgY29udGFpbmluZyB5b3VyIHBpcGVsaW5lIGZpbGUuCgkJbGV0IF90b29sRmlsZSA9ICJpbnRlcm5hbC9jaS9naXRsYWIvY2lfdG9vbC5jdWUiCgkJbGV0IF9waXBlbGluZURpciA9IHBhdGguRnJvbVNsYXNoKCIuIiwgcGF0aC5Vbml4KQoJCWxldCBfZG9ub3RlZGl0ID0gIkNvZGUgZ2VuZXJhdGVkIGJ5IFwoX3Rvb2xGaWxlKTsgRE8gTk9UIEVESVQuIgoKCQlmb3IgX3BpcGVsaW5lTmFtZSwgX3BpcGVsaW5lQ29uZmlnIGluIHBpcGVsaW5lcwoJCWxldCBfcGlwZWxpbmVGaWxlID0gX3BpcGVsaW5lTmFtZSArICIueW1sIgoJCWxldCBfcGlwZWxpbmVQYXRoID0gcGF0aC5Kb2luKFtfcGlwZWxpbmVEaXIsIF9waXBlbGluZUZpbGVdKSB7CgkJCWxldCBkZWxldGUgPSB7CgkJCQkiRGVsZXRlIFwoX3BpcGVsaW5lUGF0aCkiOiBmaWxlLlJlbW92ZUFsbCAmIHtwYXRoOiBfcGlwZWxpbmVQYXRofQoJCQl9CgkJCWRlbGV0ZQoJCQljcmVhdGU6IGZpbGUuQ3JlYXRlICYgewoJCQkJJGFmdGVyOiAgIGRlbGV0ZQoJCQkJZmlsZW5hbWU6IF9waXBlbGluZVBhdGgKCQkJCWNvbnRlbnRzOiAiIyBcKF9kb25vdGVkaXQpXG5cblwoeWFtbC5NYXJzaGFsKF9waXBlbGluZUNvbmZpZykpIgoJCQl9CgkJfQoJfQp9">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cue" data-lang="cue"><span style="display:flex;"><span><span style="font-weight:bold">package</span> gitlab
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="font-weight:bold">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;path&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;encoding/yaml&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#b84">&#34;tool/file&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>_goos<span style="font-weight:bold">:</span> <span style="color:#458;font-weight:bold">string</span> @tag(os<span style="font-weight:bold">,</span>var<span style="font-weight:bold">=</span>os)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// Regenerate pipeline files</span>
</span></span><span style="display:flex;"><span>command<span style="font-weight:bold">:</span> regenerate<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>	pipeline_files<span style="font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">// TODO: update _toolFile to reflect the directory hierarchy containing this file.</span>
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">// TODO: update _pipelineDir to reflect the directory containing your pipeline file.</span>
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">let</span> _toolFile <span style="font-weight:bold">=</span> <span style="color:#b84">&#34;internal/ci/gitlab/ci_tool.cue&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">let</span> _pipelineDir <span style="font-weight:bold">=</span> path.FromSlash(<span style="color:#b84">&#34;.&#34;</span><span style="font-weight:bold">,</span> path.Unix)
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">let</span> _donotedit <span style="font-weight:bold">=</span> <span style="color:#b84">&#34;Code generated by </span><span style="color:#b84">\(</span>_toolFile<span style="color:#b84">)</span><span style="color:#b84">; DO NOT EDIT.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">for</span> _pipelineName<span style="font-weight:bold">,</span> _pipelineConfig <span style="font-weight:bold">in</span> pipelines
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">let</span> _pipelineFile <span style="font-weight:bold">=</span> _pipelineName <span style="font-weight:bold">+</span> <span style="color:#b84">&#34;.yml&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="font-weight:bold">let</span> _pipelinePath <span style="font-weight:bold">=</span> path.Join(<span style="font-weight:bold">[</span>_pipelineDir<span style="font-weight:bold">,</span> _pipelineFile<span style="font-weight:bold">]</span>) {
</span></span><span style="display:flex;"><span>			<span style="font-weight:bold">let</span> delete <span style="font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#b84">&#34;Delete </span><span style="color:#b84">\(</span>_pipelinePath<span style="color:#b84">)</span><span style="color:#b84">&#34;</span><span style="font-weight:bold">:</span> file.RemoveAll <span style="font-weight:bold">&amp;</span> {path<span style="font-weight:bold">:</span> _pipelinePath}
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			delete
</span></span><span style="display:flex;"><span>			create<span style="font-weight:bold">:</span> file.Create <span style="font-weight:bold">&amp;</span> {
</span></span><span style="display:flex;"><span>				$after<span style="font-weight:bold">:</span>   delete
</span></span><span style="display:flex;"><span>				filename<span style="font-weight:bold">:</span> _pipelinePath
</span></span><span style="display:flex;"><span>				contents<span style="font-weight:bold">:</span> <span style="color:#b84">&#34;# </span><span style="color:#b84">\(</span>_donotedit<span style="color:#b84">)</span><span style="color:#b84">\n\n</span><span style="color:#b84">\(</span>yaml.Marshal(_pipelineConfig<span style="color:#b84">)</span><span style="color:#b84">)&#34;</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>
</p>
<p>Make the modifications indicated by the <code>TODO</code> comments.</p>
<p>The <code>regenerate</code> workflow command will export your CUE-based pipeline back into its required YAML file,
on demand.</p>
<h4 id="arrow_right-test-the-cue-workflow-command">
    <a href="#arrow_right-test-the-cue-workflow-command" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Test the CUE workflow command</h4>
<p>With the modified <code>ci_tool.cue</code> file in place, check that the <code>regenerate</code>
workflow command is available <strong>from a shell sitting at the repository root</strong>. For
example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y2QgJChnaXQgcmV2LXBhcnNlIC0tc2hvdy10b3BsZXZlbCkgIyBtYWtlIHN1cmUgd2UncmUgc2l0dGluZyBhdCB0aGUgcmVwb3NpdG9yeSByb290CmN1ZSBoZWxwIGNtZCByZWdlbmVyYXRlIC4vaW50ZXJuYWwvY2kvZ2l0bGFiIHwgaGVhZCAtNCA&#43;Li4vMTIuYWN0dWFsLnR4dA==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cd $(git rev-parse --show-toplevel) # make sure we&#39;re sitting at the repository root
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># cue help cmd regenerate ./internal/ci/gitlab   # the &#34;./&#34; prefix is required
</span></span><span style="display:flex;"><span>$ cue help cmd regenerate ./internal/ci/gitlab | head -4 &gt;../12.actual.txt</span></span></code></pre></div></div>
</div>
<p>The output of the <code>cue help</code> command <strong>must</strong> begin with the following:</p>
<div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="12.expected.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="12.expected.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>12.expected.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="12.expected.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="UmVnZW5lcmF0ZSBwaXBlbGluZSBmaWxlcwoKVXNhZ2U6CiAgY3VlIGNtZCByZWdlbmVyYXRlIFtmbGFnc10=">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Regenerate pipeline files
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage:
</span></span><span style="display:flex;"><span>  cue cmd regenerate [flags]</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

<table>
  <thead>
      <tr>
          <th style="text-align: left">:exclamation: WARNING :exclamation:</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">If you <em>don&rsquo;t</em> see the usage explanation for the <code>regenerate</code> workflow command (or if you receive an error message) then <strong>either</strong> your workflow command isn&rsquo;t set up as CUE requires, <strong>or</strong> you&rsquo;re running a CUE version older than <code>v0.11.0-alpha.4</code>. If you&rsquo;ve <a href="https://cuelang.org/dl">upgraded to at least that version</a> but the usage explanation still isn&rsquo;t being displayed then: (1) double check the contents of the <code>ci_tool.cue</code> file and the modifications you made to it; (2) make sure its location in the repository is precisely as given in this guide; (3) ensure the filename is <em>exactly</em> <code>ci_tool.cue</code>; (4) run <code>cue vet ./internal/ci/gitlab</code> and check that your pipelines actually validate successfully - in other words: were they truly valid before you even started this process? Lastly, make sure you&rsquo;ve followed all the steps in this guide, and that you invoked the <code>cue help</code> command from the repository&rsquo;s root directory. If you get really stuck, please come and join <a href="https://cuelang.org/community/">the CUE community</a> and ask for some help!</td>
      </tr>
  </tbody>
</table>
<h4 id="arrow_right-regenerate-the-yaml-pipeline-file">
    <a href="#arrow_right-regenerate-the-yaml-pipeline-file" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Regenerate the YAML pipeline file</h4>
<p>Run the <code>regenerate</code> workflow command to produce a YAML pipeline file from CUE. For
example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGNtZCByZWdlbmVyYXRlIC4vaW50ZXJuYWwvY2kvZ2l0bGFiICMgdGhlICIuLyIgcHJlZml4IGlzIHJlcXVpcmVk">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue cmd regenerate ./internal/ci/gitlab # the &#34;./&#34; prefix is required</span></span></code></pre></div></div>
</div>
<h4 id="arrow_right-audit-changes-to-the-yaml-pipeline-file">
    <a href="#arrow_right-audit-changes-to-the-yaml-pipeline-file" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Audit changes to the YAML pipeline file</h4>
<p>Check that your YAML pipeline file has a single <em>material</em> change from the
original:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="c2xlZXAgMQpzeW5jCmdpdCBkaWZmIC0tIC5naXRsYWItY2kueW1sIHwgZ3JlcCAtdkUgJ15pbmRleCBbMC05YS1mXXs3fVwuXC5bMC05YS1mXXs3fScgfCBoZWFkIC05ID4uLi8xNC5hY3R1YWwudHh0">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># 2 commands not present in CUE-By-Example guide, added as an attempt to work
</span></span><span style="display:flex;"><span># around cue-lang/cue#3492. DELETE THESE COMMANDS!
</span></span><span style="display:flex;"><span>$ sleep 1
</span></span><span style="display:flex;"><span>$ sync
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># git diff .gitlab-ci.yml
</span></span><span style="display:flex;"><span># For some unknown reason the trailing &#39;&gt;../...&#39; redirection *only* works when
</span></span><span style="display:flex;"><span># the diff command is given a &#39;--&#39; separator. I&#39;m utterly stumped, but let&#39;s
</span></span><span style="display:flex;"><span># just give it what it wants!
</span></span><span style="display:flex;"><span>$ git diff -- .gitlab-ci.yml | grep -vE &#39;^index [0-9a-f]{7}\.\.[0-9a-f]{7}&#39; | head -9 &gt;../14.actual.txt</span></span></code></pre></div></div>
</div>
<p>Your output should look similar to the following example:</p>
<p><div class="code-tabs"><div class="code-tabs__item code-tabs__item--top-left">




<div class="tabs tabs--code" data-tabs data-group="default">
<div class="tabs__nav tabs-nav tabs-nav--code" data-tabs-nav><div class="tabs-nav__item">
            <div
                data-tab-item="14.expected.txt"
                data-tab-group="default"
                class="tabs-nav__tab"data-copy><button title="Copy filename" class="tabs-nav__copy" data-copy-button data-copy-type="text" data-copy-value="14.expected.txt">



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--file"></use>
</svg>
<span class="tabs-nav__message is-hidden" data-copy-message aria-hidden="true">
                            Copied!
                        </span>
                    </button>14.expected.txt
            </div>
        </div></div>

<div class="tabs__content"><div data-tab-item="14.expected.txt"
            data-tab-group="default"
            class="tabs__item is-active"
        ><div class="code-block code-block--tab"data-copy><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="ZGlmZiAtLWdpdCBhLy5naXRsYWItY2kueW1sIGIvLmdpdGxhYi1jaS55bWwKLS0tIGEvLmdpdGxhYi1jaS55bWwKKysrIGIvLmdpdGxhYi1jaS55bWwKQEAgLTEsMyArMSw1IEBACisjIENvZGUgZ2VuZXJhdGVkIGJ5IGludGVybmFsL2NpL2dpdGxhYi9jaV90b29sLmN1ZTsgRE8gTk9UIEVESVQuCisKIHN0YWdlczoKICAgLSBzeW5jCiAgIC0gcHJlZmxpZ2h0">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>diff --git a/.gitlab-ci.yml b/.gitlab-ci.yml
</span></span><span style="display:flex;"><span>--- a/.gitlab-ci.yml
</span></span><span style="display:flex;"><span>+++ b/.gitlab-ci.yml
</span></span><span style="display:flex;"><span>@@ -1,3 +1,5 @@
</span></span><span style="display:flex;"><span>+# Code generated by internal/ci/gitlab/ci_tool.cue; DO NOT EDIT.
</span></span><span style="display:flex;"><span>+
</span></span><span style="display:flex;"><span> stages:
</span></span><span style="display:flex;"><span>   - sync
</span></span><span style="display:flex;"><span>   - preflight</span></span></code></pre></div></div>
</div>
</div></div>
</div>

</div></div>

The main change in each YAML file is the addition of a header that warns the
reader not to edit the file directly.</p>
<p>Your diff might also contain some YAML reformatting (with the number of leading
spaces having been changed in nested structures) but this won&rsquo;t make a
difference to the underlying meaning of the file.</p>
<p>Additionally, any comments in the original YAML file will now be found <em>only</em>
in the CUE source file - which is important as that&rsquo;s the only file that you&rsquo;ll
be manually changing, from now on.</p>
<h4 id="arrow_right-add-and-commit-files-to-git">
    <a href="#arrow_right-add-and-commit-files-to-git" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>:arrow_right: Add and commit files to git</h4>
<p>Add your files to git. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Z2l0IGFkZCAuZ2l0bGFiLWNpLnltbCBpbnRlcm5hbC9jaS9naXRsYWIvIGN1ZS5tb2QvbW9kdWxlLmN1ZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ git add .gitlab-ci.yml internal/ci/gitlab/ cue.mod/module.cue</span></span></code></pre></div></div>
</div>
<p>Make sure to include your slightly modified YAML pipeline file, wherever you
store it, along with all the new files in <code>internal/ci/gitlab/</code> and your
<code>cue.mod/module.cue</code> file.</p>
<p>Commit your files to git, with an appropriate commit message:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Z2l0IGNvbW1pdCAtLXF1aWV0IC1tICJjaTogY3JlYXRlIENVRSBzb3VyY2VzIGZvciBHaXRMYWIgQ0kvQ0QgcGlwZWxpbmVzIg==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span># Actual command in CUE-By-Example guide:
</span></span><span style="display:flex;"><span># git commit -m &#34;ci: create CUE sources for GitLab CI/CD pipelines&#34;
</span></span><span style="display:flex;"><span>$ git commit --quiet -m &#34;ci: create CUE sources for GitLab CI/CD pipelines&#34;</span></span></code></pre></div></div>
</div>
<h2 id="conclusion">
    <a href="#conclusion" class="anchor" aria-label="Anchor">



<svg class="icon anchor__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>
</a>Conclusion</h2>
<p><strong>Well done - your GitLab CI/CD pipeline file has been imported into CUE!</strong></p>
<p>It can now be managed using CUE, leading to safer and more predictable changes.
The use of a schema to check your pipeline means that you will catch and fix
certain types of mistake earlier than before, without waiting for the slow &ldquo;git
add/commit/push; check if CI fails&rdquo; cycle.</p>
<p>From now on, each time you make a change to a CUE pipeline file, immediately
regenerate the YAML files required by GitLab CI/CD, and commit your changes to
all the CUE and YAML files. For example:</p>
<p>:computer: <code>terminal</code></p>
<div class="code-block code-block--heading code-block--terminal"data-copy><div class="code-block__heading">
            <span class="code-block__tab">TERMINAL</span>
        </div><div class="code-block__highlight"><button class="code-block__copy" type="button" data-copy-button data-copy-type="code" data-copy-value="Y3VlIGNtZCByZWdlbmVyYXRlIC4vaW50ZXJuYWwvY2kvZ2l0bGFiLyAjIHRoZSAiLi8iIHByZWZpeCBpcyByZXF1aXJlZApnaXQgYWRkIC5naXRsYWItY2kueW1sIGludGVybmFsL2NpL2dpdGxhYi8KZ2l0IGNvbW1pdCAtbSAiY2k6IGFkZGVkIG5ldyByZWxlYXNlIHBpcGVsaW5lIiAjIGV4YW1wbGUgbWVzc2FnZQ==">
                <span>Copy code</span>
                <span class="code-block__message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>$ cue cmd regenerate ./internal/ci/gitlab/ # the &#34;./&#34; prefix is required
</span></span><span style="display:flex;"><span>$ git add .gitlab-ci.yml internal/ci/gitlab/
</span></span><span style="display:flex;"><span>$ git commit -m &#34;ci: added new release pipeline&#34; # example message</span></span></code></pre></div></div>
</div>

                        
                    </div><footer class="article__footer">
    <div class="article__lastmod">
        <p class="lastmod">
         <a class="lastmod__link" href="https://github.com/cue-lang/cuelang.org/commit/7c104835c2bd9731b5a6b8cd703b905b2a4896aa">
                Last modified April 8, 2025</a>
    </p>

    </div>

    <div class="article__footer-meta"><div class="article__share"><details class="share" data-dropdown>
    <summary class="button button--icon button--light-blue share__button">
        



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--share"></use>
</svg>

        <span>Open share options</span>
    </summary>

    <ul class="share__list">
        <li class="share__item" data-copy>
            <button class="share__copy" data-copy-button data-copy-type="url" data-copy-value="/docs/draft/cbe-005_gitlab_ci/">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--link"></use>
</svg>

                <span class="share__link-text">Copy link</span>
                <span class="share__copy-message is-hidden" data-copy-message aria-hidden="true">
                    Copied!
                </span>
            </button>
        </li>

        <li class="share__item">
            <a class="share__link" target="_blank" href="https://twitter.com/intent/tweet?url=/docs/draft/cbe-005_gitlab_ci/&text=%20Source:%20https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md%20Driving%20GitLab%20CI/CD%20pipelines%20with%20CUE%20by%20Jonathan%20Matthews%0aThis%20guide%20explains%20how%20to%20convert%20a%20GitLab%20CI/CD%20pipeline%20file%20from%20YAML%20to%20CUE,%20check%20its%20contents%20are%20valid,%20and%20then%20use%20CUE&amp;rsquo;s%20tooling%20layer%20to%20regenerate%20YAML.%0aThis%20is%20useful%20because%20it%20allows%20you%20to%20switch%20to%20CUE%20as%20a%20source%20of%20truth%20for%20GitLab%20pipelines%20and%20perform%20client-side%20validation,%20without%20GitLab%20needing%20to%20know%20you&amp;rsquo;re%20managing%20your%20pipelines%20with%20CUE.%0a">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                <p><span class="share__link-text">Share on X (Twitter)</span></p>
            </a>
        </li>

        <li class="share__item">
            <a class="share__link" target="_blank"
            href="https://www.linkedin.com/shareArticle?mini=true&url=/docs/draft/cbe-005_gitlab_ci/&summary=%20Source:%20https://raw.githubusercontent.com/cue-labs/cue-by-example/refs/heads/main/005_gitlab_ci/README.md%20Driving%20GitLab%20CI/CD%20pipelines%20with%20CUE%20by%20Jonathan%20Matthews%0aThis%20guide%20explains%20how%20to%20convert%20a%20GitLab%20CI/CD%20pipeline%20file%20from%20YAML%20to%20CUE,%20check%20its%20contents%20are%20valid,%20and%20then%20use%20CUE&amp;rsquo;s%20tooling%20layer%20to%20regenerate%20YAML.%0aThis%20is%20useful%20because%20it%20allows%20you%20to%20switch%20to%20CUE%20as%20a%20source%20of%20truth%20for%20GitLab%20pipelines%20and%20perform%20client-side%20validation,%20without%20GitLab%20needing%20to%20know%20you&amp;rsquo;re%20managing%20your%20pipelines%20with%20CUE.%0a">
                



<svg class="icon share__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-linkedin"></use>
</svg>

                <p><span class="share__link-text">Share on Linkedin</span></p>
            </a>
        </li>
    </ul>
</details>
</div>
    </div>
</footer>
</div>
            </article>

            



<div class="prevnext">
    <nav class="prevnext__container" aria-label="Previous/Next navigation"><a class="prevnext__prev" href="/docs/draft/cbe-001_github_actions_importing_workflows/" aria-label="Previous - CUE By Example - Driving GitHub Actions workflows with CUE">
                



<svg class="icon prevnext__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--circle-arrow-left"></use>
</svg>

                <span class="prevnext__text">CUE By Example - Driving GitHub Actions workflows with CUE</span>
            </a><a class="prevnext__next" href="/docs/draft/cbe-004_mythic_beasts_dns/" aria-label="Next - CUE By Example - Managing Mythic Beasts DNS zones with CUE">
                <span class="prevnext__text">CUE By Example - Managing Mythic Beasts DNS zones with CUE</span>
                



<svg class="icon prevnext__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--circle-arrow-right"></use>
</svg>

            </a></nav>
</div>

        </div>
        <div id="docs-menu" class="docs__aside">
            <div class="docs__backdrop" data-docs-close="docs"></div>
            <div class="docs__nav">
                <nav class="tree">
    <ul class="tree__list is-book">
        
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/introduction/" title="Introduction">
            <span class="tree__text">Introduction</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/tour/" title="Tour">
            <span class="tree__text">Tour</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/integration/" title="Integrations">
            <span class="tree__text">Integrations</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/tutorial/" title="Tutorials">
            <span class="tree__text">Tutorials</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/howto/" title="How-to Guides">
            <span class="tree__text">How-to Guides</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/concept/" title="Concept Guides">
            <span class="tree__text">Concept Guides</span>
        </a>
    </li>
    
    
    

    <li class="tree__item">
        <a class="tree__link" href="/docs/reference/" title="References">
            <span class="tree__text">References</span>
        </a>
    </li>
    </ul>
</nav>



                <button type="button" class="docs__hide button button--icon button--raised button--light-blue"
                        aria-haspopup="menu" aria-expanded="false" aria-controls="docs-menu" data-docs-toggle>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--chevron-left"></use>
</svg>
<span>Hide side navigation</span>
                </button>
            </div>
        </div>

        <button type="button" class="docs__show button button--icon button--raised button--light-blue"
                aria-haspopup="menu" aria-expanded="false" aria-controls="docs-menu" data-docs-toggle>



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--chevron-right"></use>
</svg>
<span>Show side navigation</span>
        </button>
    </div>

            </main>

            <footer id="site-footer" class="site__footer">
                




<div class="footer">
    <div class="footer__sitemap">
        <nav class="footer__container" aria-label="Footer menu">
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Get Started</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/">
                                    <span class="nav__text">Documentation</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/tour/">
                                    <span class="nav__text">Language Tour</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/play/">
                                    <span class="nav__text">Playground</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/introduction/installation/">
                                    <span class="nav__text">Install CUE</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Community</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/community">
                                    <span class="nav__text">The CUE Community</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://github.com/cue-lang/cue/blob/master/CONTRIBUTING.md#contribution-guide" target="_blank">
                                    <span class="nav__text">Contributing</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/docs/reference/code-of-conduct/">
                                    <span class="nav__text">Code of Conduct</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/s/slack">
                                    <span class="nav__text">Slack Workspace</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="/s/discord">
                                    <span class="nav__text">Discord Server</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
                
                <div class="nav nav--footer">
                    <p class="nav__title">Connect</p>

                    <ul class="nav__list">
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://github.com/cue-lang/cue" target="_blank">
                                    <span class="nav__text">GitHub</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://twitter.com/cue_lang" target="_blank">
                                    <span class="nav__text">X (Twitter)</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://bsky.app/profile/cuelang.org" target="_blank">
                                    <span class="nav__text">Bluesky</span>
                                </a>
                            </li>
                        
                            
                            <li class="nav__item">
                                <a class="nav__link"
                                   href="https://www.youtube.com/@cuelang/videos" target="_blank">
                                    <span class="nav__text">YouTube</span>
                                </a>
                            </li>
                        
                    </ul>
                </div>
            
        </nav>
    </div>

    <div class="footer__legal">
        <nav class="footer__container" aria-label="Legal">
            <div class="nav nav--legal">
                <ul class="nav__list">
                    <li class="nav__item">
                        <span class="nav__text">&copy; 2025 CUE</span>
                    </li>

                    
                        <li class="nav__item"><a class="nav__link"
                               href="/privacy-policy/">
                                <span class="nav__text">Privacy policy</span>
                            </a>
                        </li>
                    

                    <li class="nav__item">
                        <a class="nav__link" href="https://github.com/cue-lang/cue/issues/new?labels=Triage,NeedsInvestigation,cuelang.org&amp;title=cuelang.org:%20&amp;template=bug_report.md&amp;body=%23%23%23&#43;What&#43;page&#43;were&#43;you&#43;looking&#43;at%3F%0A%0A%2Fdocs%2Fdraft%2Fcbe-005_gitlab_ci%2F%0A%0A%23%23%23&#43;What&#43;version&#43;of&#43;the&#43;site&#43;were&#43;you&#43;looking&#43;at%3F%0A%0Ahttps%3A%2F%2Fgithub.com%2Fcue-lang%2Fcuelang.org%2Fcommit%2F64789fe0b723abceb454dfea8fdc748298d590e3%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;do%3F%0A%0A%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;expect%3F%0A%0A%0A%0A%23%23%23&#43;What&#43;did&#43;you&#43;see&#43;instead%3F%0A%0A" target="_blank">
                            <span class="nav__text">Report an Issue</span>
                        </a>
                    </li>
                </ul>
            </div>

            <a href="/" class="footer__branding" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>
        </nav>
    </div>
</div>

            </footer>
        </div>

        
                <div class="notification-bar is-hidden" data-notification-bar="cue-minor-release-v0.13">
        <div class="notification-bar__container">
            <div class="notification-bar__content">
                <strong>CUE v0.13 is now available</strong> &ndash; learn more about its <a href="https://github.com/cue-lang/cue/releases/tag/v0.13.0">new features and improvements</a>
            </div>
            <a class="button button--outline notification-bar__cta" href="/docs/introduction/installation/">
                    <span class="button__text">Install CUE</span>
                    



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--download"></use>
</svg>

                </a>
            <button type="button" class="button button--icon button--small notification-bar__close">
                



<svg class="icon button__icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--close"></use>
</svg>

                <span class="button__text">Close</span>
            </button>
        </div>
    </div>

        
        

<div id="mobile-menu" class="drawer drawer--mobile" data-drawer="menu">
    <div class="drawer__backdrop" data-drawer-close="menu"></div>
    <div class="drawer__container" tabindex="0">
        <div class="drawer__header">
            <a href="/" class="drawer__branding" rel="home">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><path class="logo__letters" d="M39.555 50.355c-6.853.0-11.907 5.133-11.907 13.602s5.027 13.602 11.907 13.602c5.818.0 10.073-3.648 10.94-8.883l-4.034-.012c-.686 3.389-3.532 5.252-6.88 5.252-4.541.0-7.968-3.533-7.968-9.957s3.414-9.955 7.979-9.955c3.373.0 6.207 1.902 6.865 5.328l.004-.002h4.033c-.906-5.664-5.34-8.975-10.94-8.975zm38.748.362-.002.004h.002zm0 .004v26.478H96.07v-3.44H82.297v-8.105h12.752V62.23H82.297V54.16h13.617v-3.44zm-24.823.0v17.521c0 5.974 4.651 9.4 10.51 9.4 5.86.0 10.528-3.426 10.528-9.4V50.721h-3.995v17.457c0 3.711-2.985 5.793-6.529 5.793s-6.517-2.082-6.517-5.793V50.72z"/><path class="logo__inner" d="M64 9.586C33.947 9.586 9.586 33.947 9.586 64S33.947 118.414 64 118.414 118.414 94.053 118.414 64 94.05 9.586 64 9.586zm0 105.973c-28.476.0-51.562-23.086-51.562-51.562S35.524 12.438 64 12.438 115.562 35.524 115.562 64 92.476 115.562 64 115.562z"/><path class="logo__outer" d="M64 0C28.653.0.0 28.653.0 64s28.653 64 64 64 64-28.653 64-64S99.347.0 64 0zm0 121.843C32.054 121.843 6.157 95.946 6.157 64S32.054 6.157 64 6.157 121.843 32.054 121.843 64 95.946 121.843 64 121.843z"/></svg>
                <span>Homepage of CUE</span>
            </a>

            <div class="drawer__close">
                <button type="button" class="button button--white button--icon" data-drawer-close="menu">
                    



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--close"></use>
</svg>

                    <span class="button__text">Hide menu</span>
                </button>
            </div>
        </div>

        <div class="drawer__content">
            <div class="drawer__menu">
                <nav class="nav nav--mobile" aria-label="Mobile menu">
                    <ul class="nav__list">
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/docs/">
                                    <span class="nav__text">Documentation</span>
                                </a>
                            </li>
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/play/">
                                    <span class="nav__text">Play</span>
                                </a>
                            </li>
                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/community/">
                                    <span class="nav__text">Community</span>
                                </a>
                            </li>
                        

                        
                            <li class="nav__item">
                                
                                <a class="nav__link"
                                   href="/docs/introduction/installation/">
                                    <span class="nav__text">Install</span>
                                </a>
                            </li>
                        

                        <li class="nav__item nav__item--search">





<div data-search-autocomplete="drawer"
     data-searchbar-size="small"
     data-searchbar-placeholder=""
>
    <div id="autocomplete-drawer"></div>
</div>
</li>
                    </ul>
                </nav>
            </div>
        </div>

        <div class="drawer__footer">
            <nav class="nav nav--social" aria-label="Social">
                <ul class="nav__list">
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://github.com/cue-lang/cue"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--github"></use>
</svg>

                                <span class="nav__text">GitHub</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="/s/slack">
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--slack"></use>
</svg>

                                <span class="nav__text">Slack</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="/s/discord">
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-discord"></use>
</svg>

                                <span class="nav__text">Discord</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://twitter.com/cue_lang"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-x"></use>
</svg>

                                <span class="nav__text">X (Twitter)</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://bsky.app/profile/cuelang.org"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-bluesky"></use>
</svg>

                                <span class="nav__text">Bluesky</span>
                            </a>
                        </li>
                    
                        <li class="nav__item">
                            
                            <a class="nav__link"
                               href="https://www.youtube.com/@cuelang/videos"target="_blank" >
                                



<svg class="icon" aria-hidden="true">
    <use xmlns:xlink="http://www.w3.org/1999/xlink"
         xlink:href="/img/ui.svg#icon--social-youtube"></use>
</svg>

                                <span class="nav__text">YouTube</span>
                            </a>
                        </li>
                    
                </ul>
            </nav>
        </div>
    </div>
</div>

        

    
    <script src="/js/main.min.f4174e980af6f5e0cedc0ce09a77d6f3a18405dee07c4cdd87543814539fabb3.js" integrity="sha256-9BdOmAr29eDO3AzgmnfW86GEBd7gfEzdh1Q4FFOfq7M=" async></script>






    </body>
</html>
