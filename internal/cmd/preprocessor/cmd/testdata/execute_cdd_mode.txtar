# Test CDD mode functionality
# Ensure that --cdd mode processes content without requiring hugo directory structure
# and uses the specified output directory

# Create output directory
mkdir output

# Run the preprocessor in CDD mode
exec preprocessor execute --cdd --cddoutputdir=output

# Verify that output files were created in the specified directory
cmp output/example/index.md golden/output/example/index.md

# Verify filesystem contents
exec cmd-find
cmp stdout stdout.golden

-- content/example/en.md --
---
title: CDD test example
---

This is a test file for CDD mode.

{{{with script "en" "test"}}}
#location top
echo "test script output"
{{{end}}}

-- content/example/site.cue --
package site

content: example: page: {
	leftDelim:  "{{{"
	rightDelim: "}}}"
}

-- golden/output/example/index.md --
---
title: CDD test example
---

This is a test file for CDD mode.

``` { .text title="TERMINAL" data-copy="echo &#34;test script output&#34;" }
$ echo "test script output"
test script output
```

-- stdout.golden --
content/example/en.md
content/example/gen_cache.cue
content/example/site.cue
output/example/index.md
