---
title: Generating Go types from CUE definitions
tags: [encodings]
authors: [jpluscplusm]
toc_hide: true
---

The `v0.12.0` release of the `cue` command introduced an experimental new command:
[`gengotypes`]({{<relref"docs/reference/command/cue-help-exp-gengotypes">}}).
This command automatically generates Go types from the definitions in a CUE
file or package, and gives you control over the package, type, and field names
generated. This guide shows you how to use the `cue exp gengotypes` command.

## Generating Go types

{{{with step}}}
Start with some CUE that contains at least one definition:
{{{with upload "en" "example 1"}}}
-- pets.cue --
package pet

// These are the only pet types we can handle.
petTypes: ["cat", "dog", "goldfish"]

// aDog represents an instance of Canis lupus familiaris, the domestic dog.
#aDog: {
	// Each dog has at least one name.
	name!:     string
	age?:      float // We might not know every dog's age, so this is optional.
	isGoodBoy: true
}
{{{end}}}

Hidden definitions (fields with identifiers starting with `_#`) are ignored by the `gengotypes` command.
{{{end}}}

{{{with step}}}
Run the `cue exp gengotypes` command targetting a specific CUE package:

{{{with script "en" "gengotypes 1"}}}
cue exp gengotypes .:pet
{{{end}}}
The command is silent when it succeeds.
{{{end}}}

{{{with step}}}
Observe the contents of the `cue_types_gen.go` file:
{{{with _script_ "en" "HIDDEN: move 1"}}}
mv cue_types_gen.go .cue_types_gen.go
{{{end}}}
{{{with upload "en" "cue_types_gen.go 1"}}}
-- cue_types_gen.go --
// Code generated by "cue exp gengotypes"; DO NOT EDIT.

package pet

// aDog represents an instance of Canis lupus familiaris, the domestic dog.
type ADog struct {
	// Each dog has at least one name.
	Name string `json:"name"`

	Age float64 `json:"age,omitempty"`

	IsGoodBoy bool `json:"isGoodBoy"`
}
{{{end}}}
{{{with _script_ "en" "HIDDEN: diff 1"}}}
diff cue_types_gen.go .cue_types_gen.go
{{{end}}}

{{<info>}}
If you're working inside a CUE module, your generated Go file will have a
dynamic filename that's slightly different to `cue_types_gen.go`.
This difference is tracked in {{<issue 3765/>}}.
{{</info>}}

Notice these differences between the contents of
[`pets.cue`](#step-1)
and
[`cue_types_gen.go`](#step-3):

- The top-level `petTypes` field and its comment aren't present in the Go
  file. Only fields in a definition are translated to Go.
- The comments for `#aDog` and `name` are present in the Go file, but the
  comment for `age` isn't. Trailing comments aren't translated to Go.
- The field `isGoodBoy` *always* has value of `true` in CUE, but the Go encodes
  a `bool` type. Generated Go types are guaranteed to accept any value accepted
  by the CUE definitions, but they may be more general.
{{{end}}}

## Controlling the generated Go

If you need to control the generated Go package, type, and field names, you can
use the `@go()` attribute to specify them in your CUE:

{{{with step}}}
Add another CUE file, `morePets.cue`, containing the following code:
{{{with upload "en" "example 2"}}}
-- morePets.cue --
package pet

@go(acmecorppets)

// aCat represents an instance of Felis catus, the domestic cat.
#aCat: {
	@go(Cat)

	// Cats consider themselves to have a title, not a name.
	title!:              string @go(Name) // Maintain Go-level parity with Dogs.
	socialMediaAccount!: string @go(-)    // Don't emit this field as Go.
}

#aArdvark: {
	@go(-)
	status: "Unsupported"
}
{{{end}}}
{{{end}}}

{{{with step}}}
Run the `cue exp gengotypes` command targetting the `pet` CUE package:

{{{with script "en" "gengotypes 2"}}}
cue exp gengotypes .:pet
{{{end}}}
{{{end}}}

{{{with step}}}
Observe the new contents of the `cue_types_gen.go` file:
{{{with _script_ "en" "HIDDEN: move 2"}}}
mv cue_types_gen.go .cue_types_gen.go
{{{end}}}
{{{with upload "en" "cue_types_gen.go 2"}}}
#force
-- cue_types_gen.go --
// Code generated by "cue exp gengotypes"; DO NOT EDIT.

package acmecorppets

// aCat represents an instance of Felis catus, the domestic cat.
type Cat struct {
	// Cats consider themselves to have a title, not a name.
	Name string `json:"title"`
}

// aDog represents an instance of Canis lupus familiaris, the domestic dog.
type ADog struct {
	// Each dog has at least one name.
	Name string `json:"name"`

	Age float64 `json:"age,omitempty"`

	IsGoodBoy bool `json:"isGoodBoy"`
}
{{{end}}}
{{{with _script_ "en" "HIDDEN: diff 2"}}}
diff cue_types_gen.go .cue_types_gen.go
{{{end}}}

Notice these differences between the contents of
[`morePets.cue`](#step-4)
and the new
[`cue_types_gen.go`](#step-6):

- The package-level `@go(acmecorppets)` attribute renamed the generated Go
  package from `pet`.
  - Because your command targetted the whole of the `pet` package, the
    dog-related contents of `pets.cue` are included under the renamed Go
    package. Only one package-level attribute is needed.
- The definition-level `@go(Cat)` attribute renamed the generated Go type from
  `ACat`.
- The field-level `@go(Name`) attribute renamed the generated Go field from
  `Title`.
- The field-level `@go(-)` attribute caused the `socialMediaAccount` field to
  be omitted from the generated Go type.
- The definition-level `@go(-)` attribute caused the `aArdvark` type to be
  omitted from the generated Go.

You can also use the `@go()` attribute to control the *type* of a generated
field -- see
[`cue help exp gengotypes`]({{<relref"docs/reference/command/cue-help-exp-gengotypes">}})
for more information.
{{{end}}}

{{<warning>}}
The `gengotypes` command is still in an experimental stage, which means that it
may be changed or removed at any time. The objective is for the CUE project to
gain experience through [your feedback]({{<relref"/community">}}) about this
experimental command, and then move the feature elsewhere.
{{</warning>}}

## Related content

- {{<linkto/related/reference"command/cue-help-exp-gengotypes">}} --
  the built-in help text for the `cue exp gengotypes` command
